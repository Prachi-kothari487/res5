// // // // // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // // // // import api from "../services/api";

// // // // // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // // // // //   const [loading, setLoading] = useState(true);
// // // // // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // // // // //       try {
// // // // // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };

// // // // // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes] = await Promise.all([
// // // // // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // // // // //         ]);

// // // // // // // // // // // // // //         console.log("üßæ Orders Data:", orderRes.data);
// // // // // // // // // // // // // //         console.log("üìã Categories Data:", catRes.data);

// // // // // // // // // // // // // //         // üß† Normalize response in case backend sends { data: [...] }
// // // // // // // // // // // // // //         setCategories(Array.isArray(catRes.data) ? catRes.data : catRes.data.data || []);
// // // // // // // // // // // // // //         setTables(Array.isArray(tableRes.data) ? tableRes.data : tableRes.data.data || []);
// // // // // // // // // // // // // //         setOrders(Array.isArray(orderRes.data) ? orderRes.data : orderRes.data.data || []);
// // // // // // // // // // // // // //         setStaff(Array.isArray(staffRes.data) ? staffRes.data : staffRes.data.data || []);
// // // // // // // // // // // // // //       } catch (err) {
// // // // // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // // // // //       } finally {
// // // // // // // // // // // // // //         setLoading(false);
// // // // // // // // // // // // // //       }
// // // // // // // // // // // // // //     };

// // // // // // // // // // // // // //     fetchData();
// // // // // // // // // // // // // //   }, [token]);

// // // // // // // // // // // // // //   if (loading) {
// // // // // // // // // // // // // //     return (
// // // // // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // // // // //         <p style={{ marginTop: "10px" }}>Loading Admin Panel...</p>
// // // // // // // // // // // // // //         <style>{`@keyframes spin { to { transform: rotate(360deg); } }`}</style>
// // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // //     );
// // // // // // // // // // // // // //   }

// // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // // // // //       {/* Header */}
// // // // // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "40px" }}>
// // // // // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // // //         <p style={subtitle}>Manage your restaurant with elegance and ease</p>
// // // // // // // // // // // // // //       </header>

// // // // // // // // // // // // // //       {/* Grid */}
// // // // // // // // // // // // // //       <div style={gridContainer}>
// // // // // // // // // // // // // //         {/* Orders */}
// // // // // // // // // // // // // //         <div style={cardStyle}>
// // // // // // // // // // // // // //           <h2 style={sectionTitle}>üßæ Current Orders</h2>
// // // // // // // // // // // // // //           {orders.length === 0 ? (
// // // // // // // // // // // // // //             <p style={emptyText}>No active orders yet.</p>
// // // // // // // // // // // // // //           ) : (
// // // // // // // // // // // // // //             orders.map((o) => (
// // // // // // // // // // // // // //               <div key={o._id} style={miniCard}>
// // // // // // // // // // // // // //                 <div style={cardHeader}>
// // // // // // // // // // // // // //                   <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // // // // // // // // // // //                     Table #{o.table?.number ?? "N/A"}
// // // // // // // // // // // // // //                   </h3>
// // // // // // // // // // // // // //                   <span
// // // // // // // // // // // // // //                     style={{
// // // // // // // // // // // // // //                       backgroundColor:
// // // // // // // // // // // // // //                         o.status === "completed"
// // // // // // // // // // // // // //                           ? "#fff8dc"
// // // // // // // // // // // // // //                           : o.status === "in-progress"
// // // // // // // // // // // // // //                           ? "#faebd7"
// // // // // // // // // // // // // //                           : "#f5f5dc",
// // // // // // // // // // // // // //                       color: "#8b7500",
// // // // // // // // // // // // // //                       padding: "3px 10px",
// // // // // // // // // // // // // //                       borderRadius: "10px",
// // // // // // // // // // // // // //                       fontSize: "12px",
// // // // // // // // // // // // // //                       border: "1px solid #d4af37",
// // // // // // // // // // // // // //                     }}
// // // // // // // // // // // // // //                   >
// // // // // // // // // // // // // //                     {o.status}
// // // // // // // // // // // // // //                   </span>
// // // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // // //                 <p style={{ fontSize: "13px", marginTop: "5px" }}>
// // // // // // // // // // // // // //                   <strong>Staff:</strong> {o.assignedStaff?.name || "Unassigned"}
// // // // // // // // // // // // // //                 </p>
// // // // // // // // // // // // // //                 <ul style={{ paddingLeft: "18px", marginTop: "5px" }}>
// // // // // // // // // // // // // //                   {o.items?.length > 0 ? (
// // // // // // // // // // // // // //                     o.items.map((i, idx) => (
// // // // // // // // // // // // // //                       <li key={idx} style={{ fontSize: "13px" }}>
// // // // // // // // // // // // // //                         {i.name} √ó {i.qty}
// // // // // // // // // // // // // //                       </li>
// // // // // // // // // // // // // //                     ))
// // // // // // // // // // // // // //                   ) : (
// // // // // // // // // // // // // //                     <li>No items</li>
// // // // // // // // // // // // // //                   )}
// // // // // // // // // // // // // //                 </ul>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             ))
// // // // // // // // // // // // // //           )}
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         {/* Staff */}
// // // // // // // // // // // // // //         <div style={cardStyle}>
// // // // // // // // // // // // // //           <h2 style={sectionTitle}>üë®‚Äçüç≥ Staff Members</h2>
// // // // // // // // // // // // // //           {staff.length === 0 ? (
// // // // // // // // // // // // // //             <p style={emptyText}>No staff registered.</p>
// // // // // // // // // // // // // //           ) : (
// // // // // // // // // // // // // //             staff.map((s) => (
// // // // // // // // // // // // // //               <div key={s._id} style={miniCard}>
// // // // // // // // // // // // // //                 <h3 style={{ margin: 0, color: "#b8860b" }}>{s.name}</h3>
// // // // // // // // // // // // // //                 <p style={{ fontSize: "13px", color: "#555" }}>{s.email}</p>
// // // // // // // // // // // // // //                 <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // // //                   Role: {s.role || "Staff"}
// // // // // // // // // // // // // //                 </p>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             ))
// // // // // // // // // // // // // //           )}
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         {/* Categories */}
// // // // // // // // // // // // // //         <div style={cardStyle}>
// // // // // // // // // // // // // //           <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // // // // // //           {categories.length === 0 ? (
// // // // // // // // // // // // // //             <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // // // // //           ) : (
// // // // // // // // // // // // // //             <div style={{ display: "flex", flexWrap: "wrap", gap: "10px" }}>
// // // // // // // // // // // // // //               {categories.map((c) => (
// // // // // // // // // // // // // //                 <span
// // // // // // // // // // // // // //                   key={c._id}
// // // // // // // // // // // // // //                   style={{
// // // // // // // // // // // // // //                     backgroundColor: "#fff8dc",
// // // // // // // // // // // // // //                     color: "#b8860b",
// // // // // // // // // // // // // //                     padding: "8px 12px",
// // // // // // // // // // // // // //                     borderRadius: "20px",
// // // // // // // // // // // // // //                     fontSize: "13px",
// // // // // // // // // // // // // //                     fontWeight: 500,
// // // // // // // // // // // // // //                     border: "1px solid #d4af37",
// // // // // // // // // // // // // //                   }}
// // // // // // // // // // // // // //                 >
// // // // // // // // // // // // // //                   {c.name}
// // // // // // // // // // // // // //                 </span>
// // // // // // // // // // // // // //               ))}
// // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // //           )}
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         {/* Tables */}
// // // // // // // // // // // // // //         <div style={cardStyle}>
// // // // // // // // // // // // // //           <h2 style={sectionTitle}>ü™ë Tables</h2>
// // // // // // // // // // // // // //           {tables.length === 0 ? (
// // // // // // // // // // // // // //             <p style={emptyText}>No tables found.</p>
// // // // // // // // // // // // // //           ) : (
// // // // // // // // // // // // // //             tables.map((t) => (
// // // // // // // // // // // // // //               <div key={t._id} style={miniCard}>
// // // // // // // // // // // // // //                 <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // // // // // // // // // // //                   Table #{t.number}
// // // // // // // // // // // // // //                 </h3>
// // // // // // // // // // // // // //                 <p style={{ fontSize: "13px", color: "#555" }}>
// // // // // // // // // // // // // //                   QR: {t.qrSlug}
// // // // // // // // // // // // // //                 </p>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             ))
// // // // // // // // // // // // // //           )}
// // // // // // // // // // // // // //         </div>
// // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // //     </div>
// // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // }

// // // // // // // // // // // // // // /* ---- Styles ---- */
// // // // // // // // // // // // // // const mainContainer = {
// // // // // // // // // // // // // //   minHeight: "100vh",
// // // // // // // // // // // // // //   background: "linear-gradient(180deg, #fffdf8, #fdf6e3)",
// // // // // // // // // // // // // //   padding: "40px 20px",
// // // // // // // // // // // // // //   fontFamily: "Poppins, sans-serif",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const loadingContainer = {
// // // // // // // // // // // // // //   height: "100vh",
// // // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // // //   flexDirection: "column",
// // // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // // //   color: "#b7950b",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const spinner = {
// // // // // // // // // // // // // //   width: "40px",
// // // // // // // // // // // // // //   height: "40px",
// // // // // // // // // // // // // //   border: "4px solid #f2e1a3",
// // // // // // // // // // // // // //   borderTopColor: "#d4af37",
// // // // // // // // // // // // // //   borderRadius: "50%",
// // // // // // // // // // // // // //   animation: "spin 1s linear infinite",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const title = {
// // // // // // // // // // // // // //   color: "#b8860b",
// // // // // // // // // // // // // //   fontSize: "2.2rem",
// // // // // // // // // // // // // //   margin: "0",
// // // // // // // // // // // // // //   fontWeight: "700",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const subtitle = { color: "#8b8000", fontSize: "15px" };

// // // // // // // // // // // // // // const gridContainer = {
// // // // // // // // // // // // // //   display: "grid",
// // // // // // // // // // // // // //   gap: "30px",
// // // // // // // // // // // // // //   gridTemplateColumns: "repeat(auto-fit, minmax(320px, 1fr))",
// // // // // // // // // // // // // //   maxWidth: "1200px",
// // // // // // // // // // // // // //   margin: "0 auto",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const cardStyle = {
// // // // // // // // // // // // // //   backgroundColor: "#ffffff",
// // // // // // // // // // // // // //   borderRadius: "15px",
// // // // // // // // // // // // // //   padding: "20px",
// // // // // // // // // // // // // //   boxShadow: "0 4px 10px rgba(212, 175, 55, 0.15)",
// // // // // // // // // // // // // //   border: "1px solid #f0e6b2",
// // // // // // // // // // // // // //   transition: "transform 0.2s ease, box-shadow 0.2s ease",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const sectionTitle = {
// // // // // // // // // // // // // //   fontSize: "18px",
// // // // // // // // // // // // // //   color: "#8b7500",
// // // // // // // // // // // // // //   marginBottom: "15px",
// // // // // // // // // // // // // //   borderBottom: "1px solid #f0e6b2",
// // // // // // // // // // // // // //   paddingBottom: "8px",
// // // // // // // // // // // // // //   fontWeight: "600",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const emptyText = {
// // // // // // // // // // // // // //   color: "#b8a000",
// // // // // // // // // // // // // //   fontSize: "14px",
// // // // // // // // // // // // // //   fontStyle: "italic",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const miniCard = {
// // // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // // //   borderRadius: "10px",
// // // // // // // // // // // // // //   padding: "10px 15px",
// // // // // // // // // // // // // //   marginBottom: "10px",
// // // // // // // // // // // // // //   border: "1px solid #f3e6b0",
// // // // // // // // // // // // // // };

// // // // // // // // // // // // // // const cardHeader = {
// // // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // // //   justifyContent: "space-between",
// // // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // // // };
// // // // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // // // //   const [loading, setLoading] = useState(true);
// // // // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // // // //       try {
// // // // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };

// // // // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // // // //         ]);

// // // // // // // // // // // // //         console.log("üßæ Orders Response:", orderRes.data);

// // // // // // // // // // // // //         setCategories(catRes.data.data || catRes.data || []);
// // // // // // // // // // // // //         setTables(tableRes.data.data || tableRes.data || []);
// // // // // // // // // // // // //         // ‚úÖ handle various backend response formats safely
// // // // // // // // // // // // //         setOrders(
// // // // // // // // // // // // //           orderRes.data.orders || orderRes.data.data || orderRes.data || []
// // // // // // // // // // // // //         );
// // // // // // // // // // // // //         setStaff(staffRes.data.data || staffRes.data || []);
// // // // // // // // // // // // //         setItems(menuRes.data.items || menuRes.data || []);
// // // // // // // // // // // // //       } catch (err) {
// // // // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // // // //       } finally {
// // // // // // // // // // // // //         setLoading(false);
// // // // // // // // // // // // //       }
// // // // // // // // // // // // //     };

// // // // // // // // // // // // //     fetchData();
// // // // // // // // // // // // //   }, [token]);

// // // // // // // // // // // // //   if (loading) {
// // // // // // // // // // // // //     return (
// // // // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // // // //         <p>Loading Admin Panel...</p>
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     );
// // // // // // // // // // // // //   }

// // // // // // // // // // // // //   /* ========== RENDER SECTIONS ========== */

// // // // // // // // // // // // //   const renderOrders = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üßæ Current Orders</h2>
// // // // // // // // // // // // //       {!Array.isArray(orders) || orders.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No active orders yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         orders.map((o) => (
// // // // // // // // // // // // //           <div key={o._id} style={miniCard}>
// // // // // // // // // // // // //             <div style={cardHeader}>
// // // // // // // // // // // // //               <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // // // // // // // // // //                 Table #{o.tableId?.number || o.table?.number || "N/A"}
// // // // // // // // // // // // //               </h3>
// // // // // // // // // // // // //               <span
// // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // //                   backgroundColor:
// // // // // // // // // // // // //                     o.status === "completed"
// // // // // // // // // // // // //                       ? "#e6ffe6"
// // // // // // // // // // // // //                       : o.status === "in-progress"
// // // // // // // // // // // // //                       ? "#fff4cc"
// // // // // // // // // // // // //                       : "#f0f0f0",
// // // // // // // // // // // // //                   color:
// // // // // // // // // // // // //                     o.status === "completed"
// // // // // // // // // // // // //                       ? "#006600"
// // // // // // // // // // // // //                       : o.status === "in-progress"
// // // // // // // // // // // // //                       ? "#8b7500"
// // // // // // // // // // // // //                       : "#555",
// // // // // // // // // // // // //                   padding: "3px 10px",
// // // // // // // // // // // // //                   borderRadius: "8px",
// // // // // // // // // // // // //                   fontSize: "12px",
// // // // // // // // // // // // //                   border: "1px solid #d4af37",
// // // // // // // // // // // // //                 }}
// // // // // // // // // // // // //               >
// // // // // // // // // // // // //                 {o.status}
// // // // // // // // // // // // //               </span>
// // // // // // // // // // // // //             </div>

// // // // // // // // // // // // //             <ul style={{ paddingLeft: "20px", marginTop: "8px" }}>
// // // // // // // // // // // // //               {o.items?.map((item, idx) => (
// // // // // // // // // // // // //                 <li key={idx}>
// // // // // // // // // // // // //                   {item.name || item.menuItemId?.name} √ó {item.qty} ‚Äî ‚Çπ
// // // // // // // // // // // // //                   {item.price || item.menuItemId?.price || 0}
// // // // // // // // // // // // //                 </li>
// // // // // // // // // // // // //               ))}
// // // // // // // // // // // // //             </ul>

// // // // // // // // // // // // //             <p style={{ fontWeight: 600, marginTop: "8px", color: "#b8860b" }}>
// // // // // // // // // // // // //               Total: ‚Çπ
// // // // // // // // // // // // //               {o.items?.reduce(
// // // // // // // // // // // // //                 (sum, i) => sum + (i.qty * (i.price || i.menuItemId?.price || 0)),
// // // // // // // // // // // // //                 0
// // // // // // // // // // // // //               )}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         items.map((i) => (
// // // // // // // // // // // // //           <div key={i._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // // // // // // // // //             <p style={{ fontSize: "13px" }}>‚Çπ{i.price}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               {i.availability ? "‚úÖ Available" : "‚ùå Not Available"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // // // // //       {categories.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <span
// // // // // // // // // // // // //               key={c._id}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 backgroundColor: "#fff8dc",
// // // // // // // // // // // // //                 color: "#b8860b",
// // // // // // // // // // // // //                 padding: "6px 12px",
// // // // // // // // // // // // //                 borderRadius: "20px",
// // // // // // // // // // // // //                 border: "1px solid #d4af37",
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               {c.name}
// // // // // // // // // // // // //             </span>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </div>
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderStaff = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üë®‚Äçüç≥ Staff Members</h2>
// // // // // // // // // // // // //       {staff.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No staff registered.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         staff.map((s) => (
// // // // // // // // // // // // //           <div key={s._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{s.name}</h3>
// // // // // // // // // // // // //             <p style={{ fontSize: "13px" }}>{s.email}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               Role: {s.role || "Staff"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderTables = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>ü™ë Tables</h2>
// // // // // // // // // // // // //       {tables.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No tables found.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         tables.map((t) => (
// // // // // // // // // // // // //           <div key={t._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>Table #{t.number}</h3>
// // // // // // // // // // // // //             <div style={{ marginTop: "10px", textAlign: "center" }}>
// // // // // // // // // // // // //               <QRCodeCanvas
// // // // // // // // // // // // //                 value={`${window.location.origin}/menu/${t.qrSlug}`}
// // // // // // // // // // // // //                 size={80}
// // // // // // // // // // // // //                 bgColor="#fff"
// // // // // // // // // // // // //                 fgColor="#000"
// // // // // // // // // // // // //               />
// // // // // // // // // // // // //               <p style={{ fontSize: "12px", color: "#777", marginTop: "5px" }}>
// // // // // // // // // // // // //                 Slug: {t.qrSlug}
// // // // // // // // // // // // //               </p>
// // // // // // // // // // // // //             </div>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   /* ========== MAIN RETURN ========== */

// // // // // // // // // // // // //   return (
// // // // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // //       </header>

// // // // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // // // //         {[
// // // // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // // // //           <button
// // // // // // // // // // // // //             key={tab.key}
// // // // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // // // //             style={{
// // // // // // // // // // // // //               ...tabButton,
// // // // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // // // //             }}
// // // // // // // // // // // // //           >
// // // // // // // // // // // // //             {tab.label}
// // // // // // // // // // // // //           </button>
// // // // // // // // // // // // //         ))}
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );
// // // // // // // // // // // // // }

// // // // // // // // // // // // // /* ---- Styles ---- */
// // // // // // // // // // // // // const mainContainer = {
// // // // // // // // // // // // //   minHeight: "100vh",
// // // // // // // // // // // // //   background: "linear-gradient(180deg, #fffdf8, #fdf6e3)",
// // // // // // // // // // // // //   padding: "40px 20px",
// // // // // // // // // // // // //   fontFamily: "Poppins, sans-serif",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const tabContainer = {
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // //   flexWrap: "wrap",
// // // // // // // // // // // // //   gap: "10px",
// // // // // // // // // // // // //   marginBottom: "25px",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const tabButton = {
// // // // // // // // // // // // //   padding: "8px 16px",
// // // // // // // // // // // // //   border: "1px solid #d4af37",
// // // // // // // // // // // // //   borderRadius: "20px",
// // // // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // // //   fontWeight: "600",
// // // // // // // // // // // // //   fontSize: "14px",
// // // // // // // // // // // // //   transition: "0.3s",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const contentCard = {
// // // // // // // // // // // // //   backgroundColor: "#ffffff",
// // // // // // // // // // // // //   borderRadius: "15px",
// // // // // // // // // // // // //   padding: "25px",
// // // // // // // // // // // // //   boxShadow: "0 4px 10px rgba(212,175,55,0.15)",
// // // // // // // // // // // // //   maxWidth: "900px",
// // // // // // // // // // // // //   margin: "0 auto",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const loadingContainer = {
// // // // // // // // // // // // //   height: "100vh",
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   flexDirection: "column",
// // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // //   color: "#b7950b",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const spinner = {
// // // // // // // // // // // // //   width: "40px",
// // // // // // // // // // // // //   height: "40px",
// // // // // // // // // // // // //   border: "4px solid #f2e1a3",
// // // // // // // // // // // // //   borderTopColor: "#d4af37",
// // // // // // // // // // // // //   borderRadius: "50%",
// // // // // // // // // // // // //   animation: "spin 1s linear infinite",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const title = {
// // // // // // // // // // // // //   color: "#b8860b",
// // // // // // // // // // // // //   fontSize: "2.2rem",
// // // // // // // // // // // // //   fontWeight: "700",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const sectionTitle = {
// // // // // // // // // // // // //   fontSize: "18px",
// // // // // // // // // // // // //   color: "#8b7500",
// // // // // // // // // // // // //   marginBottom: "15px",
// // // // // // // // // // // // //   borderBottom: "1px solid #f0e6b2",
// // // // // // // // // // // // //   paddingBottom: "8px",
// // // // // // // // // // // // //   fontWeight: "600",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const emptyText = {
// // // // // // // // // // // // //   color: "#b8a000",
// // // // // // // // // // // // //   fontSize: "14px",
// // // // // // // // // // // // //   fontStyle: "italic",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const miniCard = {
// // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // //   borderRadius: "10px",
// // // // // // // // // // // // //   padding: "10px 15px",
// // // // // // // // // // // // //   marginBottom: "10px",
// // // // // // // // // // // // //   border: "1px solid #f3e6b0",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const cardHeader = {
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   justifyContent: "space-between",
// // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // // };
// // // // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // // // //   const [loading, setLoading] = useState(true);
// // // // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // // // //       try {
// // // // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };

// // // // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // // // //         ]);

// // // // // // // // // // // // //         console.log("üßæ Orders Response:", orderRes.data);

// // // // // // // // // // // // //         // ‚úÖ Safe parsing for all data types
// // // // // // // // // // // // //         setCategories(
// // // // // // // // // // // // //           catRes.data.categories || catRes.data.data || catRes.data || []
// // // // // // // // // // // // //         );
// // // // // // // // // // // // //         setTables(
// // // // // // // // // // // // //           tableRes.data.tables || tableRes.data.data || tableRes.data || []
// // // // // // // // // // // // //         );
// // // // // // // // // // // // //         setOrders(
// // // // // // // // // // // // //           orderRes.data.orders || orderRes.data.data || orderRes.data || []
// // // // // // // // // // // // //         );
// // // // // // // // // // // // //         setStaff(staffRes.data.staff || staffRes.data.data || staffRes.data || []);
// // // // // // // // // // // // //         setItems(menuRes.data.items || menuRes.data.data || menuRes.data || []);
// // // // // // // // // // // // //       } catch (err) {
// // // // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // // // //       } finally {
// // // // // // // // // // // // //         setLoading(false);
// // // // // // // // // // // // //       }
// // // // // // // // // // // // //     };

// // // // // // // // // // // // //     fetchData();
// // // // // // // // // // // // //   }, [token]);

// // // // // // // // // // // // //   if (loading) {
// // // // // // // // // // // // //     return (
// // // // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // // // //         <p>Loading Admin Panel...</p>
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     );
// // // // // // // // // // // // //   }

// // // // // // // // // // // // //   /* ========== RENDER SECTIONS ========== */

// // // // // // // // // // // // //   const renderOrders = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üßæ Current Orders</h2>
// // // // // // // // // // // // //       {!Array.isArray(orders) || orders.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No active orders yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         orders.map((o) => (
// // // // // // // // // // // // //           <div key={o._id} style={miniCard}>
// // // // // // // // // // // // //             <div style={cardHeader}>
// // // // // // // // // // // // //               <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // // // // // // // // // //                 Table #{o.tableId?.number || o.table?.number || "N/A"}
// // // // // // // // // // // // //               </h3>
// // // // // // // // // // // // //               <span
// // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // //                   backgroundColor:
// // // // // // // // // // // // //                     o.status === "served"
// // // // // // // // // // // // //                       ? "#e6ffe6"
// // // // // // // // // // // // //                       : o.status === "preparing"
// // // // // // // // // // // // //                       ? "#fff4cc"
// // // // // // // // // // // // //                       : "#f0f0f0",
// // // // // // // // // // // // //                   color:
// // // // // // // // // // // // //                     o.status === "served"
// // // // // // // // // // // // //                       ? "#006600"
// // // // // // // // // // // // //                       : o.status === "preparing"
// // // // // // // // // // // // //                       ? "#8b7500"
// // // // // // // // // // // // //                       : "#555",
// // // // // // // // // // // // //                   padding: "3px 10px",
// // // // // // // // // // // // //                   borderRadius: "8px",
// // // // // // // // // // // // //                   fontSize: "12px",
// // // // // // // // // // // // //                   border: "1px solid #d4af37",
// // // // // // // // // // // // //                 }}
// // // // // // // // // // // // //               >
// // // // // // // // // // // // //                 {o.status}
// // // // // // // // // // // // //               </span>
// // // // // // // // // // // // //             </div>

// // // // // // // // // // // // //             <ul style={{ paddingLeft: "20px", marginTop: "8px" }}>
// // // // // // // // // // // // //               {o.items?.map((item, idx) => (
// // // // // // // // // // // // //                 <li key={idx}>
// // // // // // // // // // // // //                   {item.name || item.menuItemId?.name} √ó {item.qty} ‚Äî ‚Çπ
// // // // // // // // // // // // //                   {item.price || item.menuItemId?.price || 0}
// // // // // // // // // // // // //                 </li>
// // // // // // // // // // // // //               ))}
// // // // // // // // // // // // //             </ul>

// // // // // // // // // // // // //             <p style={{ fontWeight: 600, marginTop: "8px", color: "#b8860b" }}>
// // // // // // // // // // // // //               Total: ‚Çπ
// // // // // // // // // // // // //               {o.items?.reduce(
// // // // // // // // // // // // //                 (sum, i) => sum + (i.qty * (i.price || i.menuItemId?.price || 0)),
// // // // // // // // // // // // //                 0
// // // // // // // // // // // // //               )}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         items.map((i) => (
// // // // // // // // // // // // //           <div key={i._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // // // // // // // // //             <p style={{ fontSize: "13px" }}>‚Çπ{i.price}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               {i.availability ? "‚úÖ Available" : "‚ùå Not Available"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // // // // //       {!Array.isArray(categories) || categories.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <span
// // // // // // // // // // // // //               key={c._id}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 backgroundColor: "#fff8dc",
// // // // // // // // // // // // //                 color: "#b8860b",
// // // // // // // // // // // // //                 padding: "6px 12px",
// // // // // // // // // // // // //                 borderRadius: "20px",
// // // // // // // // // // // // //                 border: "1px solid #d4af37",
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               {c.name}
// // // // // // // // // // // // //             </span>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </div>
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderStaff = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üë®‚Äçüç≥ Staff Members</h2>
// // // // // // // // // // // // //       {staff.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No staff registered.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         staff.map((s) => (
// // // // // // // // // // // // //           <div key={s._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{s.name}</h3>
// // // // // // // // // // // // //             <p style={{ fontSize: "13px" }}>{s.email}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               Role: {s.role || "Staff"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   const renderTables = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>ü™ë Tables</h2>
// // // // // // // // // // // // //       {tables.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No tables found.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         tables.map((t) => (
// // // // // // // // // // // // //           <div key={t._id} style={miniCard}>
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>Table #{t.number}</h3>
// // // // // // // // // // // // //             <div style={{ marginTop: "10px", textAlign: "center" }}>
// // // // // // // // // // // // //               <QRCodeCanvas
// // // // // // // // // // // // //                 value={`${window.location.origin}/menu/${t.qrSlug}`}
// // // // // // // // // // // // //                 size={80}
// // // // // // // // // // // // //                 bgColor="#fff"
// // // // // // // // // // // // //                 fgColor="#000"
// // // // // // // // // // // // //               />
// // // // // // // // // // // // //               <p style={{ fontSize: "12px", color: "#777", marginTop: "5px" }}>
// // // // // // // // // // // // //                 Slug: {t.qrSlug}
// // // // // // // // // // // // //               </p>
// // // // // // // // // // // // //             </div>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   /* ========== MAIN RETURN ========== */

// // // // // // // // // // // // //   return (
// // // // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // //       </header>

// // // // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // // // //         {[
// // // // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // // // //           <button
// // // // // // // // // // // // //             key={tab.key}
// // // // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // // // //             style={{
// // // // // // // // // // // // //               ...tabButton,
// // // // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // // // //             }}
// // // // // // // // // // // // //           >
// // // // // // // // // // // // //             {tab.label}
// // // // // // // // // // // // //           </button>
// // // // // // // // // // // // //         ))}
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );
// // // // // // // // // // // // // }

// // // // // // // // // // // // // /* ---- Styles ---- */
// // // // // // // // // // // // // const mainContainer = {
// // // // // // // // // // // // //   minHeight: "100vh",
// // // // // // // // // // // // //   background: "linear-gradient(180deg, #fffdf8, #fdf6e3)",
// // // // // // // // // // // // //   padding: "40px 20px",
// // // // // // // // // // // // //   fontFamily: "Poppins, sans-serif",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const tabContainer = {
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // //   flexWrap: "wrap",
// // // // // // // // // // // // //   gap: "10px",
// // // // // // // // // // // // //   marginBottom: "25px",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const tabButton = {
// // // // // // // // // // // // //   padding: "8px 16px",
// // // // // // // // // // // // //   border: "1px solid #d4af37",
// // // // // // // // // // // // //   borderRadius: "20px",
// // // // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // // //   fontWeight: "600",
// // // // // // // // // // // // //   fontSize: "14px",
// // // // // // // // // // // // //   transition: "0.3s",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const contentCard = {
// // // // // // // // // // // // //   backgroundColor: "#ffffff",
// // // // // // // // // // // // //   borderRadius: "15px",
// // // // // // // // // // // // //   padding: "25px",
// // // // // // // // // // // // //   boxShadow: "0 4px 10px rgba(212,175,55,0.15)",
// // // // // // // // // // // // //   maxWidth: "900px",
// // // // // // // // // // // // //   margin: "0 auto",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const loadingContainer = {
// // // // // // // // // // // // //   height: "100vh",
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   flexDirection: "column",
// // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // //   color: "#b7950b",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const spinner = {
// // // // // // // // // // // // //   width: "40px",
// // // // // // // // // // // // //   height: "40px",
// // // // // // // // // // // // //   border: "4px solid #f2e1a3",
// // // // // // // // // // // // //   borderTopColor: "#d4af37",
// // // // // // // // // // // // //   borderRadius: "50%",
// // // // // // // // // // // // //   animation: "spin 1s linear infinite",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const title = {
// // // // // // // // // // // // //   color: "#b8860b",
// // // // // // // // // // // // //   fontSize: "2.2rem",
// // // // // // // // // // // // //   fontWeight: "700",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const sectionTitle = {
// // // // // // // // // // // // //   fontSize: "18px",
// // // // // // // // // // // // //   color: "#8b7500",
// // // // // // // // // // // // //   marginBottom: "15px",
// // // // // // // // // // // // //   borderBottom: "1px solid #f0e6b2",
// // // // // // // // // // // // //   paddingBottom: "8px",
// // // // // // // // // // // // //   fontWeight: "600",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const emptyText = {
// // // // // // // // // // // // //   color: "#b8a000",
// // // // // // // // // // // // //   fontSize: "14px",
// // // // // // // // // // // // //   fontStyle: "italic",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const miniCard = {
// // // // // // // // // // // // //   backgroundColor: "#fffaf0",
// // // // // // // // // // // // //   borderRadius: "10px",
// // // // // // // // // // // // //   padding: "10px 15px",
// // // // // // // // // // // // //   marginBottom: "10px",
// // // // // // // // // // // // //   border: "1px solid #f3e6b0",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const cardHeader = {
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   justifyContent: "space-between",
// // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // // };
// // // // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // // // // // //   // ‚úÖ New states for upload
// // // // // // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // // // //       try {
// // // // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // // // //         ]);

// // // // // // // // // // // // //         setCategories(catRes.data.categories || []);
// // // // // // // // // // // // //         setTables(tableRes.data.tables || []);
// // // // // // // // // // // // //         setOrders(orderRes.data.orders || []);
// // // // // // // // // // // // //         setStaff(staffRes.data.staff || []);
// // // // // // // // // // // // //         setItems(menuRes.data.items || []);
// // // // // // // // // // // // //       } catch (err) {
// // // // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // // // //       } finally {
// // // // // // // // // // // // //         setLoading(false);
// // // // // // // // // // // // //       }
// // // // // // // // // // // // //     };

// // // // // // // // // // // // //     fetchData();
// // // // // // // // // // // // //   }, [token]);

// // // // // // // // // // // // //   // ‚úÖ Handle image upload using multer route
// // // // // // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // // // // // //     const formData = new FormData();
// // // // // // // // // // // // //     formData.append("image", file);
// // // // // // // // // // // // //     setUploading(true);
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // // // // // //       });
// // // // // // // // // // // // //       setUploading(false);
// // // // // // // // // // // // //       return res.data.imageUrl;
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // // // // // //       setUploading(false);
// // // // // // // // // // // // //       return null;
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // ‚úÖ Add new menu item
// // // // // // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // // // //       if (newItem.image) {
// // // // // // // // // // // // //         imageUrl = await handleUpload(newItem.image);
// // // // // // // // // // // // //       }

// // // // // // // // // // // // //       const payload = {
// // // // // // // // // // // // //         name: newItem.name,
// // // // // // // // // // // // //         price: newItem.price,
// // // // // // // // // // // // //         categoryId: newItem.categoryId,
// // // // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // // // //       };

// // // // // // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // // // //       });

// // // // // // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // ‚úÖ Add new category
// // // // // // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // // // //       if (newCategory.image) {
// // // // // // // // // // // // //         imageUrl = await handleUpload(newCategory.image);
// // // // // // // // // // // // //       }

// // // // // // // // // // // // //       const payload = {
// // // // // // // // // // // // //         name: newCategory.name,
// // // // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // // // //       };

// // // // // // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // // // //       });

// // // // // // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   if (loading) {
// // // // // // // // // // // // //     return (
// // // // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // // // //         <p>Loading Admin Panel...</p>
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     );
// // // // // // // // // // // // //   }

// // // // // // // // // // // // //   /* ========== RENDER SECTIONS ========== */

// // // // // // // // // // // // //   // ‚úÖ Menu with image upload
// // // // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>

// // // // // // // // // // // // //       {/* Add new item form */}
// // // // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="text"
// // // // // // // // // // // // //           placeholder="Item Name"
// // // // // // // // // // // // //           value={newItem.name}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="number"
// // // // // // // // // // // // //           placeholder="Price"
// // // // // // // // // // // // //           value={newItem.price}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <select
// // // // // // // // // // // // //           value={newItem.categoryId}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         >
// // // // // // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <option key={c._id} value={c._id}>
// // // // // // // // // // // // //               {c.name}
// // // // // // // // // // // // //             </option>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </select>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="file"
// // // // // // // // // // // // //           accept="image/*"
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// // // // // // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // // // // // //         </button>
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       {/* Display existing items */}
// // // // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         items.map((i) => (
// // // // // // // // // // // // //           <div key={i._id} style={miniCard}>
// // // // // // // // // // // // //             {i.image && <img src={i.image} alt={i.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // // // // // // // // //             <p>‚Çπ{i.price}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               {i.availability ? "‚úÖ Available" : "‚ùå Not Available"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   // ‚úÖ Category upload section
// // // // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>

// // // // // // // // // // // // //       {/* Add new category form */}
// // // // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="text"
// // // // // // // // // // // // //           placeholder="Category Name"
// // // // // // // // // // // // //           value={newCategory.name}
// // // // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="file"
// // // // // // // // // // // // //           accept="image/*"
// // // // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// // // // // // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // // // // // //         </button>
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       {!Array.isArray(categories) || categories.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <div key={c._id} style={miniCard}>
// // // // // // // // // // // // //               {c.image && <img src={c.image} alt={c.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // // // //               <p style={{ color: "#b8860b" }}>{c.name}</p>
// // // // // // // // // // // // //             </div>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </div>
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   /* MAIN RETURN */
// // // // // // // // // // // // //   return (
// // // // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // //       </header>

// // // // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // // // //         {[
// // // // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // // // //           <button
// // // // // // // // // // // // //             key={tab.key}
// // // // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // // // //             style={{
// // // // // // // // // // // // //               ...tabButton,
// // // // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // // // //             }}
// // // // // // // // // // // // //           >
// // // // // // // // // // // // //             {tab.label}
// // // // // // // // // // // // //           </button>
// // // // // // // // // // // // //         ))}
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );
// // // // // // // // // // // // // }

// // // // // // // // // // // // // /* ========== Extra Styles for forms ========== */
// // // // // // // // // // // // // const formBox = { marginBottom: "20px", display: "flex", flexWrap: "wrap", gap: "10px" };
// // // // // // // // // // // // // const inputStyle = { padding: "8px", border: "1px solid #ccc", borderRadius: "5px" };
// // // // // // // // // // // // // const addButton = {
// // // // // // // // // // // // //   backgroundColor: "#d4af37",
// // // // // // // // // // // // //   color: "#fff",
// // // // // // // // // // // // //   border: "none",
// // // // // // // // // // // // //   padding: "8px 15px",
// // // // // // // // // // // // //   borderRadius: "5px",
// // // // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // // // };
// // // // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // // // // // //   // ‚úÖ New states for upload
// // // // // // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // // // //       try {
// // // // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // // // //         ]);

// // // // // // // // // // // // //         setCategories(catRes.data.categories || []);
// // // // // // // // // // // // //         setTables(tableRes.data.tables || []);
// // // // // // // // // // // // //         setOrders(orderRes.data.orders || []);
// // // // // // // // // // // // //         setStaff(staffRes.data.staff || []);
// // // // // // // // // // // // //         setItems(menuRes.data.items || []);
// // // // // // // // // // // // //       } catch (err) {
// // // // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // // // //       } finally {
// // // // // // // // // // // // //         setLoading(false);
// // // // // // // // // // // // //       }
// // // // // // // // // // // // //     };

// // // // // // // // // // // // //     fetchData();
// // // // // // // // // // // // //   }, [token]);

// // // // // // // // // // // // //   // ‚úÖ Handle image upload using multer route
// // // // // // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // // // // // //     const formData = new FormData();
// // // // // // // // // // // // //     formData.append("image", file);
// // // // // // // // // // // // //     setUploading(true);
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // // // // // //       });
// // // // // // // // // // // // //       setUploading(false);
// // // // // // // // // // // // //       return res.data.imageUrl;
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // // // // // //       setUploading(false);
// // // // // // // // // // // // //       return null;
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // ‚úÖ Add new menu item
// // // // // // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // // // //       if (newItem.image) {
// // // // // // // // // // // // //         imageUrl = await handleUpload(newItem.image);
// // // // // // // // // // // // //       }

// // // // // // // // // // // // //       const payload = {
// // // // // // // // // // // // //         name: newItem.name,
// // // // // // // // // // // // //         price: newItem.price,
// // // // // // // // // // // // //         categoryId: newItem.categoryId,
// // // // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // // // //       };

// // // // // // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // // // //       });

// // // // // // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // ‚úÖ Add new category
// // // // // // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // // // //       if (newCategory.image) {
// // // // // // // // // // // // //         imageUrl = await handleUpload(newCategory.image);
// // // // // // // // // // // // //       }

// // // // // // // // // // // // //       const payload = {
// // // // // // // // // // // // //         name: newCategory.name,
// // // // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // // // //       };

// // // // // // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // // // //       });

// // // // // // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // // // // // //     } catch (err) {
// // // // // // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   /* ========== üåÄ FIXED LOADING UI ========== */
// // // // // // // // // // // // //   if (loading) {
// // // // // // // // // // // // //     return (
// // // // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // // // //         <p style={{ color: "#b8860b", fontWeight: "bold" }}>Loading Admin Panel...</p>
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     );
// // // // // // // // // // // // //   }

// // // // // // // // // // // // //   /* ========== RENDER SECTIONS ========== */

// // // // // // // // // // // // //   // ‚úÖ Menu with image upload
// // // // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>

// // // // // // // // // // // // //       {/* Add new item form */}
// // // // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="text"
// // // // // // // // // // // // //           placeholder="Item Name"
// // // // // // // // // // // // //           value={newItem.name}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="number"
// // // // // // // // // // // // //           placeholder="Price"
// // // // // // // // // // // // //           value={newItem.price}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <select
// // // // // // // // // // // // //           value={newItem.categoryId}
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         >
// // // // // // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <option key={c._id} value={c._id}>
// // // // // // // // // // // // //               {c.name}
// // // // // // // // // // // // //             </option>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </select>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="file"
// // // // // // // // // // // // //           accept="image/*"
// // // // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// // // // // // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // // // // // //         </button>
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       {/* Display existing items */}
// // // // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         items.map((i) => (
// // // // // // // // // // // // //           <div key={i._id} style={miniCard}>
// // // // // // // // // // // // //             {i.image && <img src={i.image} alt={i.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // // // // // // // // //             <p>‚Çπ{i.price}</p>
// // // // // // // // // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // // // // // // // // //               {i.availability ? "‚úÖ Available" : "‚ùå Not Available"}
// // // // // // // // // // // // //             </p>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         ))
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   // ‚úÖ Category upload section
// // // // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // // // //     <div>
// // // // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>

// // // // // // // // // // // // //       {/* Add new category form */}
// // // // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="text"
// // // // // // // // // // // // //           placeholder="Category Name"
// // // // // // // // // // // // //           value={newCategory.name}
// // // // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <input
// // // // // // // // // // // // //           type="file"
// // // // // // // // // // // // //           accept="image/*"
// // // // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// // // // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // // // //         />
// // // // // // // // // // // // //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// // // // // // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // // // // // //         </button>
// // // // // // // // // // // // //       </div>

// // // // // // // // // // // // //       {!Array.isArray(categories) || categories.length === 0 ? (
// // // // // // // // // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // // // //       ) : (
// // // // // // // // // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // // // //             <div key={c._id} style={miniCard}>
// // // // // // // // // // // // //               {c.image && <img src={c.image} alt={c.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // // // //               <p style={{ color: "#b8860b" }}>{c.name}</p>
// // // // // // // // // // // // //             </div>
// // // // // // // // // // // // //           ))}
// // // // // // // // // // // // //         </div>
// // // // // // // // // // // // //       )}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );

// // // // // // // // // // // // //   /* MAIN RETURN */
// // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // // //       </header>

// // // // // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // // // // //         {[
// // // // // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // // // // //           <button
// // // // // // // // // // // // // //             key={tab.key}
// // // // // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // //               ...tabButton,
// // // // // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // //           >
// // // // // // // // // // // // // //             {tab.label}
// // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // //         ))}
// // // // // // // // // // // // // //       </div>

// // // // // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // // // // //         {activeTab === "orders" && renderOrders?.()}
// // // // // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // // // // //         {activeTab === "staff" && renderStaff?.()}
// // // // // // // // // // // // // //         {activeTab === "tables" && renderTables?.()}
// // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // //     </div>
// // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // }
// // // // // // // // // // // // // return (
// // // // // // // // // // // // //   <div style={mainContainer}>
// // // // // // // // // // // // //     <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // // // //       <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // // // //     </header>

// // // // // // // // // // // // //     <div style={tabContainer}>
// // // // // // // // // // // // //       {[
// // // // // // // // // // // // //         { key: "orders", label: "Orders" },
// // // // // // // // // // // // //         { key: "menu", label: "Menu Items" },
// // // // // // // // // // // // //         { key: "categories", label: "Categories" },
// // // // // // // // // // // // //         { key: "staff", label: "Staff" },
// // // // // // // // // // // // //         { key: "tables", label: "Tables" },
// // // // // // // // // // // // //       ].map((tab) => (
// // // // // // // // // // // // //         <button
// // // // // // // // // // // // //           key={tab.key}
// // // // // // // // // // // // //           onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // // // //           style={{
// // // // // // // // // // // // //             ...tabButton,
// // // // // // // // // // // // //             backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // // // //             color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // // // //           }}
// // // // // // // // // // // // //         >
// // // // // // // // // // // // //           {tab.label}
// // // // // // // // // // // // //         </button>
// // // // // // // // // // // // //       ))}
// // // // // // // // // // // // //     </div>

// // // // // // // // // // // // //     <div style={contentCard}>
// // // // // // // // // // // // //       {activeTab === "orders" && renderOrders?.()}
// // // // // // // // // // // // //       {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // // // //       {activeTab === "categories" && renderCategories()}
// // // // // // // // // // // // //       {activeTab === "staff" && renderStaff?.()}
// // // // // // // // // // // // //       {activeTab === "tables" && renderTables?.()}
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   </div>
// // // // // // // // // // // // // );


// // // // // // // // // // // // // /* ========== STYLES ========== */
// // // // // // // // // // // // // const loadingContainer = {
// // // // // // // // // // // // //   display: "flex",
// // // // // // // // // // // // //   flexDirection: "column",
// // // // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // // // //   height: "100vh",
// // // // // // // // // // // // //   background: "#fff8dc",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // const spinner = {
// // // // // // // // // // // // //   width: "50px",
// // // // // // // // // // // // //   height: "50px",
// // // // // // // // // // // // //   border: "5px solid #d4af37",
// // // // // // // // // // // // //   borderTop: "5px solid transparent",
// // // // // // // // // // // // //   borderRadius: "50%",
// // // // // // // // // // // // //   animation: "spin 1s linear infinite",
// // // // // // // // // // // // // };

// // // // // // // // // // // // // /* For CSS animation */
// // // // // // // // // // // // // const style = document.createElement("style");
// // // // // // // // // // // // // style.innerHTML = `
// // // // // // // // // // // // // @keyframes spin {
// // // // // // // // // // // // //   from { transform: rotate(0deg); }
// // // // // // // // // // // // //   to { transform: rotate(360deg); }
// // // // // // // // // // // // // }`;
// // // // // // // // // // // // // document.head.appendChild(style);

// // // // // // // // // // // // // const formBox = { marginBottom: "20px", display: "flex", flexWrap: "wrap", gap: "10px" };
// // // // // // // // // // // // // const inputStyle = { padding: "8px", border: "1px solid #ccc", borderRadius: "5px" };
// // // // // // // // // // // // // const addButton = {
// // // // // // // // // // // // //   backgroundColor: "#d4af37",
// // // // // // // // // // // // //   color: "#fff",
// // // // // // // // // // // // //   border: "none",
// // // // // // // // // // // // //   padding: "8px 15px",
// // // // // // // // // // // // //   borderRadius: "5px",
// // // // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // // // };
// // // // // // // // // // // // // routes/upload.js
// // // // // // // // // // // // const express = require("express");
// // // // // // // // // // // // const multer = require("multer");
// // // // // // // // // // // // const path = require("path");
// // // // // // // // // // // // const router = express.Router();

// // // // // // // // // // // // const storage = multer.diskStorage({
// // // // // // // // // // // //   destination: (req, file, cb) => cb(null, "uploads/"),
// // // // // // // // // // // //   filename: (req, file, cb) => cb(null, Date.now() + path.extname(file.originalname)),
// // // // // // // // // // // // });

// // // // // // // // // // // // const upload = multer({ storage });

// // // // // // // // // // // // router.post("/", upload.single("image"), (req, res) => {
// // // // // // // // // // // //   if (!req.file) return res.status(400).json({ error: "No file uploaded" });
// // // // // // // // // // // //   res.json({ imageUrl: `/uploads/${req.file.filename}` });
// // // // // // // // // // // // });

// // // // // // // // // // // // // module.exports = router;
// // // // // // // // // // // // // ...your entire component code above...

// // // // // // // // // // // // // üü¢ Keep the last curly brace for the function
// // // // // // // // // // // // // }

// // // // // // // // // // // // // ‚úÖ Finally, export the component
// // // // // // // // // // // // export default AdminPanel;
// // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // //   const [activeTab, setActiveTab] = useState("menu");
// // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // // // //   // ‚úÖ For uploads
// // // // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // //   // ‚úÖ Fetch all data
// // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // //       try {
// // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // //         ]);

// // // // // // // // // // //         setCategories(catRes.data.categories || []);
// // // // // // // // // // //         setTables(tableRes.data.tables || []);
// // // // // // // // // // //         setOrders(orderRes.data.orders || []);
// // // // // // // // // // //         setStaff(staffRes.data.staff || []);
// // // // // // // // // // //         setItems(menuRes.data.items || []);
// // // // // // // // // // //       } catch (err) {
// // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // //       } finally {
// // // // // // // // // // //         setLoading(false);
// // // // // // // // // // //       }
// // // // // // // // // // //     };
// // // // // // // // // // //     fetchData();
// // // // // // // // // // //   }, [token]);

// // // // // // // // // // //   // ‚úÖ Upload image via multer route
// // // // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // // // //     const formData = new FormData();
// // // // // // // // // // //     formData.append("image", file);
// // // // // // // // // // //     setUploading(true);
// // // // // // // // // // //     try {
// // // // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // // // //       });
// // // // // // // // // // //       setUploading(false);
// // // // // // // // // // //       return res.data.imageUrl;
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // // // //       setUploading(false);
// // // // // // // // // // //       return null;
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   // ‚úÖ Add new menu item
// // // // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // // // //     try {
// // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // //       if (newItem.image) {
// // // // // // // // // // //         imageUrl = await handleUpload(newItem.image);
// // // // // // // // // // //       }

// // // // // // // // // // //       const payload = {
// // // // // // // // // // //         name: newItem.name,
// // // // // // // // // // //         price: newItem.price,
// // // // // // // // // // //         categoryId: newItem.categoryId,
// // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // //       };

// // // // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // //       });

// // // // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   // ‚úÖ Add new category
// // // // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // // // //     try {
// // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // //       if (newCategory.image) {
// // // // // // // // // // //         imageUrl = await handleUpload(newCategory.image);
// // // // // // // // // // //       }

// // // // // // // // // // //       const payload = {
// // // // // // // // // // //         name: newCategory.name,
// // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // //       };

// // // // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // //       });

// // // // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   // ‚úÖ Loading screen
// // // // // // // // // // //   if (loading) {
// // // // // // // // // // //     return (
// // // // // // // // // // //       <div style={loadingContainer}>
// // // // // // // // // // //         <div style={spinner}></div>
// // // // // // // // // // //         <p style={{ color: "#b8860b", fontWeight: "bold" }}>Loading Admin Panel...</p>
// // // // // // // // // // //       </div>
// // // // // // // // // // //     );
// // // // // // // // // // //   }

// // // // // // // // // // //   // ‚úÖ Render menu items
// // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="text"
// // // // // // // // // // //           placeholder="Item Name"
// // // // // // // // // // //           value={newItem.name}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="number"
// // // // // // // // // // //           placeholder="Price"
// // // // // // // // // // //           value={newItem.price}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <select
// // // // // // // // // // //           value={newItem.categoryId}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         >
// // // // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // //             <option key={c._id} value={c._id}>
// // // // // // // // // // //               {c.name}
// // // // // // // // // // //             </option>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </select>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="file"
// // // // // // // // // // //           accept="image/*"
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// // // // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // // // //         </button>
// // // // // // // // // // //       </div>

// // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         items.map((i) => (
// // // // // // // // // // //           <div key={i._id} style={miniCard}>
// // // // // // // // // // //             {i.image && <img src={i.image} alt={i.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // // // // // // //             <p>‚Çπ{i.price}</p>
// // // // // // // // // // //           </div>
// // // // // // // // // // //         ))
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   // ‚úÖ Render categories
// // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="text"
// // // // // // // // // // //           placeholder="Category Name"
// // // // // // // // // // //           value={newCategory.name}
// // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="file"
// // // // // // // // // // //           accept="image/*"
// // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// // // // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // // // //         </button>
// // // // // // // // // // //       </div>

// // // // // // // // // // //       {!Array.isArray(categories) || categories.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // //             <div key={c._id} style={miniCard}>
// // // // // // // // // // //               {c.image && <img src={c.image} alt={c.name} style={{ width: 80, borderRadius: 8 }} />}
// // // // // // // // // // //               <p style={{ color: "#b8860b" }}>{c.name}</p>
// // // // // // // // // // //             </div>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </div>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   // ‚úÖ Main UI
// // // // // // // // // // //   return (
// // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // // // //       </header>

// // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // //         {[
// // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // //           <button
// // // // // // // // // // //             key={tab.key}
// // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               ...tabButton,
// // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             {tab.label}
// // // // // // // // // // //           </button>
// // // // // // // // // // //         ))}
// // // // // // // // // // //       </div>

// // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // //         {activeTab === "orders" && <p>Orders Section Coming Soon...</p>}
// // // // // // // // // // //         {activeTab === "staff" && <p>Staff Section Coming Soon...</p>}
// // // // // // // // // // //         {activeTab === "tables" && <p>Tables Section Coming Soon...</p>}
// // // // // // // // // // //       </div>
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );
// // // // // // // // // // // }

// // // // // // // // // // // /* üé® STYLES */
// // // // // // // // // // // const mainContainer = {
// // // // // // // // // // //   padding: "40px",
// // // // // // // // // // //   fontFamily: "Poppins, sans-serif",
// // // // // // // // // // //   background: "#fff8dc",
// // // // // // // // // // //   minHeight: "100vh",
// // // // // // // // // // // };

// // // // // // // // // // // const title = {
// // // // // // // // // // //   color: "#b8860b",
// // // // // // // // // // //   fontSize: "28px",
// // // // // // // // // // //   fontWeight: "bold",
// // // // // // // // // // // };

// // // // // // // // // // // const tabContainer = {
// // // // // // // // // // //   display: "flex",
// // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // //   gap: "10px",
// // // // // // // // // // //   marginBottom: "25px",
// // // // // // // // // // //   flexWrap: "wrap",
// // // // // // // // // // // };

// // // // // // // // // // // const tabButton = {
// // // // // // // // // // //   padding: "10px 18px",
// // // // // // // // // // //   borderRadius: "8px",
// // // // // // // // // // //   border: "2px solid #d4af37",
// // // // // // // // // // //   fontWeight: "bold",
// // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // };

// // // // // // // // // // // const contentCard = {
// // // // // // // // // // //   background: "#fff",
// // // // // // // // // // //   padding: "25px",
// // // // // // // // // // //   borderRadius: "12px",
// // // // // // // // // // //   boxShadow: "0 4px 10px rgba(0,0,0,0.1)",
// // // // // // // // // // // };

// // // // // // // // // // // const formBox = { marginBottom: "20px", display: "flex", flexWrap: "wrap", gap: "10px" };
// // // // // // // // // // // const inputStyle = { padding: "8px", border: "1px solid #ccc", borderRadius: "5px" };
// // // // // // // // // // // const addButton = {
// // // // // // // // // // //   backgroundColor: "#d4af37",
// // // // // // // // // // //   color: "#fff",
// // // // // // // // // // //   border: "none",
// // // // // // // // // // //   padding: "8px 15px",
// // // // // // // // // // //   borderRadius: "5px",
// // // // // // // // // // //   cursor: "pointer",
// // // // // // // // // // // };
// // // // // // // // // // // const sectionTitle = { color: "#b8860b", marginBottom: "10px" };
// // // // // // // // // // // const miniCard = {
// // // // // // // // // // //   border: "1px solid #eee",
// // // // // // // // // // //   borderRadius: "8px",
// // // // // // // // // // //   padding: "10px",
// // // // // // // // // // //   width: "140px",
// // // // // // // // // // //   textAlign: "center",
// // // // // // // // // // //   background: "#fff",
// // // // // // // // // // // };
// // // // // // // // // // // const emptyText = { color: "#999", fontStyle: "italic" };
// // // // // // // // // // // const loadingContainer = {
// // // // // // // // // // //   display: "flex",
// // // // // // // // // // //   flexDirection: "column",
// // // // // // // // // // //   alignItems: "center",
// // // // // // // // // // //   justifyContent: "center",
// // // // // // // // // // //   height: "100vh",
// // // // // // // // // // //   background: "#fff8dc",
// // // // // // // // // // // };
// // // // // // // // // // // const spinner = {
// // // // // // // // // // //   width: "50px",
// // // // // // // // // // //   height: "50px",
// // // // // // // // // // //   border: "5px solid #d4af37",
// // // // // // // // // // //   borderTop: "5px solid transparent",
// // // // // // // // // // //   borderRadius: "50%",
// // // // // // // // // // //   animation: "spin 1s linear infinite",
// // // // // // // // // // // };

// // // // // // // // // // // // Inject CSS animation for spinner
// // // // // // // // // // // const style = document.createElement("style");
// // // // // // // // // // // style.innerHTML = `
// // // // // // // // // // // @keyframes spin {
// // // // // // // // // // //   from { transform: rotate(0deg); }
// // // // // // // // // // //   to { transform: rotate(360deg); }
// // // // // // // // // // // }`;
// // // // // // // // // // // document.head.appendChild(style);
// // // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // // import api from "../services/api";
// // // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // // //   const [activeTab, setActiveTab] = useState("menu");
// // // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // // //   // ‚úÖ Fetch all data on load
// // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // // //       try {
// // // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.allSettled([
// // // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // // //         ]);

// // // // // // // // // // //         if (catRes.value) setCategories(catRes.value.data.categories || []);
// // // // // // // // // // //         if (tableRes.value) setTables(tableRes.value.data.tables || []);
// // // // // // // // // // //         if (orderRes.value) setOrders(orderRes.value.data.orders || []);
// // // // // // // // // // //         if (staffRes.value) setStaff(staffRes.value.data.staff || []);
// // // // // // // // // // //         if (menuRes.value) setItems(menuRes.value.data.items || []);
// // // // // // // // // // //       } catch (err) {
// // // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // // //       } finally {
// // // // // // // // // // //         setLoading(false);
// // // // // // // // // // //       }
// // // // // // // // // // //     };
// // // // // // // // // // //     fetchData();
// // // // // // // // // // //   }, [token]);

// // // // // // // // // // //   // ‚úÖ Image upload via multer
// // // // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // // // //     const formData = new FormData();
// // // // // // // // // // //     formData.append("image", file);
// // // // // // // // // // //     setUploading(true);
// // // // // // // // // // //     try {
// // // // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // // // //       });
// // // // // // // // // // //       setUploading(false);
// // // // // // // // // // //       return res.data.imageUrl;
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // // // //       setUploading(false);
// // // // // // // // // // //       return null;
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   // ‚úÖ Add Menu Item
// // // // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // // // //     try {
// // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // //       if (newItem.image) {
// // // // // // // // // // //         imageUrl = await handleUpload(newItem.image);
// // // // // // // // // // //       }

// // // // // // // // // // //       const payload = {
// // // // // // // // // // //         name: newItem.name,
// // // // // // // // // // //         price: newItem.price,
// // // // // // // // // // //         categoryId: newItem.categoryId,
// // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // //       };

// // // // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // //       });

// // // // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   // ‚úÖ Add Category
// // // // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // // // //     try {
// // // // // // // // // // //       let imageUrl = "";
// // // // // // // // // // //       if (newCategory.image) {
// // // // // // // // // // //         imageUrl = await handleUpload(newCategory.image);
// // // // // // // // // // //       }

// // // // // // // // // // //       const payload = {
// // // // // // // // // // //         name: newCategory.name,
// // // // // // // // // // //         image: imageUrl,
// // // // // // // // // // //       };

// // // // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // // //       });

// // // // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // // // //     } catch (err) {
// // // // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   if (loading) {
// // // // // // // // // // //     return <div style={{ textAlign: "center", marginTop: "50px" }}>Loading Admin Panel...</div>;
// // // // // // // // // // //   }

// // // // // // // // // // //   // ‚úÖ Render Orders
// // // // // // // // // // //   const renderOrders = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üßæ Orders</h2>
// // // // // // // // // // //       {orders.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No orders yet.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // // //           {orders.map((o) => (
// // // // // // // // // // //             <div key={o._id} style={miniCard}>
// // // // // // // // // // //               <p><b>Table:</b> {o.tableSlug}</p>
// // // // // // // // // // //               <p><b>Total:</b> ‚Çπ{o.total || "N/A"}</p>
// // // // // // // // // // //               <p><b>Status:</b> {o.status}</p>
// // // // // // // // // // //               <ul>
// // // // // // // // // // //                 {o.items.map((it, idx) => (
// // // // // // // // // // //                   <li key={idx}>
// // // // // // // // // // //                     {it.name} √ó {it.quantity}
// // // // // // // // // // //                   </li>
// // // // // // // // // // //                 ))}
// // // // // // // // // // //               </ul>
// // // // // // // // // // //             </div>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </div>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   // ‚úÖ Render Staff
// // // // // // // // // // //   const renderStaff = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üë©‚Äçüç≥ Staff Members</h2>
// // // // // // // // // // //       {staff.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No staff found.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <table style={tableStyle}>
// // // // // // // // // // //           <thead>
// // // // // // // // // // //             <tr>
// // // // // // // // // // //               <th>Name</th>
// // // // // // // // // // //               <th>Email</th>
// // // // // // // // // // //               <th>Role</th>
// // // // // // // // // // //             </tr>
// // // // // // // // // // //           </thead>
// // // // // // // // // // //           <tbody>
// // // // // // // // // // //             {staff.map((s) => (
// // // // // // // // // // //               <tr key={s._id}>
// // // // // // // // // // //                 <td>{s.name}</td>
// // // // // // // // // // //                 <td>{s.email}</td>
// // // // // // // // // // //                 <td>{s.role}</td>
// // // // // // // // // // //               </tr>
// // // // // // // // // // //             ))}
// // // // // // // // // // //           </tbody>
// // // // // // // // // // //         </table>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   // ‚úÖ Render Tables
// // // // // // // // // // //   const renderTables = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>ü™ë Tables & QR Codes</h2>
// // // // // // // // // // //       {tables.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No tables available.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // // //           {tables.map((t) => (
// // // // // // // // // // //             <div key={t._id} style={miniCard}>
// // // // // // // // // // //               <h4>{t.name || t.slug}</h4>
// // // // // // // // // // //               <QRCodeCanvas value={`http://localhost:5173/menu/${t.slug}`} size={80} />
// // // // // // // // // // //               <p>Status: {t.status}</p>
// // // // // // // // // // //             </div>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </div>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   // ‚úÖ Render Menu Items & Categories
// // // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="text"
// // // // // // // // // // //           placeholder="Item Name"
// // // // // // // // // // //           value={newItem.name}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="number"
// // // // // // // // // // //           placeholder="Price"
// // // // // // // // // // //           value={newItem.price}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <select
// // // // // // // // // // //           value={newItem.categoryId}
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         >
// // // // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // //             <option key={c._id} value={c._id}>
// // // // // // // // // // //               {c.name}
// // // // // // // // // // //             </option>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </select>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="file"
// // // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// // // // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // // // //         </button>
// // // // // // // // // // //       </div>

// // // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No menu items yet.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // // //           {items.map((i) => (
// // // // // // // // // // //             <div key={i._id} style={miniCard}>
// // // // // // // // // // //               {i.image && <img src={i.image} alt={i.name} width={80} />}
// // // // // // // // // // //               <p>{i.name}</p>
// // // // // // // // // // //               <p>‚Çπ{i.price}</p>
// // // // // // // // // // //             </div>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </div>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // // //     <div>
// // // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // // //       <div style={formBox}>
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="text"
// // // // // // // // // // //           placeholder="Category Name"
// // // // // // // // // // //           value={newCategory.name}
// // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <input
// // // // // // // // // // //           type="file"
// // // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// // // // // // // // // // //           style={inputStyle}
// // // // // // // // // // //         />
// // // // // // // // // // //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// // // // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // // // //         </button>
// // // // // // // // // // //       </div>

// // // // // // // // // // //       {categories.length === 0 ? (
// // // // // // // // // // //         <p style={emptyText}>No categories yet.</p>
// // // // // // // // // // //       ) : (
// // // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // // //             <div key={c._id} style={miniCard}>
// // // // // // // // // // //               {c.image && <img src={c.image} alt={c.name} width={80} />}
// // // // // // // // // // //               <p>{c.name}</p>
// // // // // // // // // // //             </div>
// // // // // // // // // // //           ))}
// // // // // // // // // // //         </div>
// // // // // // // // // // //       )}
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );

// // // // // // // // // // //   return (
// // // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // // //       <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>

// // // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // // //         {[
// // // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // // //         ].map((tab) => (
// // // // // // // // // // //           <button
// // // // // // // // // // //             key={tab.key}
// // // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               ...tabButton,
// // // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             {tab.label}
// // // // // // // // // // //           </button>
// // // // // // // // // // //         ))}
// // // // // // // // // // //       </div>

// // // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // // // //       </div>
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );
// // // // // // // // // // // }

// // // // // // // // // // // /* üé® Styles */
// // // // // // // // // // // const mainContainer = { padding: "40px", background: "#fff8dc", minHeight: "100vh" };
// // // // // // // // // // // const title = { color: "#b8860b", textAlign: "center" };
// // // // // // // // // // // const tabContainer = { display: "flex", justifyContent: "center", gap: "10px", flexWrap: "wrap", marginBottom: "20px" };
// // // // // // // // // // // const tabButton = { padding: "8px 16px", borderRadius: "8px", border: "2px solid #d4af37", cursor: "pointer" };
// // // // // // // // // // // const contentCard = { background: "#fff", padding: "20px", borderRadius: "12px", boxShadow: "0 2px 10px rgba(0,0,0,0.1)" };
// // // // // // // // // // // const sectionTitle = { color: "#b8860b", marginBottom: "10px" };
// // // // // // // // // // // const gridBox = { display: "flex", flexWrap: "wrap", gap: "10px" };
// // // // // // // // // // // const miniCard = { border: "1px solid #eee", padding: "10px", borderRadius: "8px", width: "150px", textAlign: "center" };
// // // // // // // // // // // const formBox = { display: "flex", flexWrap: "wrap", gap: "8px", marginBottom: "15px" };
// // // // // // // // // // // const inputStyle = { padding: "8px", borderRadius: "5px", border: "1px solid #ccc" };
// // // // // // // // // // // const addButton = { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: "5px", cursor: "pointer" };
// // // // // // // // // // // const tableStyle = { width: "100%", borderCollapse: "collapse" };
// // // // // // // // // // // const emptyText = { color: "#999" };
// // // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // // import api from "../services/api";
// // // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // // export default function AdminPanel() {
// // // // // // // // // //   const [activeTab, setActiveTab] = useState("menu");
// // // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // // //   // ‚úÖ Fetch all data on load
// // // // // // // // // //   useEffect(() => {
// // // // // // // // // //     const fetchData = async () => {
// // // // // // // // // //       try {
// // // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.allSettled([
// // // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // // //         ]);

// // // // // // // // // //         if (catRes.value) setCategories(catRes.value.data.categories || []);
// // // // // // // // // //         if (tableRes.value) setTables(tableRes.value.data.tables || tableRes.value.data || []);
// // // // // // // // // //         if (orderRes.value) setOrders(orderRes.value.data.orders || []);
// // // // // // // // // //         if (staffRes.value) setStaff(staffRes.value.data.staff || staffRes.value.data || []);
// // // // // // // // // //         if (menuRes.value) setItems(menuRes.value.data.items || []);
// // // // // // // // // //       } catch (err) {
// // // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // // //       } finally {
// // // // // // // // // //         setLoading(false);
// // // // // // // // // //       }
// // // // // // // // // //     };
// // // // // // // // // //     fetchData();
// // // // // // // // // //   }, [token]);

// // // // // // // // // //   // ‚úÖ Image upload via multer
// // // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // // //     const formData = new FormData();
// // // // // // // // // //     formData.append("image", file);
// // // // // // // // // //     setUploading(true);
// // // // // // // // // //     try {
// // // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // // //       });
// // // // // // // // // //       setUploading(false);
// // // // // // // // // //       return res.data.imageUrl;
// // // // // // // // // //     } catch (err) {
// // // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // // //       setUploading(false);
// // // // // // // // // //       return null;
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   // ‚úÖ Add Menu Item
// // // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // // //     try {
// // // // // // // // // //       let imageUrl = "";
// // // // // // // // // //       if (newItem.image) {
// // // // // // // // // //         imageUrl = await handleUpload(newItem.image);
// // // // // // // // // //       }

// // // // // // // // // //       const payload = {
// // // // // // // // // //         name: newItem.name,
// // // // // // // // // //         price: newItem.price,
// // // // // // // // // //         categoryId: newItem.categoryId,
// // // // // // // // // //         image: imageUrl,
// // // // // // // // // //       };

// // // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // //       });

// // // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // // //     } catch (err) {
// // // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   // ‚úÖ Add Category
// // // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // // //     try {
// // // // // // // // // //       let imageUrl = "";
// // // // // // // // // //       if (newCategory.image) {
// // // // // // // // // //         imageUrl = await handleUpload(newCategory.image);
// // // // // // // // // //       }

// // // // // // // // // //       const payload = {
// // // // // // // // // //         name: newCategory.name,
// // // // // // // // // //         image: imageUrl,
// // // // // // // // // //       };

// // // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // // //       });

// // // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // // //     } catch (err) {
// // // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   // ‚úÖ Delete Staff
// // // // // // // // // //   const handleDeleteStaff = async (id) => {
// // // // // // // // // //     if (!window.confirm("Are you sure you want to delete this staff member?")) return;
// // // // // // // // // //     try {
// // // // // // // // // //       await api.delete(`/auth/staff/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// // // // // // // // // //       setStaff(staff.filter((s) => s._id !== id));
// // // // // // // // // //       alert("üóëÔ∏è Staff deleted successfully");
// // // // // // // // // //     } catch (err) {
// // // // // // // // // //       console.error("‚ùå Error deleting staff:", err);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   // ‚úÖ Delete Table
// // // // // // // // // //   const handleDeleteTable = async (id) => {
// // // // // // // // // //     if (!window.confirm("Are you sure you want to delete this table?")) return;
// // // // // // // // // //     try {
// // // // // // // // // //       await api.delete(`/tables/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// // // // // // // // // //       setTables(tables.filter((t) => t._id !== id));
// // // // // // // // // //       alert("üóëÔ∏è Table deleted successfully");
// // // // // // // // // //     } catch (err) {
// // // // // // // // // //       console.error("‚ùå Error deleting table:", err);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   if (loading) {
// // // // // // // // // //     return <div style={{ textAlign: "center", marginTop: "50px" }}>Loading Admin Panel...</div>;
// // // // // // // // // //   }

// // // // // // // // // //   // ‚úÖ Render Orders
// // // // // // // // // //   const renderOrders = () => (
// // // // // // // // // //     <div>
// // // // // // // // // //       <h2 style={sectionTitle}>üßæ Orders</h2>
// // // // // // // // // //       {orders.length === 0 ? (
// // // // // // // // // //         <p style={emptyText}>No orders yet.</p>
// // // // // // // // // //       ) : (
// // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // //           {orders.map((o) => (
// // // // // // // // // //             <div key={o._id} style={miniCard}>
// // // // // // // // // //               <p><b>Table:</b> {o.tableSlug}</p>
// // // // // // // // // //               <p><b>Total:</b> ‚Çπ{o.total || "N/A"}</p>
// // // // // // // // // //               <p><b>Status:</b> {o.status}</p>
// // // // // // // // // //               <ul>
// // // // // // // // // //                 {o.items.map((it, idx) => (
// // // // // // // // // //                   <li key={idx}>{it.name} √ó {it.quantity}</li>
// // // // // // // // // //                 ))}
// // // // // // // // // //               </ul>
// // // // // // // // // //             </div>
// // // // // // // // // //           ))}
// // // // // // // // // //         </div>
// // // // // // // // // //       )}
// // // // // // // // // //     </div>
// // // // // // // // // //   );

// // // // // // // // // //   // ‚úÖ Render Staff
// // // // // // // // // //   const renderStaff = () => (
// // // // // // // // // //     <div>
// // // // // // // // // //       <h2 style={sectionTitle}>üë©‚Äçüç≥ Staff Members</h2>
// // // // // // // // // //       {staff.length === 0 ? (
// // // // // // // // // //         <p style={emptyText}>No staff found.</p>
// // // // // // // // // //       ) : (
// // // // // // // // // //         <table style={tableStyle}>
// // // // // // // // // //           <thead>
// // // // // // // // // //             <tr>
// // // // // // // // // //               <th>Name</th>
// // // // // // // // // //               <th>Email</th>
// // // // // // // // // //               <th>Role</th>
// // // // // // // // // //               <th>Phone</th>
// // // // // // // // // //               <th>Actions</th>
// // // // // // // // // //             </tr>
// // // // // // // // // //           </thead>
// // // // // // // // // //           <tbody>
// // // // // // // // // //             {staff.map((s) => (
// // // // // // // // // //               <tr key={s._id}>
// // // // // // // // // //                 <td>{s.name}</td>
// // // // // // // // // //                 <td>{s.email}</td>
// // // // // // // // // //                 <td>{s.role}</td>
// // // // // // // // // //                 <td>{s.phone}</td>
// // // // // // // // // //                 <td>
// // // // // // // // // //                   <button onClick={() => handleDeleteStaff(s._id)} style={deleteBtn}>üóëÔ∏è</button>
// // // // // // // // // //                 </td>
// // // // // // // // // //               </tr>
// // // // // // // // // //             ))}
// // // // // // // // // //           </tbody>
// // // // // // // // // //         </table>
// // // // // // // // // //       )}
// // // // // // // // // //     </div>
// // // // // // // // // //   );

// // // // // // // // // //   // ‚úÖ Render Tables
// // // // // // // // // //   const renderTables = () => (
// // // // // // // // // //     <div>
// // // // // // // // // //       <h2 style={sectionTitle}>ü™ë Tables & QR Codes</h2>
// // // // // // // // // //       {tables.length === 0 ? (
// // // // // // // // // //         <p style={emptyText}>No tables available.</p>
// // // // // // // // // //       ) : (
// // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // //           {tables.map((t) => (
// // // // // // // // // //             <div key={t._id} style={miniCard}>
// // // // // // // // // //               <h4>Table {t.number}</h4>
// // // // // // // // // //               <QRCodeCanvas value={`http://localhost:5173/menu/${t.qrSlug}`} size={80} />
// // // // // // // // // //               <p>Slug: {t.qrSlug}</p>
// // // // // // // // // //               <button onClick={() => handleDeleteTable(t._id)} style={deleteBtnSmall}>üóëÔ∏è</button>
// // // // // // // // // //             </div>
// // // // // // // // // //           ))}
// // // // // // // // // //         </div>
// // // // // // // // // //       )}
// // // // // // // // // //     </div>
// // // // // // // // // //   );

// // // // // // // // // //   // ‚úÖ Render Menu Items & Categories
// // // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // // //     <div>
// // // // // // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // // // // // //       <div style={formBox}>
// // // // // // // // // //         <input
// // // // // // // // // //           type="text"
// // // // // // // // // //           placeholder="Item Name"
// // // // // // // // // //           value={newItem.name}
// // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         />
// // // // // // // // // //         <input
// // // // // // // // // //           type="number"
// // // // // // // // // //           placeholder="Price"
// // // // // // // // // //           value={newItem.price}
// // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         />
// // // // // // // // // //         <select
// // // // // // // // // //           value={newItem.categoryId}
// // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         >
// // // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // //             <option key={c._id} value={c._id}>{c.name}</option>
// // // // // // // // // //           ))}
// // // // // // // // // //         </select>
// // // // // // // // // //         <input
// // // // // // // // // //           type="file"
// // // // // // // // // //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         />
// // // // // // // // // //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// // // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // // //         </button>
// // // // // // // // // //       </div>

// // // // // // // // // //       {items.length === 0 ? (
// // // // // // // // // //         <p style={emptyText}>No menu items yet.</p>
// // // // // // // // // //       ) : (
// // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // //           {items.map((i) => (
// // // // // // // // // //             <div key={i._id} style={miniCard}>
// // // // // // // // // //               {i.image && <img src={i.image} alt={i.name} width={80} />}
// // // // // // // // // //               <p>{i.name}</p>
// // // // // // // // // //               <p>‚Çπ{i.price}</p>
// // // // // // // // // //             </div>
// // // // // // // // // //           ))}
// // // // // // // // // //         </div>
// // // // // // // // // //       )}
// // // // // // // // // //     </div>
// // // // // // // // // //   );

// // // // // // // // // //   const renderCategories = () => (
// // // // // // // // // //     <div>
// // // // // // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // // //       <div style={formBox}>
// // // // // // // // // //         <input
// // // // // // // // // //           type="text"
// // // // // // // // // //           placeholder="Category Name"
// // // // // // // // // //           value={newCategory.name}
// // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         />
// // // // // // // // // //         <input
// // // // // // // // // //           type="file"
// // // // // // // // // //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// // // // // // // // // //           style={inputStyle}
// // // // // // // // // //         />
// // // // // // // // // //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// // // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // // //         </button>
// // // // // // // // // //       </div>

// // // // // // // // // //       {categories.length === 0 ? (
// // // // // // // // // //         <p style={emptyText}>No categories yet.</p>
// // // // // // // // // //       ) : (
// // // // // // // // // //         <div style={gridBox}>
// // // // // // // // // //           {categories.map((c) => (
// // // // // // // // // //             <div key={c._id} style={miniCard}>
// // // // // // // // // //               {c.image && <img src={c.image} alt={c.name} width={80} />}
// // // // // // // // // //               <p>{c.name}</p>
// // // // // // // // // //             </div>
// // // // // // // // // //           ))}
// // // // // // // // // //         </div>
// // // // // // // // // //       )}
// // // // // // // // // //     </div>
// // // // // // // // // //   );

// // // // // // // // // //   return (
// // // // // // // // // //     <div style={mainContainer}>
// // // // // // // // // //       <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>

// // // // // // // // // //       <div style={tabContainer}>
// // // // // // // // // //         {[
// // // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // // //         ].map((tab) => (
// // // // // // // // // //           <button
// // // // // // // // // //             key={tab.key}
// // // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // // //             style={{
// // // // // // // // // //               ...tabButton,
// // // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // // //             }}
// // // // // // // // // //           >
// // // // // // // // // //             {tab.label}
// // // // // // // // // //           </button>
// // // // // // // // // //         ))}
// // // // // // // // // //       </div>

// // // // // // // // // //       <div style={contentCard}>
// // // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // // //       </div>
// // // // // // // // // //     </div>
// // // // // // // // // //   );
// // // // // // // // // // }

// // // // // // // // // // /* üé® Styles */
// // // // // // // // // // const mainContainer = { padding: "40px", background: "#fff8dc", minHeight: "100vh" };
// // // // // // // // // // const title = { color: "#b8860b", textAlign: "center" };
// // // // // // // // // // const tabContainer = { display: "flex", justifyContent: "center", gap: "10px", flexWrap: "wrap", marginBottom: "20px" };
// // // // // // // // // // const tabButton = { padding: "8px 16px", borderRadius: "8px", border: "2px solid #d4af37", cursor: "pointer" };
// // // // // // // // // // const contentCard = { background: "#fff", padding: "20px", borderRadius: "12px", boxShadow: "0 2px 10px rgba(0,0,0,0.1)" };
// // // // // // // // // // const sectionTitle = { color: "#b8860b", marginBottom: "10px" };
// // // // // // // // // // const gridBox = { display: "flex", flexWrap: "wrap", gap: "10px" };
// // // // // // // // // // const miniCard = { border: "1px solid #eee", padding: "10px", borderRadius: "8px", width: "160px", textAlign: "center" };
// // // // // // // // // // const formBox = { display: "flex", flexWrap: "wrap", gap: "8px", marginBottom: "15px" };
// // // // // // // // // // const inputStyle = { padding: "8px", borderRadius: "5px", border: "1px solid #ccc" };
// // // // // // // // // // const addButton = { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: "5px", cursor: "pointer" };
// // // // // // // // // // const tableStyle = { width: "100%", borderCollapse: "collapse" };
// // // // // // // // // // const emptyText = { color: "#999" };
// // // // // // // // // // const deleteBtn = { background: "red", color: "white", border: "none", padding: "4px 8px", borderRadius: "5px", cursor: "pointer" };
// // // // // // // // // // const deleteBtnSmall = { ...deleteBtn, padding: "2px 6px", marginTop: "5px" };
// // // // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // // // import api from "../services/api";
// // // // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // // // export default function AdminPanel() {
// // // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // // //   const [items, setItems] = useState([]);
// // // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // // //   const token = localStorage.getItem("token");

// // // // // // // // //   // ‚úÖ Fetch data on load
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     const fetchData = async () => {
// // // // // // // // //       try {
// // // // // // // // //         const headers = { Authorization: `Bearer ${token}` };
// // // // // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.allSettled([
// // // // // // // // //           api.get("/menu/categories", { headers }),
// // // // // // // // //           api.get("/tables", { headers }),
// // // // // // // // //           api.get("/orders", { headers }),
// // // // // // // // //           api.get("/auth/staff", { headers }),
// // // // // // // // //           api.get("/menu/items", { headers }),
// // // // // // // // //         ]);

// // // // // // // // //         if (catRes.value) setCategories(catRes.value.data.categories || []);
// // // // // // // // //         if (tableRes.value) setTables(tableRes.value.data.tables || tableRes.value.data || []);
// // // // // // // // //         if (orderRes.value) setOrders(orderRes.value.data.orders || []);
// // // // // // // // //         if (staffRes.value) setStaff(staffRes.value.data.staff || staffRes.value.data || []);
// // // // // // // // //         if (menuRes.value) setItems(menuRes.value.data.items || []);
// // // // // // // // //       } catch (err) {
// // // // // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // // // // //       } finally {
// // // // // // // // //         setLoading(false);
// // // // // // // // //       }
// // // // // // // // //     };
// // // // // // // // //     fetchData();
// // // // // // // // //   }, [token]);

// // // // // // // // //   // ‚úÖ Image upload
// // // // // // // // //   const handleUpload = async (file) => {
// // // // // // // // //     const formData = new FormData();
// // // // // // // // //     formData.append("image", file);
// // // // // // // // //     setUploading(true);
// // // // // // // // //     try {
// // // // // // // // //       const res = await api.post("/upload", formData, {
// // // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // // //       });
// // // // // // // // //       setUploading(false);
// // // // // // // // //       return res.data.imageUrl;
// // // // // // // // //     } catch (err) {
// // // // // // // // //       console.error("‚ùå Upload failed:", err);
// // // // // // // // //       setUploading(false);
// // // // // // // // //       return null;
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   // ‚úÖ Add Menu Item
// // // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // // //     try {
// // // // // // // // //       let imageUrl = "";
// // // // // // // // //       if (newItem.image) imageUrl = await handleUpload(newItem.image);
// // // // // // // // //       const payload = { ...newItem, image: imageUrl };

// // // // // // // // //       const res = await api.post("/menu/items", payload, {
// // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // //       });

// // // // // // // // //       setItems([...items, res.data.item]);
// // // // // // // // //       alert("‚úÖ Menu item added!");
// // // // // // // // //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // // //     } catch (err) {
// // // // // // // // //       console.error("‚ùå Error adding menu item:", err);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   // ‚úÖ Add Category
// // // // // // // // //   const handleAddCategory = async () => {
// // // // // // // // //     try {
// // // // // // // // //       let imageUrl = "";
// // // // // // // // //       if (newCategory.image) imageUrl = await handleUpload(newCategory.image);
// // // // // // // // //       const payload = { ...newCategory, image: imageUrl };

// // // // // // // // //       const res = await api.post("/menu/categories", payload, {
// // // // // // // // //         headers: { Authorization: `Bearer ${token}` },
// // // // // // // // //       });

// // // // // // // // //       setCategories([...categories, res.data.category]);
// // // // // // // // //       alert("‚úÖ Category added!");
// // // // // // // // //       setNewCategory({ name: "", image: null });
// // // // // // // // //     } catch (err) {
// // // // // // // // //       console.error("‚ùå Error adding category:", err);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   // ‚úÖ Delete Staff
// // // // // // // // //   const handleDeleteStaff = async (id) => {
// // // // // // // // //     if (!window.confirm("Are you sure you want to delete this staff member?")) return;
// // // // // // // // //     try {
// // // // // // // // //       await api.delete(`/auth/staff/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// // // // // // // // //       setStaff(staff.filter((s) => s._id !== id));
// // // // // // // // //       alert("üóëÔ∏è Staff deleted successfully");
// // // // // // // // //     } catch (err) {
// // // // // // // // //       console.error("‚ùå Error deleting staff:", err);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   // ‚úÖ Delete Table
// // // // // // // // //   const handleDeleteTable = async (id) => {
// // // // // // // // //     if (!window.confirm("Are you sure you want to delete this table?")) return;
// // // // // // // // //     try {
// // // // // // // // //       await api.delete(`/tables/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// // // // // // // // //       setTables(tables.filter((t) => t._id !== id));
// // // // // // // // //       alert("üóëÔ∏è Table deleted successfully");
// // // // // // // // //     } catch (err) {
// // // // // // // // //       console.error("‚ùå Error deleting table:", err);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   if (loading) return <div style={styles.loading}>Loading Admin Panel...</div>;

// // // // // // // // //   // ‚úÖ Render Sections
// // // // // // // // //   const renderOrders = () => (
// // // // // // // // //     <div>
// // // // // // // // //       <h2 style={styles.sectionTitle}>üßæ Orders</h2>
// // // // // // // // //       {orders.length === 0 ? (
// // // // // // // // //         <p style={styles.empty}>No orders yet.</p>
// // // // // // // // //       ) : (
// // // // // // // // //         <div style={styles.grid}>
// // // // // // // // //           {orders.map((o) => (
// // // // // // // // //             <div key={o._id} style={styles.orderCard}>
// // // // // // // // //               <p><b>Table:</b> {o.tableSlug}</p>
// // // // // // // // //               <p><b>Total:</b> ‚Çπ{o.total || "N/A"}</p>
// // // // // // // // //               <p><b>Status:</b> {o.status}</p>
// // // // // // // // //               <ul style={{ paddingLeft: "20px" }}>
// // // // // // // // //                 {o.items.map((it, idx) => (
// // // // // // // // //                   <li key={idx}>{it.name} √ó {it.quantity}</li>
// // // // // // // // //                 ))}
// // // // // // // // //               </ul>
// // // // // // // // //             </div>
// // // // // // // // //           ))}
// // // // // // // // //         </div>
// // // // // // // // //       )}
// // // // // // // // //     </div>
// // // // // // // // //   );

// // // // // // // // //   const renderStaff = () => (
// // // // // // // // //     <div>
// // // // // // // // //       <h2 style={styles.sectionTitle}>üë©‚Äçüç≥ Staff Members</h2>
// // // // // // // // //       {staff.length === 0 ? (
// // // // // // // // //         <p style={styles.empty}>No staff found.</p>
// // // // // // // // //       ) : (
// // // // // // // // //         <table style={styles.table}>
// // // // // // // // //           <thead>
// // // // // // // // //             <tr>
// // // // // // // // //               <th style={styles.th}>Name</th>
// // // // // // // // //               <th style={styles.th}>Email</th>
// // // // // // // // //               <th style={styles.th}>Role</th>
// // // // // // // // //               <th style={styles.th}>Phone</th>
// // // // // // // // //               <th style={styles.th}>Actions</th>
// // // // // // // // //             </tr>
// // // // // // // // //           </thead>
// // // // // // // // //           <tbody>
// // // // // // // // //             {staff.map((s) => (
// // // // // // // // //               <tr key={s._id}>
// // // // // // // // //                 <td style={styles.td}>{s.name}</td>
// // // // // // // // //                 <td style={styles.td}>{s.email}</td>
// // // // // // // // //                 <td style={styles.td}>{s.role}</td>
// // // // // // // // //                 <td style={styles.td}>{s.phone}</td>
// // // // // // // // //                 <td style={styles.td}>
// // // // // // // // //                   <button onClick={() => handleDeleteStaff(s._id)} style={styles.deleteBtn}>üóëÔ∏è</button>
// // // // // // // // //                 </td>
// // // // // // // // //               </tr>
// // // // // // // // //             ))}
// // // // // // // // //           </tbody>
// // // // // // // // //         </table>
// // // // // // // // //       )}
// // // // // // // // //     </div>
// // // // // // // // //   );

// // // // // // // // //   const renderTables = () => (
// // // // // // // // //     <div>
// // // // // // // // //       <h2 style={styles.sectionTitle}>ü™ë Tables & QR Codes</h2>
// // // // // // // // //       {tables.length === 0 ? (
// // // // // // // // //         <p style={styles.empty}>No tables available.</p>
// // // // // // // // //       ) : (
// // // // // // // // //         <div style={styles.grid}>
// // // // // // // // //           {tables.map((t) => (
// // // // // // // // //             <div key={t._id} style={styles.tableCard}>
// // // // // // // // //               <h4>Table {t.number}</h4>
// // // // // // // // //               <QRCodeCanvas value={`http://localhost:5173/menu/${t.qrSlug}`} size={80} />
// // // // // // // // //               <p>Slug: {t.qrSlug}</p>
// // // // // // // // //               <button onClick={() => handleDeleteTable(t._id)} style={styles.deleteBtnSmall}>üóëÔ∏è</button>
// // // // // // // // //             </div>
// // // // // // // // //           ))}
// // // // // // // // //         </div>
// // // // // // // // //       )}
// // // // // // // // //     </div>
// // // // // // // // //   );

// // // // // // // // //   const renderMenuItems = () => (
// // // // // // // // //     <div>
// // // // // // // // //       <h2 style={styles.sectionTitle}>üçî Menu Items</h2>
// // // // // // // // //       <div style={styles.formBox}>
// // // // // // // // //         <input type="text" placeholder="Item Name" value={newItem.name} onChange={(e) => setNewItem({ ...newItem, name: e.target.value })} style={styles.input} />
// // // // // // // // //         <input type="number" placeholder="Price" value={newItem.price} onChange={(e) => setNewItem({ ...newItem, price: e.target.value })} style={styles.input} />
// // // // // // // // //         <select value={newItem.categoryId} onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })} style={styles.input}>
// // // // // // // // //           <option value="">Select Category</option>
// // // // // // // // //           {categories.map((c) => <option key={c._id} value={c._id}>{c.name}</option>)}
// // // // // // // // //         </select>
// // // // // // // // //         <input type="file" onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })} style={styles.input} />
// // // // // // // // //         <button onClick={handleAddMenuItem} style={styles.addBtn} disabled={uploading}>
// // // // // // // // //           {uploading ? "Uploading..." : "Add Item"}
// // // // // // // // //         </button>
// // // // // // // // //       </div>
// // // // // // // // //       <div style={styles.grid}>
// // // // // // // // //         {items.map((i) => (
// // // // // // // // //           <div key={i._id} style={styles.menuCard}>
// // // // // // // // //             {i.image && <img src={i.image} alt={i.name} width={80} style={{ borderRadius: "8px" }} />}
// // // // // // // // //             <p><b>{i.name}</b></p>
// // // // // // // // //             <p>‚Çπ{i.price}</p>
// // // // // // // // //           </div>
// // // // // // // // //         ))}
// // // // // // // // //       </div>
// // // // // // // // //     </div>
// // // // // // // // //   );

// // // // // // // // //   const renderCategories = () => (
// // // // // // // // //     <div>
// // // // // // // // //       <h2 style={styles.sectionTitle}>üìã Menu Categories</h2>
// // // // // // // // //       <div style={styles.formBox}>
// // // // // // // // //         <input type="text" placeholder="Category Name" value={newCategory.name} onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })} style={styles.input} />
// // // // // // // // //         <input type="file" onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })} style={styles.input} />
// // // // // // // // //         <button onClick={handleAddCategory} style={styles.addBtn} disabled={uploading}>
// // // // // // // // //           {uploading ? "Uploading..." : "Add Category"}
// // // // // // // // //         </button>
// // // // // // // // //       </div>
// // // // // // // // //       <div style={styles.grid}>
// // // // // // // // //         {categories.map((c) => (
// // // // // // // // //           <div key={c._id} style={styles.menuCard}>
// // // // // // // // //             {c.image && <img src={c.image} alt={c.name} width={80} style={{ borderRadius: "8px" }} />}
// // // // // // // // //             <p><b>{c.name}</b></p>
// // // // // // // // //           </div>
// // // // // // // // //         ))}
// // // // // // // // //       </div>
// // // // // // // // //     </div>
// // // // // // // // //   );

// // // // // // // // //   return (
// // // // // // // // //     <div style={styles.container}>
// // // // // // // // //       <h1 style={styles.title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // // //       <div style={styles.tabs}>
// // // // // // // // //         {[
// // // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // // //         ].map((tab) => (
// // // // // // // // //           <button
// // // // // // // // //             key={tab.key}
// // // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // // //             style={{
// // // // // // // // //               ...styles.tabBtn,
// // // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff",
// // // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // // //             }}
// // // // // // // // //           >
// // // // // // // // //             {tab.label}
// // // // // // // // //           </button>
// // // // // // // // //         ))}
// // // // // // // // //       </div>
// // // // // // // // //       <div style={styles.content}>
// // // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // // //       </div>
// // // // // // // // //     </div>
// // // // // // // // //   );
// // // // // // // // // }

// // // // // // // // // /* üé® Inline Styles */
// // // // // // // // // const styles = {
// // // // // // // // //   container: { background: "#fff8dc", padding: "40px", minHeight: "100vh" },
// // // // // // // // //   title: { textAlign: "center", color: "#b8860b", marginBottom: "30px" },
// // // // // // // // //   tabs: { display: "flex", justifyContent: "center", gap: "10px", marginBottom: "20px", flexWrap: "wrap" },
// // // // // // // // //   tabBtn: { border: "2px solid #d4af37", borderRadius: "8px", padding: "10px 20px", cursor: "pointer", fontWeight: "bold" },
// // // // // // // // //   content: { background: "white", padding: "20px", borderRadius: "12px", boxShadow: "0 4px 15px rgba(0,0,0,0.1)" },
// // // // // // // // //   sectionTitle: { color: "#b8860b", borderBottom: "2px solid #d4af37", paddingBottom: "5px", marginBottom: "15px" },
// // // // // // // // //   grid: { display: "flex", flexWrap: "wrap", gap: "15px" },
// // // // // // // // //   menuCard: { border: "1px solid #d4af37", borderRadius: "10px", padding: "10px", width: "150px", textAlign: "center", background: "#fffaf0" },
// // // // // // // // //   tableCard: { border: "1px solid #d4af37", borderRadius: "10px", padding: "10px", width: "170px", textAlign: "center", background: "#fffaf0" },
// // // // // // // // //   orderCard: { border: "1px solid #d4af37", borderRadius: "10px", padding: "15px", width: "220px", background: "#fffaf0" },
// // // // // // // // //   formBox: { display: "flex", flexWrap: "wrap", gap: "8px", marginBottom: "15px" },
// // // // // // // // //   input: { padding: "8px", border: "1px solid #ccc", borderRadius: "5px" },
// // // // // // // // //   addBtn: { background: "#d4af37", color: "#fff", border: "none", borderRadius: "5px", padding: "8px 15px", cursor: "pointer" },
// // // // // // // // //   table: { width: "100%", borderCollapse: "collapse", background: "#fffaf0" },
// // // // // // // // //   th: { border: "1px solid #d4af37", padding: "8px", background: "#fef4cc", color: "#b8860b" },
// // // // // // // // //   td: { border: "1px solid #d4af37", padding: "8px", textAlign: "center" },
// // // // // // // // //   deleteBtn: { background: "red", color: "white", border: "none", padding: "5px 10px", borderRadius: "5px", cursor: "pointer" },
// // // // // // // // //   deleteBtnSmall: { background: "red", color: "white", border: "none", padding: "3px 8px", borderRadius: "5px", cursor: "pointer", marginTop: "5px" },
// // // // // // // // //   empty: { textAlign: "center", color: "#777" },
// // // // // // // // //   loading: { textAlign: "center", marginTop: "100px", color: "#b8860b" },
// // // // // // // // // };
// // // // // // // // import React, { useState, useEffect } from "react";
// // // // // // // // import axios from "axios";

// // // // // // // // export default function AdminPanel() {
// // // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // //   const [menuItems, setMenuItems] = useState([]);
// // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // //   const [tables, setTables] = useState([]);
// // // // // // // //   const [staff, setStaff] = useState([]);

// // // // // // // //   const [newStaff, setNewStaff] = useState({
// // // // // // // //     name: "",
// // // // // // // //     role: "",
// // // // // // // //     phone: "",
// // // // // // // //     email: "",
// // // // // // // //     active: true,
// // // // // // // //   });

// // // // // // // //   const api = "http://localhost:4000/api";

// // // // // // // //   useEffect(() => {
// // // // // // // //     fetchOrders();
// // // // // // // //     fetchMenu();
// // // // // // // //     fetchCategories();
// // // // // // // //     fetchTables();
// // // // // // // //     fetchStaff();
// // // // // // // //   }, []);

// // // // // // // //   const fetchOrders = async () => {
// // // // // // // //     const res = await axios.get(`${api}/orders`);
// // // // // // // //     setOrders(res.data || []);
// // // // // // // //   };

// // // // // // // //   const fetchMenu = async () => {
// // // // // // // //     const res = await axios.get(`${api}/menu`);
// // // // // // // //     setMenuItems(res.data.items || []);
// // // // // // // //   };

// // // // // // // //   const fetchCategories = async () => {
// // // // // // // //     const res = await axios.get(`${api}/menu/categories`);
// // // // // // // //     setCategories(res.data.categories || []);
// // // // // // // //   };

// // // // // // // //   const fetchTables = async () => {
// // // // // // // //     const res = await axios.get(`${api}/tables`);
// // // // // // // //     setTables(res.data || []);
// // // // // // // //   };

// // // // // // // //   const fetchStaff = async () => {
// // // // // // // //     const res = await axios.get(`${api}/staff`);
// // // // // // // //     setStaff(res.data || []);
// // // // // // // //   };

// // // // // // // //   // ‚úÖ Add new staff
// // // // // // // //   const handleAddStaff = async (e) => {
// // // // // // // //     e.preventDefault();
// // // // // // // //     try {
// // // // // // // //       await axios.post(`${api}/staff`, newStaff);
// // // // // // // //       setNewStaff({ name: "", role: "", phone: "", email: "", active: true });
// // // // // // // //       fetchStaff();
// // // // // // // //       alert("‚úÖ Staff added successfully!");
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("Error adding staff:", err);
// // // // // // // //       alert("‚ùå Failed to add staff");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   // ‚úÖ Delete staff
// // // // // // // //   const handleDeleteStaff = async (id) => {
// // // // // // // //     if (!window.confirm("Are you sure you want to delete this staff member?")) return;
// // // // // // // //     try {
// // // // // // // //       await axios.delete(`${api}/staff/${id}`);
// // // // // // // //       fetchStaff();
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("Error deleting staff:", err);
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   // ‚úÖ Delete menu item
// // // // // // // //   const handleDeleteMenu = async (id) => {
// // // // // // // //     if (!window.confirm("Are you sure you want to delete this menu item?")) return;
// // // // // // // //     try {
// // // // // // // //       await axios.delete(`${api}/menu/${id}`);
// // // // // // // //       fetchMenu();
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("Error deleting menu item:", err);
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   // ---------------------- UI Styling ---------------------
// // // // // // // //   const mainContainer = {
// // // // // // // //     padding: "40px",
// // // // // // // //     backgroundColor: "#fffaf0",
// // // // // // // //     color: "#4b3e02",
// // // // // // // //     fontFamily: "Poppins, sans-serif",
// // // // // // // //   };

// // // // // // // //   const title = {
// // // // // // // //     fontSize: "32px",
// // // // // // // //     fontWeight: "700",
// // // // // // // //     color: "#b8860b",
// // // // // // // //   };

// // // // // // // //   const tabContainer = {
// // // // // // // //     display: "flex",
// // // // // // // //     justifyContent: "center",
// // // // // // // //     gap: "10px",
// // // // // // // //     marginBottom: "25px",
// // // // // // // //   };

// // // // // // // //   const tabButton = {
// // // // // // // //     padding: "10px 20px",
// // // // // // // //     border: "1px solid #d4af37",
// // // // // // // //     borderRadius: "20px",
// // // // // // // //     cursor: "pointer",
// // // // // // // //     backgroundColor: "#fff",
// // // // // // // //     color: "#b8860b",
// // // // // // // //     fontWeight: "600",
// // // // // // // //     transition: "0.3s",
// // // // // // // //   };

// // // // // // // //   const contentCard = {
// // // // // // // //     backgroundColor: "#fff",
// // // // // // // //     borderRadius: "20px",
// // // // // // // //     boxShadow: "0 4px 15px rgba(0,0,0,0.1)",
// // // // // // // //     padding: "25px",
// // // // // // // //   };

// // // // // // // //   const tableStyle = {
// // // // // // // //     width: "100%",
// // // // // // // //     borderCollapse: "collapse",
// // // // // // // //     marginTop: "20px",
// // // // // // // //   };

// // // // // // // //   const thtd = {
// // // // // // // //     border: "1px solid #f0e68c",
// // // // // // // //     padding: "10px",
// // // // // // // //     textAlign: "center",
// // // // // // // //   };

// // // // // // // //   // ---------------------- Tabs Content ---------------------

// // // // // // // //   const renderOrders = () => (
// // // // // // // //     <div>
// // // // // // // //       <h2 style={{ color: "#b8860b" }}>üì¶ Orders</h2>
// // // // // // // //       <table style={tableStyle}>
// // // // // // // //         <thead>
// // // // // // // //           <tr>
// // // // // // // //             <th style={thtd}>Table</th>
// // // // // // // //             <th style={thtd}>Items</th>
// // // // // // // //             <th style={thtd}>Total</th>
// // // // // // // //             <th style={thtd}>Status</th>
// // // // // // // //           </tr>
// // // // // // // //         </thead>
// // // // // // // //         <tbody>
// // // // // // // //           {orders.map((o) => (
// // // // // // // //             <tr key={o._id}>
// // // // // // // //               <td style={thtd}>{o.tableSlug}</td>
// // // // // // // //               <td style={thtd}>
// // // // // // // //                 {o.items?.map((i) => `${i.name} x${i.quantity}`).join(", ")}
// // // // // // // //               </td>
// // // // // // // //               <td style={thtd}>‚Çπ{o.total}</td>
// // // // // // // //               <td style={thtd}>{o.status}</td>
// // // // // // // //             </tr>
// // // // // // // //           ))}
// // // // // // // //         </tbody>
// // // // // // // //       </table>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const renderMenuItems = () => (
// // // // // // // //     <div>
// // // // // // // //       <h2 style={{ color: "#b8860b" }}>üçΩÔ∏è Menu Items</h2>
// // // // // // // //       <table style={tableStyle}>
// // // // // // // //         <thead>
// // // // // // // //           <tr>
// // // // // // // //             <th style={thtd}>Name</th>
// // // // // // // //             <th style={thtd}>Price</th>
// // // // // // // //             <th style={thtd}>Category</th>
// // // // // // // //             <th style={thtd}>Action</th>
// // // // // // // //           </tr>
// // // // // // // //         </thead>
// // // // // // // //         <tbody>
// // // // // // // //           {menuItems.map((item) => (
// // // // // // // //             <tr key={item._id}>
// // // // // // // //               <td style={thtd}>{item.name}</td>
// // // // // // // //               <td style={thtd}>‚Çπ{item.price}</td>
// // // // // // // //               <td style={thtd}>{item.categoryId?.name || "Uncategorized"}</td>
// // // // // // // //               <td style={thtd}>
// // // // // // // //                 <button
// // // // // // // //                   onClick={() => handleDeleteMenu(item._id)}
// // // // // // // //                   style={{
// // // // // // // //                     backgroundColor: "#b8860b",
// // // // // // // //                     color: "white",
// // // // // // // //                     border: "none",
// // // // // // // //                     borderRadius: "10px",
// // // // // // // //                     padding: "5px 10px",
// // // // // // // //                     cursor: "pointer",
// // // // // // // //                   }}
// // // // // // // //                 >
// // // // // // // //                   ‚ùå Delete
// // // // // // // //                 </button>
// // // // // // // //               </td>
// // // // // // // //             </tr>
// // // // // // // //           ))}
// // // // // // // //         </tbody>
// // // // // // // //       </table>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const renderCategories = () => (
// // // // // // // //     <div>
// // // // // // // //       <h2 style={{ color: "#b8860b" }}>üìÇ Categories</h2>
// // // // // // // //       <ul>
// // // // // // // //         {categories.map((c) => (
// // // // // // // //           <li key={c._id} style={{ marginBottom: "5px" }}>
// // // // // // // //             {c.name}
// // // // // // // //           </li>
// // // // // // // //         ))}
// // // // // // // //       </ul>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const renderTables = () => (
// // // // // // // //     <div>
// // // // // // // //       <h2 style={{ color: "#b8860b" }}>ü™ë Tables</h2>
// // // // // // // //       <table style={tableStyle}>
// // // // // // // //         <thead>
// // // // // // // //           <tr>
// // // // // // // //             <th style={thtd}>Number</th>
// // // // // // // //             <th style={thtd}>QR Slug</th>
// // // // // // // //           </tr>
// // // // // // // //         </thead>
// // // // // // // //         <tbody>
// // // // // // // //           {tables.map((t) => (
// // // // // // // //             <tr key={t._id}>
// // // // // // // //               <td style={thtd}>{t.number}</td>
// // // // // // // //               <td style={thtd}>{t.qrSlug}</td>
// // // // // // // //             </tr>
// // // // // // // //           ))}
// // // // // // // //         </tbody>
// // // // // // // //       </table>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const renderStaff = () => (
// // // // // // // //     <div>
// // // // // // // //       <h2 style={{ color: "#b8860b" }}>üë• Staff Management</h2>

// // // // // // // //       <form onSubmit={handleAddStaff} style={{ marginBottom: "20px" }}>
// // // // // // // //         <input
// // // // // // // //           type="text"
// // // // // // // //           placeholder="Name"
// // // // // // // //           value={newStaff.name}
// // // // // // // //           onChange={(e) => setNewStaff({ ...newStaff, name: e.target.value })}
// // // // // // // //           required
// // // // // // // //           style={{ marginRight: "10px", padding: "8px" }}
// // // // // // // //         />
// // // // // // // //         <input
// // // // // // // //           type="text"
// // // // // // // //           placeholder="Role"
// // // // // // // //           value={newStaff.role}
// // // // // // // //           onChange={(e) => setNewStaff({ ...newStaff, role: e.target.value })}
// // // // // // // //           required
// // // // // // // //           style={{ marginRight: "10px", padding: "8px" }}
// // // // // // // //         />
// // // // // // // //         <input
// // // // // // // //           type="text"
// // // // // // // //           placeholder="Phone"
// // // // // // // //           value={newStaff.phone}
// // // // // // // //           onChange={(e) => setNewStaff({ ...newStaff, phone: e.target.value })}
// // // // // // // //           style={{ marginRight: "10px", padding: "8px" }}
// // // // // // // //         />
// // // // // // // //         <input
// // // // // // // //           type="email"
// // // // // // // //           placeholder="Email"
// // // // // // // //           value={newStaff.email}
// // // // // // // //           onChange={(e) => setNewStaff({ ...newStaff, email: e.target.value })}
// // // // // // // //           style={{ marginRight: "10px", padding: "8px" }}
// // // // // // // //         />
// // // // // // // //         <button
// // // // // // // //           type="submit"
// // // // // // // //           style={{
// // // // // // // //             backgroundColor: "#d4af37",
// // // // // // // //             color: "white",
// // // // // // // //             border: "none",
// // // // // // // //             borderRadius: "10px",
// // // // // // // //             padding: "8px 15px",
// // // // // // // //             cursor: "pointer",
// // // // // // // //           }}
// // // // // // // //         >
// // // // // // // //           ‚ûï Add Staff
// // // // // // // //         </button>
// // // // // // // //       </form>

// // // // // // // //       <table style={tableStyle}>
// // // // // // // //         <thead>
// // // // // // // //           <tr>
// // // // // // // //             <th style={thtd}>Name</th>
// // // // // // // //             <th style={thtd}>Role</th>
// // // // // // // //             <th style={thtd}>Phone</th>
// // // // // // // //             <th style={thtd}>Email</th>
// // // // // // // //             <th style={thtd}>Status</th>
// // // // // // // //             <th style={thtd}>Action</th>
// // // // // // // //           </tr>
// // // // // // // //         </thead>
// // // // // // // //         <tbody>
// // // // // // // //           {staff.map((s) => (
// // // // // // // //             <tr key={s._id}>
// // // // // // // //               <td style={thtd}>{s.name}</td>
// // // // // // // //               <td style={thtd}>{s.role}</td>
// // // // // // // //               <td style={thtd}>{s.phone}</td>
// // // // // // // //               <td style={thtd}>{s.email}</td>
// // // // // // // //               <td style={thtd}>{s.active ? "‚úÖ Active" : "‚ùå Inactive"}</td>
// // // // // // // //               <td style={thtd}>
// // // // // // // //                 <button
// // // // // // // //                   onClick={() => handleDeleteStaff(s._id)}
// // // // // // // //                   style={{
// // // // // // // //                     backgroundColor: "#b8860b",
// // // // // // // //                     color: "white",
// // // // // // // //                     border: "none",
// // // // // // // //                     borderRadius: "10px",
// // // // // // // //                     padding: "5px 10px",
// // // // // // // //                     cursor: "pointer",
// // // // // // // //                   }}
// // // // // // // //                 >
// // // // // // // //                   ‚ùå Delete
// // // // // // // //                 </button>
// // // // // // // //               </td>
// // // // // // // //             </tr>
// // // // // // // //           ))}
// // // // // // // //         </tbody>
// // // // // // // //       </table>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   // ---------------------- Main JSX ---------------------
// // // // // // // //   return (
// // // // // // // //     <div style={mainContainer}>
// // // // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // // // //       </header>

// // // // // // // //       <div style={tabContainer}>
// // // // // // // //         {[
// // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // //           { key: "menu", label: "Menu Items" },
// // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // //         ].map((tab) => (
// // // // // // // //           <button
// // // // // // // //             key={tab.key}
// // // // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // // // //             style={{
// // // // // // // //               ...tabButton,
// // // // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff",
// // // // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // // // //             }}
// // // // // // // //           >
// // // // // // // //             {tab.label}
// // // // // // // //           </button>
// // // // // // // //         ))}
// // // // // // // //       </div>

// // // // // // // //       <div style={contentCard}>
// // // // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // // // //         {activeTab === "tables" && renderTables()}
// // // // // // // //       </div>
// // // // // // // //     </div>
// // // // // // // //   );
// // // // // // // // }
// // // // // // // // src/pages/AdminPanel.jsx
// // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // import axios from "axios";
// // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // /**
// // // // // // //  * AdminPanel.jsx
// // // // // // //  * - Works with backend base URL: http://localhost:4000
// // // // // // //  * - Endpoints used:
// // // // // // //  *   GET  /api/menu/items
// // // // // // //  *   POST /api/menu/items  (multipart/form-data)
// // // // // // //  *   DELETE /api/menu/items/:id    (fallback: /api/menu/:id)
// // // // // // //  *   GET  /api/menu/categories
// // // // // // //  *   POST /api/menu/categories (multipart/form-data)
// // // // // // //  *   GET  /api/orders
// // // // // // //  *   GET  /api/staff
// // // // // // //  *   POST /api/staff
// // // // // // //  *   DELETE /api/staff/:id
// // // // // // //  *   GET  /api/tables
// // // // // // //  *   DELETE /api/tables/:id
// // // // // // //  */

// // // // // // // // const BASE = "http://192.168.29.218:4000";

// // // // // // // // const api = axios.create({
// // // // // // // //   baseURL: BASE,
// // // // // // // //   headers: { "Content-Type": "application/json" },
// // // // // // // // });

// // // // // // // // // attach token automatically if present
// // // // // // // // api.interceptors.request.use((cfg) => {
// // // // // // // //   const token = localStorage.getItem("token");
// // // // // // // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // // // // // // //   return cfg;
// // // // // // // // });

// // // // // // // // export default function AdminPanel() {
// // // // // // // //   const [activeTab, setActiveTab] = useState("orders");

// // // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // // //   // Data
// // // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // // //   const [menuItems, setMenuItems] = useState([]);
// // // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // // //   const [tables, setTables] = useState([]);

// // // // // // // //   // Form states
// // // // // // // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // // //   // Fetch all data
// // // // // // // //   useEffect(() => {
// // // // // // // //     (async () => {
// // // // // // // //       setLoading(true);
// // // // // // // //       await Promise.allSettled([
// // // // // // // //         fetchOrders(),
// // // // // // // //         fetchMenuItems(),
// // // // // // // //         fetchCategories(),
// // // // // // // //         fetchStaff(),
// // // // // // // //         fetchTables(),
// // // // // // // //       ]);
// // // // // // // //       setLoading(false);
// // // // // // // //     })();
// // // // // // // //     // eslint-disable-next-line react-hooks/exhaustive-deps
// // // // // // // //   }, []);

// // // // // // // //   /* ---------- Fetch helpers ---------- */
// // // // // // // //   const fetchOrders = async () => {
// // // // // // // //     try {
// // // // // // // //       const res = await api.get("/api/orders");
// // // // // // // //       // backend: { success:true, count, orders } OR {orders: [...] } OR array
// // // // // // // //       const data = res.data;
// // // // // // // //       const list = Array.isArray(data) ? data : data.orders || [];
// // // // // // // //       setOrders(list);
// // // // // // // //       return list;
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("fetchOrders error:", err);
// // // // // // // //       setOrders([]);
// // // // // // // //       return [];
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const fetchMenuItems = async () => {
// // // // // // // //     try {
// // // // // // // //       const res = await api.get("/api/menu/items");
// // // // // // // //       const data = res.data;
// // // // // // // //       const list = Array.isArray(data) ? data : data.items || [];
// // // // // // // //       setMenuItems(list);
// // // // // // // //       return list;
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("fetchMenuItems error:", err);
// // // // // // // //       setMenuItems([]);
// // // // // // // //       return [];
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const fetchCategories = async () => {
// // // // // // // //     try {
// // // // // // // //       const res = await api.get("/api/menu/categories");
// // // // // // // //       const data = res.data;
// // // // // // // //       const list = Array.isArray(data) ? data : data.categories || [];
// // // // // // // //       setCategories(list);
// // // // // // // //       return list;
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("fetchCategories error:", err);
// // // // // // // //       setCategories([]);
// // // // // // // //       return [];
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const fetchStaff = async () => {
// // // // // // // //     try {
// // // // // // // //       const res = await api.get("/api/staff");
// // // // // // // //       const data = res.data;
// // // // // // // //       const list = Array.isArray(data) ? data : data.staff || [];
// // // // // // // //       setStaff(list);
// // // // // // // //       return list;
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("fetchStaff error:", err);
// // // // // // // //       setStaff([]);
// // // // // // // //       return [];
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const fetchTables = async () => {
// // // // // // // //     try {
// // // // // // // //       const res = await api.get("/api/tables");
// // // // // // // //       const data = res.data;
// // // // // // // //       // your table route sometimes returns array or object
// // // // // // // //       const list = Array.isArray(data) ? data : data.tables || data;
// // // // // // // //       setTables(list);
// // // // // // // //       return list;
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("fetchTables error:", err);
// // // // // // // //       setTables([]);
// // // // // // // //       return [];
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   /* ---------- Staff: add / delete ---------- */
// // // // // // // //   const handleAddStaff = async (e) => {
// // // // // // // //     e.preventDefault();
// // // // // // // //     try {
// // // // // // // //       if (!newStaff.name || !newStaff.role || !newStaff.email) {
// // // // // // // //         alert("Please fill name, role and email for staff.");
// // // // // // // //         return;
// // // // // // // //       }
// // // // // // // //       const res = await api.post("/api/staff", newStaff);
// // // // // // // //       if (res.data && res.data.success) {
// // // // // // // //         alert("Staff added ‚úÖ");
// // // // // // // //       }
// // // // // // // //       await fetchStaff();
// // // // // // // //       setNewStaff({ name: "", role: "", phone: "", email: "" });
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("handleAddStaff err:", err);
// // // // // // // //       alert("Failed to add staff. See console.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const handleDeleteStaff = async (id) => {
// // // // // // // //     if (!window.confirm("Delete staff?")) return;
// // // // // // // //     try {
// // // // // // // //       await api.delete(`/api/staff/${id}`);
// // // // // // // //       await fetchStaff();
// // // // // // // //       alert("Staff removed ‚úÖ");
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("handleDeleteStaff err:", err);
// // // // // // // //       alert("Failed to delete staff.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   /* ---------- Menu Item: add / delete ---------- */
// // // // // // // //   const handleAddMenuItem = async () => {
// // // // // // // //     try {
// // // // // // // //       if (!newItem.name || !newItem.price) {
// // // // // // // //         alert("Item name and price required");
// // // // // // // //         return;
// // // // // // // //       }
// // // // // // // //       const form = new FormData();
// // // // // // // //       form.append("name", newItem.name);
// // // // // // // //       form.append("price", newItem.price);
// // // // // // // //       form.append("categoryId", newItem.categoryId || "");
// // // // // // // //       if (newItem.image) form.append("image", newItem.image);

// // // // // // // //       setUploading(true);
// // // // // // // //       const res = await api.post("/api/menu/items", form, {
// // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // //       });
// // // // // // // //       setUploading(false);
// // // // // // // //       if (res.data && res.data.success) {
// // // // // // // //         alert("Menu item added ‚úÖ");
// // // // // // // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // // //         await fetchMenuItems();
// // // // // // // //       } else {
// // // // // // // //         alert("Failed to add item.");
// // // // // // // //       }
// // // // // // // //     } catch (err) {
// // // // // // // //       setUploading(false);
// // // // // // // //       console.error("handleAddMenuItem err:", err);
// // // // // // // //       alert("Error adding menu item. See console.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const handleDeleteMenuItem = async (id) => {
// // // // // // // //     if (!window.confirm("Delete menu item?")) return;
// // // // // // // //     try {
// // // // // // // //       // try standard route first
// // // // // // // //       try {
// // // // // // // //         await api.delete(`/api/menu/items/${id}`);
// // // // // // // //       } catch (err1) {
// // // // // // // //         // fallback older route if exists
// // // // // // // //         await api.delete(`/api/menu/${id}`);
// // // // // // // //       }
// // // // // // // //       await fetchMenuItems();
// // // // // // // //       alert("Menu item deleted ‚úÖ");
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("handleDeleteMenuItem err:", err);
// // // // // // // //       alert("Failed to delete menu item.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   /* ---------- Category add ---------- */
// // // // // // // //   const handleAddCategory = async () => {
// // // // // // // //     try {
// // // // // // // //       if (!newCategory.name) {
// // // // // // // //         alert("Category name required");
// // // // // // // //         return;
// // // // // // // //       }
// // // // // // // //       const form = new FormData();
// // // // // // // //       form.append("name", newCategory.name);
// // // // // // // //       if (newCategory.image) form.append("image", newCategory.image);

// // // // // // // //       setUploading(true);
// // // // // // // //       const res = await api.post("/api/menu/categories", form, {
// // // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // // //       });
// // // // // // // //       setUploading(false);
// // // // // // // //       if (res.data && res.data.success) {
// // // // // // // //         alert("Category added ‚úÖ");
// // // // // // // //         setNewCategory({ name: "", image: null });
// // // // // // // //         await fetchCategories();
// // // // // // // //       } else {
// // // // // // // //         alert("Failed to add category.");
// // // // // // // //       }
// // // // // // // //     } catch (err) {
// // // // // // // //       setUploading(false);
// // // // // // // //       console.error("handleAddCategory err:", err);
// // // // // // // //       alert("Error adding category.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   /* ---------- Table delete ---------- */
// // // // // // // //   const handleDeleteTable = async (id) => {
// // // // // // // //     if (!window.confirm("Delete table?")) return;
// // // // // // // //     try {
// // // // // // // //       await api.delete(`/api/tables/${id}`);
// // // // // // // //       await fetchTables();
// // // // // // // //       alert("Table deleted ‚úÖ");
// // // // // // // //     } catch (err) {
// // // // // // // //       console.error("handleDeleteTable err:", err);
// // // // // // // //       alert("Failed to delete table.");
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   /* ---------- Utility render guards ---------- */
// // // // // // // //   const safeMap = (arr, fn) => (Array.isArray(arr) ? arr.map(fn) : null);

// // // // // // // //   /* ---------- Styles (inline golden-white theme) ---------- */
// // // // // // // //   const styles = {
// // // // // // // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // // // // // // //     header: { textAlign: "center", marginBottom: 20 },
// // // // // // // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // // // // // // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // // // // // // //     tabBtn: (active) => ({
// // // // // // // //       padding: "8px 16px",
// // // // // // // //       borderRadius: 10,
// // // // // // // //       border: `2px solid #d4af37`,
// // // // // // // //       cursor: "pointer",
// // // // // // // //       background: active ? "#d4af37" : "#fff",
// // // // // // // //       color: active ? "#fff" : "#b8860b",
// // // // // // // //       fontWeight: 600,
// // // // // // // //     }),
// // // // // // // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // // // // // // //     sectionTitle: { color: "#b8860b", fontSize: 18, marginBottom: 12, borderBottom: "1px solid #f3e3a6", paddingBottom: 8 },
// // // // // // // //     grid: { display: "flex", gap: 14, flexWrap: "wrap" },
// // // // // // // //     card: { background: "#fffaf0", border: "1px solid #d4af37", padding: 14, borderRadius: 10, minWidth: 220 },
// // // // // // // //     table: { width: "100%", borderCollapse: "collapse", marginTop: 8 },
// // // // // // // //     th: { border: "1px solid #f3e3a6", padding: 8, background: "#fffaf0", color: "#b8860b" },
// // // // // // // //     td: { border: "1px solid #f3e3a6", padding: 8, textAlign: "center" },
// // // // // // // //     formRow: { display: "flex", gap: 8, flexWrap: "wrap", marginBottom: 12 },
// // // // // // // //     input: { padding: 8, borderRadius: 6, border: "1px solid #ddd", minWidth: 160 },
// // // // // // // //     primaryBtn: { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: 8, cursor: "pointer" },
// // // // // // // //     dangerBtn: { background: "#d9534f", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
// // // // // // // //     smallBtn: { background: "#b8860b", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
// // // // // // // //     empty: { textAlign: "center", color: "#777", padding: 20 },
// // // // // // // //   };

// // // // // // // //   /* ---------- Render sections ---------- */

// // // // // // // //   const OrdersSection = () => (
// // // // // // // //     <div>
// // // // // // // //       <div style={styles.sectionTitle}>üßæ Orders</div>
// // // // // // // //       {!Array.isArray(orders) || orders.length === 0 ? (
// // // // // // // //         <div style={styles.empty}>No orders yet</div>
// // // // // // // //       ) : (
// // // // // // // //         <div style={styles.grid}>
// // // // // // // //           {safeMap(orders, (o) => {
// // // // // // // //             // normalize order object shapes
// // // // // // // //             const items = o.items || o.itemsOrdered || [];
// // // // // // // //             const tableSlug = o.tableSlug || (o.tableId && o.tableId.qrSlug) || (o.tableId && o.tableId.number) || "N/A";
// // // // // // // //             const totalFromServer = o.total || o.totalPrice || o.amount || items.reduce((s, it) => s + (it.price || it.price_per_item || 0) * (it.qty || it.quantity || 1), 0);
// // // // // // // //             return (
// // // // // // // //               <div key={o._id || Math.random()} style={styles.card}>
// // // // // // // //                 <div style={{ marginBottom: 8, color: "#8b6b00", fontWeight: 700 }}>Table: {String(tableSlug)}</div>
// // // // // // // //                 <div style={{ marginBottom: 6 }}><b>Status:</b> <span style={{ color: o.status === "placed" ? "#b8860b" : o.status === "completed" ? "green" : "red" }}>{o.status || "N/A"}</span></div>
// // // // // // // //                 <div style={{ marginBottom: 8 }}><b>Total:</b> ‚Çπ{totalFromServer}</div>
// // // // // // // //                 <div style={{ fontWeight: 700, color: "#b8860b", marginBottom: 6 }}>Items</div>
// // // // // // // //                 <ul style={{ margin: 0, paddingLeft: 18 }}>
// // // // // // // //                   {safeMap(items, (it, idx) => (
// // // // // // // //                     <li key={idx} style={{ marginBottom: 4 }}>
// // // // // // // //                       {it.name || it.itemName || it.itemId?.name || "Unnamed Item"} √ó {it.qty || it.quantity || 1} {it.itemId?.price ? ` ‚Äî ‚Çπ${it.itemId.price}` : ""}

// // // // // // // //                     </li>
// // // // // // // //                   ))}
// // // // // // // //                 </ul>
// // // // // // // //               </div>
// // // // // // // //             );
// // // // // // // //           })}
// // // // // // // //         </div>
// // // // // // // //       )}
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const MenuSection = () => (
// // // // // // // //     <div>
// // // // // // // //       <div style={styles.sectionTitle}>üçî Menu Items</div>

// // // // // // // //       <div style={styles.formRow}>
// // // // // // // //         <input style={styles.input} placeholder="Name" value={newItem.name} onChange={(e) => setNewItem((p) => ({ ...p, name: e.target.value }))} />
// // // // // // // //         <input style={styles.input} placeholder="Price" type="number" value={newItem.price} onChange={(e) => setNewItem((p) => ({ ...p, price: e.target.value }))} />
// // // // // // // //         <select style={styles.input} value={newItem.categoryId} onChange={(e) => setNewItem((p) => ({ ...p, categoryId: e.target.value }))}>
// // // // // // // //           <option value="">‚Äî Category ‚Äî</option>
// // // // // // // //           {safeMap(categories, (c) => <option key={c._id} value={c._id}>{c.name}</option>)}
// // // // // // // //         </select>
// // // // // // // //         <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewItem((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
// // // // // // // //         <button style={styles.primaryBtn} onClick={handleAddMenuItem} disabled={uploading}>{uploading ? "Uploading..." : "Add Item"}</button>
// // // // // // // //       </div>

// // // // // // // //       <div style={{ marginTop: 10 }}>
// // // // // // // //         {(!Array.isArray(menuItems) || menuItems.length === 0) ? (
// // // // // // // //           <div style={styles.empty}>No menu items</div>
// // // // // // // //         ) : (
// // // // // // // //           <table style={styles.table}>
// // // // // // // //             <thead>
// // // // // // // //               <tr>
// // // // // // // //                 <th style={styles.th}>Image</th>
// // // // // // // //                 <th style={styles.th}>Name</th>
// // // // // // // //                 <th style={styles.th}>Price</th>
// // // // // // // //                 <th style={styles.th}>Category</th>
// // // // // // // //                 <th style={styles.th}>Action</th>
// // // // // // // //               </tr>
// // // // // // // //             </thead>
// // // // // // // //             <tbody>
// // // // // // // //               {safeMap(menuItems, (it) => (
// // // // // // // //                 <tr key={it._id}>
// // // // // // // //                   <td style={styles.td}>
// // // // // // // //                     {it.image ? <img src={it.image.startsWith("/uploads") ? `${BASE}${it.image}` : it.image} alt={it.name} width={60} style={{ borderRadius: 6 }} /> : "‚Äî"}
// // // // // // // //                   </td>
// // // // // // // //                   <td style={styles.td}>{it.name}</td>
// // // // // // // //                   <td style={styles.td}>‚Çπ{it.price}</td>
// // // // // // // //                   <td style={styles.td}>{(it.categoryId && (it.categoryId.name || it.categoryId)) || "‚Äî"}</td>
// // // // // // // //                   <td style={styles.td}>
// // // // // // // //                     <button style={styles.dangerBtn} onClick={() => handleDeleteMenuItem(it._id)}>Delete</button>
// // // // // // // //                   </td>
// // // // // // // //                 </tr>
// // // // // // // //               ))}
// // // // // // // //             </tbody>
// // // // // // // //           </table>
// // // // // // // //         )}
// // // // // // // //       </div>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const CategoriesSection = () => (
// // // // // // // //     <div>
// // // // // // // //       <div style={styles.sectionTitle}>üìã Categories</div>

// // // // // // // //       <div style={styles.formRow}>
// // // // // // // //         <input style={styles.input} placeholder="Category name" value={newCategory.name} onChange={(e) => setNewCategory((p) => ({ ...p, name: e.target.value }))} />
// // // // // // // //         <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewCategory((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
// // // // // // // //         <button style={styles.primaryBtn} onClick={handleAddCategory} disabled={uploading}>{uploading ? "Uploading..." : "Add Category"}</button>
// // // // // // // //       </div>

// // // // // // // //       <div style={{ marginTop: 10 }}>
// // // // // // // //         {(!Array.isArray(categories) || categories.length === 0) ? (
// // // // // // // //           <div style={styles.empty}>No categories</div>
// // // // // // // //         ) : (
// // // // // // // //           <div style={styles.grid}>
// // // // // // // //             {safeMap(categories, (c) => (
// // // // // // // //               <div key={c._id} style={styles.card}>
// // // // // // // //                 <div style={{ fontWeight: 700 }}>{c.name}</div>
// // // // // // // //                 {c.image && <img src={c.image.startsWith("/uploads") ? `${BASE}${c.image}` : c.image} alt={c.name} width={90} style={{ marginTop: 8, borderRadius: 6 }} />}
// // // // // // // //               </div>
// // // // // // // //             ))}
// // // // // // // //           </div>
// // // // // // // //         )}
// // // // // // // //       </div>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const StaffSection = () => (
// // // // // // // //     <div>
// // // // // // // //       <div style={styles.sectionTitle}>üë©‚Äçüç≥ Staff</div>

// // // // // // // //       <form onSubmit={handleAddStaff} style={{ marginBottom: 12 }}>
// // // // // // // //         <div style={styles.formRow}>
// // // // // // // //           <input style={styles.input} placeholder="Name" value={newStaff.name} onChange={(e) => setNewStaff((p) => ({ ...p, name: e.target.value }))} required />
// // // // // // // //           <input style={styles.input} placeholder="Role" value={newStaff.role} onChange={(e) => setNewStaff((p) => ({ ...p, role: e.target.value }))} required />
// // // // // // // //           <input style={styles.input} placeholder="Phone" value={newStaff.phone} onChange={(e) => setNewStaff((p) => ({ ...p, phone: e.target.value }))} />
// // // // // // // //           <input style={styles.input} placeholder="Email" value={newStaff.email} onChange={(e) => setNewStaff((p) => ({ ...p, email: e.target.value }))} required />
// // // // // // // //           <button style={styles.primaryBtn} type="submit">Add Staff</button>
// // // // // // // //         </div>
// // // // // // // //       </form>

// // // // // // // //       <div style={{ marginTop: 10 }}>
// // // // // // // //         {(!Array.isArray(staff) || staff.length === 0) ? (
// // // // // // // //           <div style={styles.empty}>No staff</div>
// // // // // // // //         ) : (
// // // // // // // //           <table style={styles.table}>
// // // // // // // //             <thead>
// // // // // // // //               <tr>
// // // // // // // //                 <th style={styles.th}>Name</th>
// // // // // // // //                 <th style={styles.th}>Role</th>
// // // // // // // //                 <th style={styles.th}>Phone</th>
// // // // // // // //                 <th style={styles.th}>Email</th>
// // // // // // // //                 <th style={styles.th}>Action</th>
// // // // // // // //               </tr>
// // // // // // // //             </thead>
// // // // // // // //             <tbody>
// // // // // // // //               {safeMap(staff, (s) => (
// // // // // // // //                 <tr key={s._id}>
// // // // // // // //                   <td style={styles.td}>{s.name}</td>
// // // // // // // //                   <td style={styles.td}>{s.role}</td>
// // // // // // // //                   <td style={styles.td}>{s.phone || "‚Äî"}</td>
// // // // // // // //                   <td style={styles.td}>{s.email}</td>
// // // // // // // //                   <td style={styles.td}><button style={styles.dangerBtn} onClick={() => handleDeleteStaff(s._1d || s._id)}>Delete</button></td>
// // // // // // // //                 </tr>
// // // // // // // //               ))}
// // // // // // // //             </tbody>
// // // // // // // //           </table>
// // // // // // // //         )}
// // // // // // // //       </div>
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   const TablesSection = () => (
// // // // // // // //     <div>
// // // // // // // //       <div style={styles.sectionTitle}>ü™ë Tables</div>
// // // // // // // //       {(!Array.isArray(tables) || tables.length === 0) ? (
// // // // // // // //         <div style={styles.empty}>No tables</div>
// // // // // // // //       ) : (
// // // // // // // //         <div style={styles.grid}>
// // // // // // // //           {safeMap(tables, (t) => (
// // // // // // // //             <div key={t._id} style={styles.card}>
// // // // // // // //               <div style={{ fontWeight: 700 }}>Table {t.number}</div>
// // // // // // // //               <QRCodeCanvas value={`http://localhost:5173/menu/${t.qrSlug}`} size={90} />
// // // // // // // //               <div style={{ marginTop: 8 }}>Slug: {t.qrSlug}</div>
// // // // // // // //               <div style={{ marginTop: 8 }}>
// // // // // // // //                 <button style={styles.dangerBtn} onClick={() => handleDeleteTable(t._id)}>Delete</button>
// // // // // // // //               </div>
// // // // // // // //             </div>
// // // // // // // //           ))}
// // // // // // // //         </div>
// // // // // // // //       )}
// // // // // // // //     </div>
// // // // // // // //   );

// // // // // // // //   /* ---------- Main render ---------- */
// // // // // // // //   return (
// // // // // // // //     <div style={styles.page}>
// // // // // // // //       <div style={styles.header}>
// // // // // // // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // // // // // // //       </div>

// // // // // // // //       <div style={styles.tabs}>
// // // // // // // //         {[
// // // // // // // //           { key: "orders", label: "Orders" },
// // // // // // // //           { key: "menu", label: "Menu" },
// // // // // // // //           { key: "categories", label: "Categories" },
// // // // // // // //           { key: "staff", label: "Staff" },
// // // // // // // //           { key: "tables", label: "Tables" },
// // // // // // // //         ].map((t) => (
// // // // // // // //           <button key={t.key} onClick={() => setActiveTab(t.key)} style={styles.tabBtn(activeTab === t.key)}>{t.label}</button>
// // // // // // // //         ))}
// // // // // // // //       </div>

// // // // // // // //       <div style={styles.container}>
// // // // // // // //         {loading ? <div style={styles.empty}>Loading...</div> : (
// // // // // // // //           <>
// // // // // // // //             {activeTab === "orders" && <OrdersSection />}
// // // // // // // //             {activeTab === "menu" && <MenuSection />}
// // // // // // // //             {activeTab === "categories" && <CategoriesSection />}
// // // // // // // //             {activeTab === "staff" && <StaffSection />}
// // // // // // // //             {activeTab === "tables" && <TablesSection />}
// // // // // // // //           </>
// // // // // // // //         )}
// // // // // // // //       </div>
// // // // // // // //     </div>
// // // // // // // //   );
// // // // // // // // }
// // // // // // // import React, { useEffect, useState } from "react";
// // // // // // // import axios from "axios";
// // // // // // // import { useNavigate } from "react-router-dom";
// // // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // // const BASE = "http://192.168.29.218:4000"; // ‚úÖ your backend URL

// // // // // // // // Axios instance with token interceptor
// // // // // // // const api = axios.create({
// // // // // // //   baseURL: BASE,
// // // // // // //   headers: { "Content-Type": "application/json" },
// // // // // // // });

// // // // // // // api.interceptors.request.use((cfg) => {
// // // // // // //   const token = localStorage.getItem("token");
// // // // // // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // // // // // //   return cfg;
// // // // // // // });

// // // // // // // export default function AdminPanel() {
// // // // // // //   const navigate = useNavigate();

// // // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // // //   const [loading, setLoading] = useState(true);

// // // // // // //   // Data states
// // // // // // //   const [orders, setOrders] = useState([]);
// // // // // // //   const [menuItems, setMenuItems] = useState([]);
// // // // // // //   const [categories, setCategories] = useState([]);
// // // // // // //   const [staff, setStaff] = useState([]);
// // // // // // //   const [tables, setTables] = useState([]);

// // // // // // //   // Form states
// // // // // // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // // //   const [uploading, setUploading] = useState(false);

// // // // // // //   // ‚úÖ Auth check
// // // // // // //   useEffect(() => {
// // // // // // //     const token = localStorage.getItem("token");
// // // // // // //     const user = JSON.parse(localStorage.getItem("user") || "{}");

// // // // // // //     if (!token || user.role !== "admin") {
// // // // // // //       alert("Unauthorized access. Please login as admin.");
// // // // // // //       localStorage.removeItem("token");
// // // // // // //       localStorage.removeItem("user");
// // // // // // //       navigate("/login");
// // // // // // //       return;
// // // // // // //     }

// // // // // // //     // Verify token by hitting backend once
// // // // // // //     (async () => {
// // // // // // //       try {
// // // // // // //         await api.get("/api/protected-test"); // optional endpoint to verify token
// // // // // // //       } catch {
// // // // // // //         alert("Session expired. Please login again.");
// // // // // // //         localStorage.removeItem("token");
// // // // // // //         localStorage.removeItem("user");
// // // // // // //         navigate("/login");
// // // // // // //       }
// // // // // // //     })();
// // // // // // //   }, [navigate]);

// // // // // // //   // Fetch all data after login
// // // // // // //   useEffect(() => {
// // // // // // //     (async () => {
// // // // // // //       setLoading(true);
// // // // // // //       await Promise.allSettled([
// // // // // // //         fetchOrders(),
// // // // // // //         fetchMenuItems(),
// // // // // // //         fetchCategories(),
// // // // // // //         fetchStaff(),
// // // // // // //         fetchTables(),
// // // // // // //       ]);
// // // // // // //       setLoading(false);
// // // // // // //     })();
// // // // // // //   }, []);

// // // // // // //   /* ==================== Fetch Functions ==================== */
// // // // // // //   const fetchOrders = async () => {
// // // // // // //     try {
// // // // // // //       const res = await api.get("/api/orders");
// // // // // // //       const data = res.data;
// // // // // // //       setOrders(data.orders || data || []);
// // // // // // //     } catch (err) {
// // // // // // //       console.error("fetchOrders error:", err);
// // // // // // //       setOrders([]);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const fetchMenuItems = async () => {
// // // // // // //     try {
// // // // // // //       const res = await api.get("/api/menu/items");
// // // // // // //       const data = res.data;
// // // // // // //       setMenuItems(data.items || data || []);
// // // // // // //     } catch (err) {
// // // // // // //       console.error("fetchMenuItems error:", err);
// // // // // // //       setMenuItems([]);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const fetchCategories = async () => {
// // // // // // //     try {
// // // // // // //       const res = await api.get("/api/menu/categories");
// // // // // // //       const data = res.data;
// // // // // // //       setCategories(data.categories || data || []);
// // // // // // //     } catch (err) {
// // // // // // //       console.error("fetchCategories error:", err);
// // // // // // //       setCategories([]);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const fetchStaff = async () => {
// // // // // // //     try {
// // // // // // //       const res = await api.get("/api/staff");
// // // // // // //       const data = res.data;
// // // // // // //       setStaff(data.staff || data || []);
// // // // // // //     } catch (err) {
// // // // // // //       console.error("fetchStaff error:", err);
// // // // // // //       setStaff([]);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const fetchTables = async () => {
// // // // // // //     try {
// // // // // // //       const res = await api.get("/api/tables");
// // // // // // //       const data = res.data;
// // // // // // //       setTables(data.tables || data || []);
// // // // // // //     } catch (err) {
// // // // // // //       console.error("fetchTables error:", err);
// // // // // // //       setTables([]);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   /* ==================== Add/Delete Functions ==================== */
// // // // // // //   const handleAddStaff = async (e) => {
// // // // // // //     e.preventDefault();
// // // // // // //     try {
// // // // // // //       const res = await api.post("/api/staff", newStaff);
// // // // // // //       if (res.data.success) {
// // // // // // //         alert("‚úÖ Staff added!");
// // // // // // //         await fetchStaff();
// // // // // // //         setNewStaff({ name: "", role: "", phone: "", email: "" });
// // // // // // //       }
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       alert("Error adding staff");
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleDeleteStaff = async (id) => {
// // // // // // //     if (!window.confirm("Delete staff?")) return;
// // // // // // //     try {
// // // // // // //       await api.delete(`/api/staff/${id}`);
// // // // // // //       await fetchStaff();
// // // // // // //       alert("Staff deleted ‚úÖ");
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       alert("Failed to delete staff");
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleAddCategory = async () => {
// // // // // // //     try {
// // // // // // //       const form = new FormData();
// // // // // // //       form.append("name", newCategory.name);
// // // // // // //       if (newCategory.image) form.append("image", newCategory.image);

// // // // // // //       setUploading(true);
// // // // // // //       const res = await api.post("/api/menu/categories", form, {
// // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // //       });
// // // // // // //       setUploading(false);
// // // // // // //       if (res.data.success) {
// // // // // // //         alert("‚úÖ Category added!");
// // // // // // //         await fetchCategories();
// // // // // // //         setNewCategory({ name: "", image: null });
// // // // // // //       }
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       setUploading(false);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleAddMenuItem = async () => {
// // // // // // //     try {
// // // // // // //       const form = new FormData();
// // // // // // //       form.append("name", newItem.name);
// // // // // // //       form.append("price", newItem.price);
// // // // // // //       form.append("categoryId", newItem.categoryId || "");
// // // // // // //       if (newItem.image) form.append("image", newItem.image);

// // // // // // //       setUploading(true);
// // // // // // //       const res = await api.post("/api/menu/items", form, {
// // // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // // //       });
// // // // // // //       setUploading(false);
// // // // // // //       if (res.data.success) {
// // // // // // //         alert("‚úÖ Menu item added!");
// // // // // // //         await fetchMenuItems();
// // // // // // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // // //       }
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       setUploading(false);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleDeleteMenuItem = async (id) => {
// // // // // // //     if (!window.confirm("Delete this item?")) return;
// // // // // // //     try {
// // // // // // //       await api.delete(`/api/menu/items/${id}`);
// // // // // // //       await fetchMenuItems();
// // // // // // //       alert("Menu item deleted ‚úÖ");
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       alert("Failed to delete menu item");
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleDeleteTable = async (id) => {
// // // // // // //     if (!window.confirm("Delete this table?")) return;
// // // // // // //     try {
// // // // // // //       await api.delete(`/api/tables/${id}`);
// // // // // // //       await fetchTables();
// // // // // // //       alert("Table deleted ‚úÖ");
// // // // // // //     } catch (err) {
// // // // // // //       console.error(err);
// // // // // // //       alert("Failed to delete table");
// // // // // // //     }
// // // // // // //   };

// // // // // // //   /* ==================== UI Layout ==================== */
// // // // // // //   const tabs = [
// // // // // // //     { key: "orders", label: "Orders" },
// // // // // // //     { key: "menu", label: "Menu" },
// // // // // // //     { key: "categories", label: "Categories" },
// // // // // // //     { key: "staff", label: "Staff" },
// // // // // // //     { key: "tables", label: "Tables" },
// // // // // // //   ];

// // // // // // //   const styles = {
// // // // // // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // // // // // //     header: { textAlign: "center", marginBottom: 20 },
// // // // // // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // // // // // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // // // // // //     tabBtn: (active) => ({
// // // // // // //       padding: "8px 16px",
// // // // // // //       borderRadius: 10,
// // // // // // //       border: "2px solid #d4af37",
// // // // // // //       cursor: "pointer",
// // // // // // //       background: active ? "#d4af37" : "#fff",
// // // // // // //       color: active ? "#fff" : "#b8860b",
// // // // // // //       fontWeight: 600,
// // // // // // //     }),
// // // // // // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // // // // // //   };

// // // // // // //   return (
// // // // // // //     <div style={styles.page}>
// // // // // // //       <div style={styles.header}>
// // // // // // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // // // // // //       </div>

// // // // // // //       <div style={styles.tabs}>
// // // // // // //         {tabs.map((t) => (
// // // // // // //           <button key={t.key} onClick={() => setActiveTab(t.key)} style={styles.tabBtn(activeTab === t.key)}>
// // // // // // //             {t.label}
// // // // // // //           </button>
// // // // // // //         ))}
// // // // // // //       </div>

// // // // // // //       <div style={styles.container}>
// // // // // // //         {loading ? <p>Loading...</p> : (
// // // // // // //           <>
// // // // // // //             {activeTab === "orders" && <div>Orders Section</div>}
// // // // // // //             {activeTab === "menu" && <div>Menu Items Section</div>}
// // // // // // //             {activeTab === "categories" && <div>Categories Section</div>}
// // // // // // //             {activeTab === "staff" && <div>Staff Section</div>}
// // // // // // //             {activeTab === "tables" && <div>Tables Section</div>}
// // // // // // //           </>
// // // // // // //         )}
// // // // // // //       </div>
// // // // // // //     </div>
// // // // // // //   );
// // // // // // // }
// // // // // // import React, { useEffect, useState } from "react";
// // // // // // import axios from "axios";
// // // // // // import { useNavigate } from "react-router-dom";
// // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // const BASE = "http://localhost:4000"; // ‚úÖ Backend URL

// // // // // // // Axios instance with token interceptor
// // // // // // const api = axios.create({
// // // // // //   baseURL: BASE,
// // // // // //   headers: { "Content-Type": "application/json" },
// // // // // // });

// // // // // // api.interceptors.request.use((cfg) => {
// // // // // //   const token = localStorage.getItem("token");
// // // // // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // // // // //   return cfg;
// // // // // // });

// // // // // // export default function AdminPanel() {
// // // // // //   const navigate = useNavigate();

// // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // //   const [loading, setLoading] = useState(true);

// // // // // //   // Data states
// // // // // //   const [orders, setOrders] = useState([]);
// // // // // //   const [menuItems, setMenuItems] = useState([]);
// // // // // //   const [categories, setCategories] = useState([]);
// // // // // //   const [staff, setStaff] = useState([]);
// // // // // //   const [tables, setTables] = useState([]);

// // // // // //   // Form states
// // // // // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // // //   const [uploading, setUploading] = useState(false);

// // // // // //   // ‚úÖ Auth check
// // // // // //   useEffect(() => {
// // // // // //     const token = localStorage.getItem("token");
// // // // // //     const user = JSON.parse(localStorage.getItem("user") || "{}");

// // // // // //     // If no token or wrong role ‚Üí redirect
// // // // // //     if (!token || user.role !== "admin") {
// // // // // //       alert("Unauthorized access. Please login as admin.");
// // // // // //       localStorage.removeItem("token");
// // // // // //       localStorage.removeItem("user");
// // // // // //       navigate("/login");
// // // // // //       return;
// // // // // //     }

// // // // // //     // Optional token verification call (ignore if backend lacks /protected-test)
// // // // // //     (async () => {
// // // // // //       try {
// // // // // //         await api.get("/api/protected-test");
// // // // // //       } catch (err) {
// // // // // //         console.warn("Token check failed:", err);
// // // // // //         alert("Session expired. Please login again.");
// // // // // //         localStorage.removeItem("token");
// // // // // //         localStorage.removeItem("user");
// // // // // //         navigate("/login");
// // // // // //       }
// // // // // //     })();
// // // // // //   }, [navigate]);

// // // // // //   // Fetch all data after login
// // // // // //   useEffect(() => {
// // // // // //     const fetchAll = async () => {
// // // // // //       try {
// // // // // //         setLoading(true);
// // // // // //         await Promise.allSettled([
// // // // // //           fetchOrders(),
// // // // // //           fetchMenuItems(),
// // // // // //           fetchCategories(),
// // // // // //           fetchStaff(),
// // // // // //           fetchTables(),
// // // // // //         ]);
// // // // // //       } finally {
// // // // // //         setLoading(false);
// // // // // //       }
// // // // // //     };
// // // // // //     fetchAll();
// // // // // //   }, []);

// // // // // //   /* ==================== Fetch Functions ==================== */
// // // // // //   const fetchOrders = async () => {
// // // // // //     try {
// // // // // //       const res = await api.get("/api/orders");
// // // // // //       setOrders(res.data.orders || []);
// // // // // //     } catch (err) {
// // // // // //       console.error("fetchOrders error:", err);
// // // // // //       setOrders([]);
// // // // // //     }
// // // // // //   };

// // // // // //   const fetchMenuItems = async () => {
// // // // // //     try {
// // // // // //       const res = await api.get("/api/menu/items");
// // // // // //       setMenuItems(res.data.items || []);
// // // // // //     } catch (err) {
// // // // // //       console.error("fetchMenuItems error:", err);
// // // // // //       setMenuItems([]);
// // // // // //     }
// // // // // //   };

// // // // // //   const fetchCategories = async () => {
// // // // // //     try {
// // // // // //       const res = await api.get("/api/menu/categories");
// // // // // //       setCategories(res.data.categories || []);
// // // // // //     } catch (err) {
// // // // // //       console.error("fetchCategories error:", err);
// // // // // //       setCategories([]);
// // // // // //     }
// // // // // //   };

// // // // // //   const fetchStaff = async () => {
// // // // // //     try {
// // // // // //       const res = await api.get("/api/staff");
// // // // // //       setStaff(res.data.staff || []);
// // // // // //     } catch (err) {
// // // // // //       console.error("fetchStaff error:", err);
// // // // // //       setStaff([]);
// // // // // //     }
// // // // // //   };

// // // // // //   const fetchTables = async () => {
// // // // // //     try {
// // // // // //       const res = await api.get("/api/tables");
// // // // // //       setTables(res.data.tables || []);
// // // // // //     } catch (err) {
// // // // // //       console.error("fetchTables error:", err);
// // // // // //       setTables([]);
// // // // // //     }
// // // // // //   };

// // // // // //   /* ==================== Add/Delete Functions ==================== */
// // // // // //   const handleAddStaff = async (e) => {
// // // // // //     e.preventDefault();
// // // // // //     try {
// // // // // //       const res = await api.post("/api/staff", newStaff);
// // // // // //       if (res.data.success) {
// // // // // //         alert("‚úÖ Staff added!");
// // // // // //         await fetchStaff();
// // // // // //         setNewStaff({ name: "", role: "", phone: "", email: "" });
// // // // // //       }
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //       alert("Error adding staff");
// // // // // //     }
// // // // // //   };

// // // // // //   const handleDeleteStaff = async (id) => {
// // // // // //     if (!window.confirm("Delete staff?")) return;
// // // // // //     try {
// // // // // //       await api.delete(`/api/staff/${id}`);
// // // // // //       await fetchStaff();
// // // // // //       alert("Staff deleted ‚úÖ");
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //       alert("Failed to delete staff");
// // // // // //     }
// // // // // //   };

// // // // // //   const handleAddCategory = async () => {
// // // // // //     try {
// // // // // //       const form = new FormData();
// // // // // //       form.append("name", newCategory.name);
// // // // // //       if (newCategory.image) form.append("image", newCategory.image);

// // // // // //       setUploading(true);
// // // // // //       const res = await api.post("/api/menu/categories", form, {
// // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // //       });
// // // // // //       if (res.data.success) {
// // // // // //         alert("‚úÖ Category added!");
// // // // // //         await fetchCategories();
// // // // // //         setNewCategory({ name: "", image: null });
// // // // // //       }
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //     } finally {
// // // // // //       setUploading(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleAddMenuItem = async () => {
// // // // // //     try {
// // // // // //       const form = new FormData();
// // // // // //       form.append("name", newItem.name);
// // // // // //       form.append("price", newItem.price);
// // // // // //       form.append("categoryId", newItem.categoryId || "");
// // // // // //       if (newItem.image) form.append("image", newItem.image);

// // // // // //       setUploading(true);
// // // // // //       const res = await api.post("/api/menu/items", form, {
// // // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // // //       });
// // // // // //       if (res.data.success) {
// // // // // //         alert("‚úÖ Menu item added!");
// // // // // //         await fetchMenuItems();
// // // // // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // // //       }
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //     } finally {
// // // // // //       setUploading(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleDeleteMenuItem = async (id) => {
// // // // // //     if (!window.confirm("Delete this item?")) return;
// // // // // //     try {
// // // // // //       await api.delete(`/api/menu/items/${id}`);
// // // // // //       await fetchMenuItems();
// // // // // //       alert("Menu item deleted ‚úÖ");
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //       alert("Failed to delete menu item");
// // // // // //     }
// // // // // //   };

// // // // // //   const handleDeleteTable = async (id) => {
// // // // // //     if (!window.confirm("Delete this table?")) return;
// // // // // //     try {
// // // // // //       await api.delete(`/api/tables/${id}`);
// // // // // //       await fetchTables();
// // // // // //       alert("Table deleted ‚úÖ");
// // // // // //     } catch (err) {
// // // // // //       console.error(err);
// // // // // //       alert("Failed to delete table");
// // // // // //     }
// // // // // //   };

// // // // // //   /* ==================== UI Layout ==================== */
// // // // // //   const tabs = [
// // // // // //     { key: "orders", label: "Orders" },
// // // // // //     { key: "menu", label: "Menu" },
// // // // // //     { key: "categories", label: "Categories" },
// // // // // //     { key: "staff", label: "Staff" },
// // // // // //     { key: "tables", label: "Tables" },
// // // // // //   ];

// // // // // //   const styles = {
// // // // // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // // // // //     header: { textAlign: "center", marginBottom: 20 },
// // // // // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // // // // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // // // // //     tabBtn: (active) => ({
// // // // // //       padding: "8px 16px",
// // // // // //       borderRadius: 10,
// // // // // //       border: "2px solid #d4af37",
// // // // // //       cursor: "pointer",
// // // // // //       background: active ? "#d4af37" : "#fff",
// // // // // //       color: active ? "#fff" : "#b8860b",
// // // // // //       fontWeight: 600,
// // // // // //     }),
// // // // // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // // // // //   };

// // // // // //   return (
// // // // // //     <div style={styles.page}>
// // // // // //       <div style={styles.header}>
// // // // // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // // // // //       </div>

// // // // // //       <div style={styles.tabs}>
// // // // // //         {tabs.map((t) => (
// // // // // //           <button
// // // // // //             key={t.key}
// // // // // //             onClick={() => setActiveTab(t.key)}
// // // // // //             style={styles.tabBtn(activeTab === t.key)}
// // // // // //           >
// // // // // //             {t.label}
// // // // // //           </button>
// // // // // //         ))}
// // // // // //       </div>

// // // // // //       <div style={styles.container}>
// // // // // //         {loading ? (
// // // // // //           <p>Loading...</p>
// // // // // //         ) : (
// // // // // //           <>
// // // // // //             {activeTab === "orders" && <div>üì¶ Orders Section</div>}
// // // // // //             {activeTab === "menu" && <div>üçî Menu Items Section</div>}
// // // // // //             {activeTab === "categories" && <div>üìÅ Categories Section</div>}
// // // // // //             {activeTab === "staff" && <div>üë©‚Äçüç≥ Staff Section</div>}
// // // // // //             {activeTab === "tables" && <div>ü™ë Tables Section</div>}
// // // // // //           </>
// // // // // //         )}
// // // // // //       </div>
// // // // // //     </div>
// // // // // //   );
// // // // // // }
// // // // // // import React, { useEffect, useState } from "react";
// // // // // // import api from "../services/api";
// // // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // // export default function AdminPanel() {
// // // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // // //   const [categories, setCategories] = useState([]);
// // // // // //   const [tables, setTables] = useState([]);
// // // // // //   const [orders, setOrders] = useState([]);
// // // // // //   const [staff, setStaff] = useState([]);
// // // // // //   const [items, setItems] = useState([]);
// // // // // //   const [loading, setLoading] = useState(true);
// // // // // //   const token = localStorage.getItem("token");

// // // // // //   useEffect(() => {
// // // // // //     const fetchData = async () => {
// // // // // //       try {
// // // // // //         const headers = { Authorization: `Bearer ${token}` };

// // // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // // //           api.get("/menu/categories", { headers }),
// // // // // //           api.get("/tables", { headers }),
// // // // // //           api.get("/orders", { headers }),
// // // // // //           api.get("/auth/staff", { headers }),
// // // // // //           api.get("/menu/items", { headers }),
// // // // // //         ]);

// // // // // //         console.log("üßæ Orders Response:", orderRes.data);

// // // // // //         // ‚úÖ Safe parsing for all data types
// // // // // //         setCategories(
// // // // // //           catRes.data.categories || catRes.data.data || catRes.data || []
// // // // // //         );
// // // // // //         setTables(
// // // // // //           tableRes.data.tables || tableRes.data.data || tableRes.data || []
// // // // // //         );
// // // // // //         setOrders(
// // // // // //           orderRes.data.orders || orderRes.data.data || orderRes.data || []
// // // // // //         );
// // // // // //         setStaff(staffRes.data.staff || staffRes.data.data || staffRes.data || []);
// // // // // //         setItems(menuRes.data.items || menuRes.data.data || menuRes.data || []);
// // // // // //       } catch (err) {
// // // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // // //       } finally {
// // // // // //         setLoading(false);
// // // // // //       }
// // // // // //     };

// // // // // //     fetchData();
// // // // // //   }, [token]);

// // // // // //   if (loading) {
// // // // // //     return (
// // // // // //       <div style={loadingContainer}>
// // // // // //         <div style={spinner}></div>
// // // // // //         <p>Loading Admin Panel...</p>
// // // // // //       </div>
// // // // // //     );
// // // // // //   }

// // // // // //   /* ========== RENDER SECTIONS ========== */

// // // // // //   const renderOrders = () => (
// // // // // //     <div>
// // // // // //       <h2 style={sectionTitle}>üßæ Current Orders</h2>
// // // // // //       {!Array.isArray(orders) || orders.length === 0 ? (
// // // // // //         <p style={emptyText}>No active orders yet.</p>
// // // // // //       ) : (
// // // // // //         orders.map((o) => (
// // // // // //           <div key={o._id} style={miniCard}>
// // // // // //             <div style={cardHeader}>
// // // // // //               <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // // //                 Table #{o.tableId?.number || o.table?.number || "N/A"}
// // // // // //               </h3>
// // // // // //               <span
// // // // // //                 style={{
// // // // // //                   backgroundColor:
// // // // // //                     o.status === "served"
// // // // // //                       ? "#e6ffe6"
// // // // // //                       : o.status === "preparing"
// // // // // //                       ? "#fff4cc"
// // // // // //                       : "#f0f0f0",
// // // // // //                   color:
// // // // // //                     o.status === "served"
// // // // // //                       ? "#006600"
// // // // // //                       : o.status === "preparing"
// // // // // //                       ? "#8b7500"
// // // // // //                       : "#555",
// // // // // //                   padding: "3px 10px",
// // // // // //                   borderRadius: "8px",
// // // // // //                   fontSize: "12px",
// // // // // //                   border: "1px solid #d4af37",
// // // // // //                 }}
// // // // // //               >
// // // // // //                 {o.status}
// // // // // //               </span>
// // // // // //             </div>

// // // // // //             <ul style={{ paddingLeft: "20px", marginTop: "8px" }}>
// // // // // //               {o.items?.map((item, idx) => (
// // // // // //                 <li key={idx}>
// // // // // //                   {item.name || item.menuItemId?.name} √ó {item.qty} ‚Äî ‚Çπ
// // // // // //                   {item.price || item.menuItemId?.price || 0}
// // // // // //                 </li>
// // // // // //               ))}
// // // // // //             </ul>

// // // // // //             <p style={{ fontWeight: 600, marginTop: "8px", color: "#b8860b" }}>
// // // // // //               Total: ‚Çπ
// // // // // //               {o.items?.reduce(
// // // // // //                 (sum, i) => sum + (i.qty * (i.price || i.menuItemId?.price || 0)),
// // // // // //                 0
// // // // // //               )}
// // // // // //             </p>
// // // // // //           </div>
// // // // // //         ))
// // // // // //       )}
// // // // // //     </div>
// // // // // //   );

// // // // // //   const renderMenuItems = () => (
// // // // // //     <div>
// // // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // // //       {items.length === 0 ? (
// // // // // //         <p style={emptyText}>No menu items added yet.</p>
// // // // // //       ) : (
// // // // // //         items.map((i) => (
// // // // // //           <div key={i._id} style={miniCard}>
// // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{i.name}</h3>
// // // // // //             <p style={{ fontSize: "13px" }}>‚Çπ{i.price}</p>
// // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // //               {i.availability ? "‚úÖ Available" : "‚ùå Not Available"}
// // // // // //             </p>
// // // // // //           </div>
// // // // // //         ))
// // // // // //       )}
// // // // // //     </div>
// // // // // //   );

// // // // // //   const renderCategories = () => (
// // // // // //     <div>
// // // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // // //       {!Array.isArray(categories) || categories.length === 0 ? (
// // // // // //         <p style={emptyText}>No categories added yet.</p>
// // // // // //       ) : (
// // // // // //         <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // // //           {categories.map((c) => (
// // // // // //             <span
// // // // // //               key={c._id}
// // // // // //               style={{
// // // // // //                 backgroundColor: "#fff8dc",
// // // // // //                 color: "#b8860b",
// // // // // //                 padding: "6px 12px",
// // // // // //                 borderRadius: "20px",
// // // // // //                 border: "1px solid #d4af37",
// // // // // //               }}
// // // // // //             >
// // // // // //               {c.name}
// // // // // //             </span>
// // // // // //           ))}
// // // // // //         </div>
// // // // // //       )}
// // // // // //     </div>
// // // // // //   );

// // // // // //   const renderStaff = () => (
// // // // // //     <div>
// // // // // //       <h2 style={sectionTitle}>üë®‚Äçüç≥ Staff Members</h2>
// // // // // //       {staff.length === 0 ? (
// // // // // //         <p style={emptyText}>No staff registered.</p>
// // // // // //       ) : (
// // // // // //         staff.map((s) => (
// // // // // //           <div key={s._id} style={miniCard}>
// // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>{s.name}</h3>
// // // // // //             <p style={{ fontSize: "13px" }}>{s.email}</p>
// // // // // //             <p style={{ fontSize: "12px", color: "#888" }}>
// // // // // //               Role: {s.role || "Staff"}
// // // // // //             </p>
// // // // // //           </div>
// // // // // //         ))
// // // // // //       )}
// // // // // //     </div>
// // // // // //   );

// // // // // //   const renderTables = () => (
// // // // // //     <div>
// // // // // //       <h2 style={sectionTitle}>ü™ë Tables</h2>
// // // // // //       {tables.length === 0 ? (
// // // // // //         <p style={emptyText}>No tables found.</p>
// // // // // //       ) : (
// // // // // //         tables.map((t) => (
// // // // // //           <div key={t._id} style={miniCard}>
// // // // // //             <h3 style={{ margin: 0, color: "#b8860b" }}>Table #{t.number}</h3>
// // // // // //             <div style={{ marginTop: "10px", textAlign: "center" }}>
// // // // // //               <QRCodeCanvas
// // // // // //                 value={`${window.location.origin}/menu/${t.qrSlug}`}
// // // // // //                 size={80}
// // // // // //                 bgColor="#fff"
// // // // // //                 fgColor="#000"
// // // // // //               />
// // // // // //               <p style={{ fontSize: "12px", color: "#777", marginTop: "5px" }}>
// // // // // //                 Slug: {t.qrSlug}
// // // // // //               </p>
// // // // // //             </div>
// // // // // //           </div>
// // // // // //         ))
// // // // // //       )}
// // // // // //     </div>
// // // // // //   );

// // // // // //   /* ========== MAIN RETURN ========== */

// // // // // //   return (
// // // // // //     <div style={mainContainer}>
// // // // // //       <header style={{ textAlign: "center", marginBottom: "30px" }}>
// // // // // //         <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>
// // // // // //       </header>

// // // // // //       <div style={tabContainer}>
// // // // // //         {[
// // // // // //           { key: "orders", label: "Orders" },
// // // // // //           { key: "menu", label: "Menu Items" },
// // // // // //           { key: "categories", label: "Categories" },
// // // // // //           { key: "staff", label: "Staff" },
// // // // // //           { key: "tables", label: "Tables" },
// // // // // //         ].map((tab) => (
// // // // // //           <button
// // // // // //             key={tab.key}
// // // // // //             onClick={() => setActiveTab(tab.key)}
// // // // // //             style={{
// // // // // //               ...tabButton,
// // // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // // //             }}
// // // // // //           >
// // // // // //             {tab.label}
// // // // // //           </button>
// // // // // //         ))}
// // // // // //       </div>

// // // // // //       <div style={contentCard}>
// // // // // //         {activeTab === "orders" && renderOrders()}
// // // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // // //         {activeTab === "categories" && renderCategories()}
// // // // // //         {activeTab === "staff" && renderStaff()}
// // // // // //         {activeTab === "tables" && renderTables()}
// // // // // //       </div>
// // // // // //     </div>
// // // // // //   );
// // // // // // }

// // // // // // /* ---- Styles ---- */
// // // // // // const mainContainer = {
// // // // // //   minHeight: "100vh",
// // // // // //   background: "linear-gradient(180deg, #fffdf8, #fdf6e3)",
// // // // // //   padding: "40px 20px",
// // // // // //   fontFamily: "Poppins, sans-serif",
// // // // // // };

// // // // // // const tabContainer = {
// // // // // //   display: "flex",
// // // // // //   justifyContent: "center",
// // // // // //   flexWrap: "wrap",
// // // // // //   gap: "10px",
// // // // // //   marginBottom: "25px",
// // // // // // };

// // // // // // const tabButton = {
// // // // // //   padding: "8px 16px",
// // // // // //   border: "1px solid #d4af37",
// // // // // //   borderRadius: "20px",
// // // // // //   cursor: "pointer",
// // // // // //   fontWeight: "600",
// // // // // //   fontSize: "14px",
// // // // // //   transition: "0.3s",
// // // // // // };

// // // // // // const contentCard = {
// // // // // //   backgroundColor: "#ffffff",
// // // // // //   borderRadius: "15px",
// // // // // //   padding: "25px",
// // // // // //   boxShadow: "0 4px 10px rgba(212,175,55,0.15)",
// // // // // //   maxWidth: "900px",
// // // // // //   margin: "0 auto",
// // // // // // };

// // // // // // const loadingContainer = {
// // // // // //   height: "100vh",
// // // // // //   display: "flex",
// // // // // //   flexDirection: "column",
// // // // // //   alignItems: "center",
// // // // // //   justifyContent: "center",
// // // // // //   backgroundColor: "#fffaf0",
// // // // // //   color: "#b7950b",
// // // // // // };

// // // // // // const spinner = {
// // // // // //   width: "40px",
// // // // // //   height: "40px",
// // // // // //   border: "4px solid #f2e1a3",
// // // // // //   borderTopColor: "#d4af37",
// // // // // //   borderRadius: "50%",
// // // // // //   animation: "spin 1s linear infinite",
// // // // // // };

// // // // // // const title = {
// // // // // //   color: "#b8860b",
// // // // // //   fontSize: "2.2rem",
// // // // // //   fontWeight: "700",
// // // // // // };

// // // // // // const sectionTitle = {
// // // // // //   fontSize: "18px",
// // // // // //   color: "#8b7500",
// // // // // //   marginBottom: "15px",
// // // // // //   borderBottom: "1px solid #f0e6b2",
// // // // // //   paddingBottom: "8px",
// // // // // //   fontWeight: "600",
// // // // // // };

// // // // // // const emptyText = {
// // // // // //   color: "#b8a000",
// // // // // //   fontSize: "14px",
// // // // // //   fontStyle: "italic",
// // // // // // };

// // // // // // const miniCard = {
// // // // // //   backgroundColor: "#fffaf0",
// // // // // //   borderRadius: "10px",
// // // // // //   padding: "10px 15px",
// // // // // //   marginBottom: "10px",
// // // // // //   border: "1px solid #f3e6b0",
// // // // // // };

// // // // // // const cardHeader = {
// // // // // //   display: "flex",
// // // // // //   justifyContent: "space-between",
// // // // // //   alignItems: "center",
// // // // // // };
// // // // // import React, { useEffect, useState } from "react";
// // // // // import api from "../services/api";
// // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // export default function AdminPanel() {
// // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // //   const [categories, setCategories] = useState([]);
// // // // //   const [tables, setTables] = useState([]);
// // // // //   const [orders, setOrders] = useState([]);
// // // // //   const [staff, setStaff] = useState([]);
// // // // //   const [items, setItems] = useState([]);
// // // // //   const [loading, setLoading] = useState(true);
// // // // //   const [newData, setNewData] = useState({});
// // // // //   const token = localStorage.getItem("token");

// // // // //   const headers = { Authorization: `Bearer ${token}` };

// // // // //   // ‚úÖ Fetch all data once
// // // // //   useEffect(() => {
// // // // //     const fetchData = async () => {
// // // // //       try {
// // // // //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.all([
// // // // //           api.get("/menu/categories", { headers }),
// // // // //           api.get("/tables", { headers }),
// // // // //           api.get("/orders", { headers }),
// // // // //           api.get("/auth/staff", { headers }),
// // // // //           api.get("/menu/items", { headers }),
// // // // //         ]);

// // // // //         setCategories(catRes.data.categories || []);
// // // // //         setTables(tableRes.data.tables || []);
// // // // //         setOrders(orderRes.data.orders || []);
// // // // //         setStaff(staffRes.data.staff || []);
// // // // //         setItems(menuRes.data.items || []);
// // // // //       } catch (err) {
// // // // //         console.error("‚ùå Error loading admin data:", err);
// // // // //       } finally {
// // // // //         setLoading(false);
// // // // //       }
// // // // //     };

// // // // //     fetchData();
// // // // //   }, []);

// // // // //   // ‚úÖ Generic Add Handler
// // // // //   const handleAdd = async (type) => {
// // // // //     try {
// // // // //       if (!newData[type]) return alert("Please fill data!");

// // // // //       let res;
// // // // //       if (type === "category")
// // // // //         res = await api.post("/menu/categories", { name: newData[type] }, { headers });
// // // // //       else if (type === "item")
// // // // //         res = await api.post("/menu/items", newData[type], { headers });
// // // // //       else if (type === "table")
// // // // //         res = await api.post("/tables", newData[type], { headers });
// // // // //       else if (type === "staff")
// // // // //         res = await api.post("/auth/register-staff", newData[type], { headers });

// // // // //       alert("‚úÖ Added successfully!");
// // // // //       window.location.reload();
// // // // //     } catch (err) {
// // // // //       console.error("‚ùå Error adding:", err);
// // // // //       alert("Error adding " + type);
// // // // //     }
// // // // //   };

// // // // //   // ‚úÖ Generic Delete Handler
// // // // //   const handleDelete = async (type, id) => {
// // // // //     if (!window.confirm("Are you sure?")) return;
// // // // //     try {
// // // // //       let endpoint = "";
// // // // //       if (type === "category") endpoint = `/menu/categories/${id}`;
// // // // //       else if (type === "item") endpoint = `/menu/items/${id}`;
// // // // //       else if (type === "table") endpoint = `/tables/${id}`;
// // // // //       else if (type === "staff") endpoint = `/auth/staff/${id}`;

// // // // //       await api.delete(endpoint, { headers });
// // // // //       alert("üóëÔ∏è Deleted successfully!");
// // // // //       window.location.reload();
// // // // //     } catch (err) {
// // // // //       console.error("‚ùå Delete failed:", err);
// // // // //     }
// // // // //   };

// // // // //   // üßæ Renderers
// // // // //   const renderOrders = () => (
// // // // //     <div>
// // // // //       <h2 style={sectionTitle}>üßæ Current Orders</h2>
// // // // //       {!orders.length ? (
// // // // //         <p style={emptyText}>No active orders yet.</p>
// // // // //       ) : (
// // // // //         orders.map((o) => (
// // // // //           <div key={o._id} style={miniCard}>
// // // // //             <div style={cardHeader}>
// // // // //               <h3 style={{ margin: 0, color: "#b8860b" }}>
// // // // //                 Table #{o.tableId?.number || o.table?.number || "N/A"}
// // // // //               </h3>
// // // // //               <span>{o.status}</span>
// // // // //             </div>
// // // // //             <ul style={{ paddingLeft: "20px", marginTop: "8px" }}>
// // // // //               {o.items?.map((item, idx) => (
// // // // //                 <li key={idx}>
// // // // //                   {item.name || item.menuItemId?.name} √ó {item.qty}
// // // // //                 </li>
// // // // //               ))}
// // // // //             </ul>
// // // // //           </div>
// // // // //         ))
// // // // //       )}
// // // // //     </div>
// // // // //   );

// // // // //   const renderCategories = () => (
// // // // //     <div>
// // // // //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// // // // //       <div style={{ marginBottom: "10px" }}>
// // // // //         <input
// // // // //           type="text"
// // // // //           placeholder="New Category Name"
// // // // //           onChange={(e) => setNewData({ ...newData, category: e.target.value })}
// // // // //           style={inputStyle}
// // // // //         />
// // // // //         <button onClick={() => handleAdd("category")} style={addBtn}>
// // // // //           ‚ûï Add
// // // // //         </button>
// // // // //       </div>

// // // // //       {!categories.length ? (
// // // // //         <p style={emptyText}>No categories yet.</p>
// // // // //       ) : (
// // // // //         categories.map((c) => (
// // // // //           <div key={c._id} style={miniCard}>
// // // // //             <span>{c.name}</span>
// // // // //             <button onClick={() => handleDelete("category", c._id)} style={delBtn}>
// // // // //               ‚ùå
// // // // //             </button>
// // // // //           </div>
// // // // //         ))
// // // // //       )}
// // // // //     </div>
// // // // //   );

// // // // //   const renderMenuItems = () => (
// // // // //     <div>
// // // // //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// // // // //       <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // //         <input
// // // // //           placeholder="Item name"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               item: { ...newData.item, name: e.target.value },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <input
// // // // //           placeholder="Price"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               item: { ...newData.item, price: Number(e.target.value) },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <button onClick={() => handleAdd("item")} style={addBtn}>
// // // // //           ‚ûï Add
// // // // //         </button>
// // // // //       </div>

// // // // //       {!items.length ? (
// // // // //         <p style={emptyText}>No menu items yet.</p>
// // // // //       ) : (
// // // // //         items.map((i) => (
// // // // //           <div key={i._id} style={miniCard}>
// // // // //             <span>
// // // // //               {i.name} ‚Äî ‚Çπ{i.price}
// // // // //             </span>
// // // // //             <button onClick={() => handleDelete("item", i._id)} style={delBtn}>
// // // // //               ‚ùå
// // // // //             </button>
// // // // //           </div>
// // // // //         ))
// // // // //       )}
// // // // //     </div>
// // // // //   );

// // // // //   const renderTables = () => (
// // // // //     <div>
// // // // //       <h2 style={sectionTitle}>ü™ë Tables</h2>
// // // // //       <div style={{ marginBottom: "10px" }}>
// // // // //         <input
// // // // //           type="number"
// // // // //           placeholder="Table Number"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               table: { number: e.target.value },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <button onClick={() => handleAdd("table")} style={addBtn}>
// // // // //           ‚ûï Add
// // // // //         </button>
// // // // //       </div>

// // // // //       {!tables.length ? (
// // // // //         <p style={emptyText}>No tables found.</p>
// // // // //       ) : (
// // // // //         tables.map((t) => (
// // // // //           <div key={t._id} style={miniCard}>
// // // // //             <h3>Table #{t.number}</h3>
// // // // //             <QRCodeCanvas value={`${window.location.origin}/menu/${t.qrSlug}`} size={60} />
// // // // //             <button onClick={() => handleDelete("table", t._id)} style={delBtn}>
// // // // //               ‚ùå
// // // // //             </button>
// // // // //           </div>
// // // // //         ))
// // // // //       )}
// // // // //     </div>
// // // // //   );

// // // // //   const renderStaff = () => (
// // // // //     <div>
// // // // //       <h2 style={sectionTitle}>üë®‚Äçüç≥ Staff</h2>
// // // // //       <div style={{ display: "flex", flexWrap: "wrap", gap: "8px" }}>
// // // // //         <input
// // // // //           placeholder="Name"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               staff: { ...newData.staff, name: e.target.value },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <input
// // // // //           placeholder="Email"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               staff: { ...newData.staff, email: e.target.value },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <input
// // // // //           placeholder="Password"
// // // // //           style={inputStyle}
// // // // //           onChange={(e) =>
// // // // //             setNewData({
// // // // //               ...newData,
// // // // //               staff: { ...newData.staff, password: e.target.value },
// // // // //             })
// // // // //           }
// // // // //         />
// // // // //         <button onClick={() => handleAdd("staff")} style={addBtn}>
// // // // //           ‚ûï Add
// // // // //         </button>
// // // // //       </div>

// // // // //       {!staff.length ? (
// // // // //         <p style={emptyText}>No staff found.</p>
// // // // //       ) : (
// // // // //         staff.map((s) => (
// // // // //           <div key={s._id} style={miniCard}>
// // // // //             <span>{s.name} ({s.role})</span>
// // // // //             <button onClick={() => handleDelete("staff", s._id)} style={delBtn}>
// // // // //               ‚ùå
// // // // //             </button>
// // // // //           </div>
// // // // //         ))
// // // // //       )}
// // // // //     </div>
// // // // //   );

// // // // //   if (loading) return <p>Loading...</p>;

// // // // //   return (
// // // // //     <div style={mainContainer}>
// // // // //       <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>

// // // // //       <div style={tabContainer}>
// // // // //         {[
// // // // //           { key: "orders", label: "Orders" },
// // // // //           { key: "menu", label: "Menu" },
// // // // //           { key: "categories", label: "Categories" },
// // // // //           { key: "staff", label: "Staff" },
// // // // //           { key: "tables", label: "Tables" },
// // // // //         ].map((tab) => (
// // // // //           <button
// // // // //             key={tab.key}
// // // // //             onClick={() => setActiveTab(tab.key)}
// // // // //             style={{
// // // // //               ...tabButton,
// // // // //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// // // // //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// // // // //             }}
// // // // //           >
// // // // //             {tab.label}
// // // // //           </button>
// // // // //         ))}
// // // // //       </div>

// // // // //       <div style={contentCard}>
// // // // //         {activeTab === "orders" && renderOrders()}
// // // // //         {activeTab === "menu" && renderMenuItems()}
// // // // //         {activeTab === "categories" && renderCategories()}
// // // // //         {activeTab === "staff" && renderStaff()}
// // // // //         {activeTab === "tables" && renderTables()}
// // // // //       </div>
// // // // //     </div>
// // // // //   );
// // // // // }

// // // // // /* ---- Styles ---- */
// // // // // const mainContainer = {
// // // // //   minHeight: "100vh",
// // // // //   background: "linear-gradient(180deg, #fffdf8, #fdf6e3)",
// // // // //   padding: "40px 20px",
// // // // //   fontFamily: "Poppins, sans-serif",
// // // // // };

// // // // // const inputStyle = {
// // // // //   padding: "6px 10px",
// // // // //   borderRadius: "8px",
// // // // //   border: "1px solid #d4af37",
// // // // //   fontSize: "14px",
// // // // // };

// // // // // const addBtn = {
// // // // //   padding: "6px 10px",
// // // // //   background: "#b8860b",
// // // // //   color: "#fff",
// // // // //   border: "none",
// // // // //   borderRadius: "8px",
// // // // //   cursor: "pointer",
// // // // // };

// // // // // const delBtn = {
// // // // //   background: "transparent",
// // // // //   border: "none",
// // // // //   cursor: "pointer",
// // // // //   color: "#b00000",
// // // // //   fontSize: "18px",
// // // // // };

// // // // // const tabContainer = {
// // // // //   display: "flex",
// // // // //   justifyContent: "center",
// // // // //   flexWrap: "wrap",
// // // // //   gap: "10px",
// // // // //   marginBottom: "25px",
// // // // // };

// // // // // const tabButton = {
// // // // //   padding: "8px 16px",
// // // // //   border: "1px solid #d4af37",
// // // // //   borderRadius: "20px",
// // // // //   cursor: "pointer",
// // // // //   fontWeight: "600",
// // // // //   fontSize: "14px",
// // // // //   transition: "0.3s",
// // // // // };

// // // // // const contentCard = {
// // // // //   backgroundColor: "#ffffff",
// // // // //   borderRadius: "15px",
// // // // //   padding: "25px",
// // // // //   boxShadow: "0 4px 10px rgba(212,175,55,0.15)",
// // // // //   maxWidth: "900px",
// // // // //   margin: "0 auto",
// // // // // };

// // // // // const sectionTitle = {
// // // // //   fontSize: "18px",
// // // // //   color: "#8b7500",
// // // // //   marginBottom: "15px",
// // // // //   borderBottom: "1px solid #f0e6b2",
// // // // //   paddingBottom: "8px",
// // // // //   fontWeight: "600",
// // // // // };

// // // // // const emptyText = {
// // // // //   color: "#b8a000",
// // // // //   fontSize: "14px",
// // // // //   fontStyle: "italic",
// // // // // };

// // // // // const miniCard = {
// // // // //   display: "flex",
// // // // //   justifyContent: "space-between",
// // // // //   alignItems: "center",
// // // // //   backgroundColor: "#fffaf0",
// // // // //   borderRadius: "10px",
// // // // //   padding: "10px 15px",
// // // // //   marginBottom: "10px",
// // // // //   border: "1px solid #f3e6b0",
// // // // // };

// // // // // const title = {
// // // // //   color: "#b8860b",
// // // // //   fontSize: "2.2rem",
// // // // //   fontWeight: "700",
// // // // // };
// // // // import React, { useEffect, useState } from "react";
// // // // // import axios from "axios";
// // // // // import { useNavigate } from "react-router-dom";
// // // // // import { QRCodeCanvas } from "qrcode.react";

// // // // // const BASE = "http://localhost:4000"; // ‚úÖ Backend URL

// // // // // // Axios instance with token interceptor
// // // // // const api = axios.create({
// // // // //   baseURL: BASE,
// // // // //   headers: { "Content-Type": "application/json" },
// // // // // });

// // // // // api.interceptors.request.use((cfg) => {
// // // // //   const token = localStorage.getItem("token");
// // // // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // // // //   return cfg;
// // // // // });

// // // // // export default function AdminPanel() {
// // // // //   const navigate = useNavigate();

// // // // //   const [activeTab, setActiveTab] = useState("orders");
// // // // //   const [loading, setLoading] = useState(true);

// // // // //   // Data states
// // // // //   const [orders, setOrders] = useState([]);
// // // // //   const [menuItems, setMenuItems] = useState([]);
// // // // //   const [categories, setCategories] = useState([]);
// // // // //   const [staff, setStaff] = useState([]);
// // // // //   const [tables, setTables] = useState([]);

// // // // //   // Form states
// // // // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // // //   const [uploading, setUploading] = useState(false);

// // // // //   // ‚úÖ Auth check
// // // // //   useEffect(() => {
// // // // //     const token = localStorage.getItem("token");
// // // // //     const user = JSON.parse(localStorage.getItem("user") || "{}");

// // // // //     // If no token or wrong role ‚Üí redirect
// // // // //     if (!token || user.role !== "admin") {
// // // // //       alert("Unauthorized access. Please login as admin.");
// // // // //       localStorage.removeItem("token");
// // // // //       localStorage.removeItem("user");
// // // // //       navigate("/login");
// // // // //       return;
// // // // //     }

// // // // //     // Optional token verification call (ignore if backend lacks /protected-test)
// // // // //     (async () => {
// // // // //       try {
// // // // //         await api.get("/api/protected-test");
// // // // //       } catch (err) {
// // // // //         console.warn("Token check failed:", err);
// // // // //         alert("Session expired. Please login again.");
// // // // //         localStorage.removeItem("token");
// // // // //         localStorage.removeItem("user");
// // // // //         navigate("/login");
// // // // //       }
// // // // //     })();
// // // // //   }, [navigate]);

// // // // //   // Fetch all data after login
// // // // //   useEffect(() => {
// // // // //     const fetchAll = async () => {
// // // // //       try {
// // // // //         setLoading(true);
// // // // //         await Promise.allSettled([
// // // // //           fetchOrders(),
// // // // //           fetchMenuItems(),
// // // // //           fetchCategories(),
// // // // //           fetchStaff(),
// // // // //           fetchTables(),
// // // // //         ]);
// // // // //       } finally {
// // // // //         setLoading(false);
// // // // //       }
// // // // //     };
// // // // //     fetchAll();
// // // // //   }, []);

// // // // //   /* ==================== Fetch Functions ==================== */
// // // // //   const fetchOrders = async () => {
// // // // //     try {
// // // // //       const res = await api.get("/api/orders");
// // // // //       setOrders(res.data.orders || []);
// // // // //     } catch (err) {
// // // // //       console.error("fetchOrders error:", err);
// // // // //       setOrders([]);
// // // // //     }
// // // // //   };

// // // // //   const fetchMenuItems = async () => {
// // // // //     try {
// // // // //       const res = await api.get("/api/menu/items");
// // // // //       setMenuItems(res.data.items || []);
// // // // //     } catch (err) {
// // // // //       console.error("fetchMenuItems error:", err);
// // // // //       setMenuItems([]);
// // // // //     }
// // // // //   };

// // // // //   const fetchCategories = async () => {
// // // // //     try {
// // // // //       const res = await api.get("/api/menu/categories");
// // // // //       setCategories(res.data.categories || []);
// // // // //     } catch (err) {
// // // // //       console.error("fetchCategories error:", err);
// // // // //       setCategories([]);
// // // // //     }
// // // // //   };

// // // // //   const fetchStaff = async () => {
// // // // //     try {
// // // // //       const res = await api.get("/api/staff");
// // // // //       setStaff(res.data.staff || []);
// // // // //     } catch (err) {
// // // // //       console.error("fetchStaff error:", err);
// // // // //       setStaff([]);
// // // // //     }
// // // // //   };

// // // // //   const fetchTables = async () => {
// // // // //     try {
// // // // //       const res = await api.get("/api/tables");
// // // // //       setTables(res.data.tables || []);
// // // // //     } catch (err) {
// // // // //       console.error("fetchTables error:", err);
// // // // //       setTables([]);
// // // // //     }
// // // // //   };

// // // // //   /* ==================== Add/Delete Functions ==================== */
// // // // //   const handleAddStaff = async (e) => {
// // // // //     e.preventDefault();
// // // // //     try {
// // // // //       const res = await api.post("/api/staff", newStaff);
// // // // //       if (res.data.success) {
// // // // //         alert("‚úÖ Staff added!");
// // // // //         await fetchStaff();
// // // // //         setNewStaff({ name: "", role: "", phone: "", email: "" });
// // // // //       }
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //       alert("Error adding staff");
// // // // //     }
// // // // //   };

// // // // //   const handleDeleteStaff = async (id) => {
// // // // //     if (!window.confirm("Delete staff?")) return;
// // // // //     try {
// // // // //       await api.delete(`/api/staff/${id}`);
// // // // //       await fetchStaff();
// // // // //       alert("Staff deleted ‚úÖ");
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //       alert("Failed to delete staff");
// // // // //     }
// // // // //   };

// // // // //   const handleAddCategory = async () => {
// // // // //     try {
// // // // //       const form = new FormData();
// // // // //       form.append("name", newCategory.name);
// // // // //       if (newCategory.image) form.append("image", newCategory.image);

// // // // //       setUploading(true);
// // // // //       const res = await api.post("/api/menu/categories", form, {
// // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // //       });
// // // // //       if (res.data.success) {
// // // // //         alert("‚úÖ Category added!");
// // // // //         await fetchCategories();
// // // // //         setNewCategory({ name: "", image: null });
// // // // //       }
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //     } finally {
// // // // //       setUploading(false);
// // // // //     }
// // // // //   };

// // // // //   const handleAddMenuItem = async () => {
// // // // //     try {
// // // // //       const form = new FormData();
// // // // //       form.append("name", newItem.name);
// // // // //       form.append("price", newItem.price);
// // // // //       form.append("categoryId", newItem.categoryId || "");
// // // // //       if (newItem.image) form.append("image", newItem.image);

// // // // //       setUploading(true);
// // // // //       const res = await api.post("/api/menu/items", form, {
// // // // //         headers: { "Content-Type": "multipart/form-data" },
// // // // //       });
// // // // //       if (res.data.success) {
// // // // //         alert("‚úÖ Menu item added!");
// // // // //         await fetchMenuItems();
// // // // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // // //       }
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //     } finally {
// // // // //       setUploading(false);
// // // // //     }
// // // // //   };

// // // // //   const handleDeleteMenuItem = async (id) => {
// // // // //     if (!window.confirm("Delete this item?")) return;
// // // // //     try {
// // // // //       await api.delete(`/api/menu/items/${id}`);
// // // // //       await fetchMenuItems();
// // // // //       alert("Menu item deleted ‚úÖ");
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //       alert("Failed to delete menu item");
// // // // //     }
// // // // //   };

// // // // //   const handleDeleteTable = async (id) => {
// // // // //     if (!window.confirm("Delete this table?")) return;
// // // // //     try {
// // // // //       await api.delete(`/api/tables/${id}`);
// // // // //       await fetchTables();
// // // // //       alert("Table deleted ‚úÖ");
// // // // //     } catch (err) {
// // // // //       console.error(err);
// // // // //       alert("Failed to delete table");
// // // // //     }
// // // // //   };

// // // // //   /* ==================== UI Layout ==================== */
// // // // //   const tabs = [
// // // // //     { key: "orders", label: "Orders" },
// // // // //     { key: "menu", label: "Menu" },
// // // // //     { key: "categories", label: "Categories" },
// // // // //     { key: "staff", label: "Staff" },
// // // // //     { key: "tables", label: "Tables" },
// // // // //   ];

// // // // //   const styles = {
// // // // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // // // //     header: { textAlign: "center", marginBottom: 20 },
// // // // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // // // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // // // //     tabBtn: (active) => ({
// // // // //       padding: "8px 16px",
// // // // //       borderRadius: 10,
// // // // //       border: "2px solid #d4af37",
// // // // //       cursor: "pointer",
// // // // //       background: active ? "#d4af37" : "#fff",
// // // // //       color: active ? "#fff" : "#b8860b",
// // // // //       fontWeight: 600,
// // // // //     }),
// // // // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // // // //   };

// // // // //   return (
// // // // //     <div style={styles.page}>
// // // // //       <div style={styles.header}>
// // // // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // // // //       </div>

// // // // //       <div style={styles.tabs}>
// // // // //         {tabs.map((t) => (
// // // // //           <button
// // // // //             key={t.key}
// // // // //             onClick={() => setActiveTab(t.key)}
// // // // //             style={styles.tabBtn(activeTab === t.key)}
// // // // //           >
// // // // //             {t.label}
// // // // //           </button>
// // // // //         ))}
// // // // //       </div>

// // // // //       <div style={styles.container}>
// // // // //         {loading ? (
// // // // //           <p>Loading...</p>
// // // // //         ) : (
// // // // //           <>
// // // // //             {activeTab === "orders" && <div>üì¶ Orders Section</div>}
// // // // //             {activeTab === "menu" && <div>üçî Menu Items Section</div>}
// // // // //             {activeTab === "categories" && <div>üìÅ Categories Section</div>}
// // // // //             {activeTab === "staff" && <div>üë©‚Äçüç≥ Staff Section</div>}
// // // // //             {activeTab === "tables" && <div>ü™ë Tables Section</div>}
// // // // //           </>
// // // // //         )}
// // // // //       </div>
// // // // //     </div>
// // // // //   );
// // // // // }
// // // // // import React, { useEffect, useState } from "react";
// // // // // import axios from "axios";
// // // // // import { useNavigate } from "react-router-dom";
// // // // // import { QRCodeCanvas } from "qrcode.react";
// // // // import React, { useEffect, useState } from "react";
// // // // import axios from "axios";
// // // // import { useNavigate } from "react-router-dom";
// // // // import { QRCodeCanvas } from "qrcode.react";


// // // // const BASE = "http://localhost:4000"; // ‚úÖ your backend server IP

// // // // // Axios instance with token interceptor
// // // // const api = axios.create({
// // // //   baseURL: BASE,
// // // //   headers: { "Content-Type": "application/json" },
// // // // });

// // // // api.interceptors.request.use((cfg) => {
// // // //   const token = localStorage.getItem("token");
// // // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // // //   return cfg;
// // // // });

// // // // export default function AdminPanel() {
// // // //   const navigate = useNavigate();
// // // //   const [activeTab, setActiveTab] = useState("orders");
// // // //   const [loading, setLoading] = useState(true);

// // // //   // Data states
// // // //   const [orders, setOrders] = useState([]);
// // // //   const [menuItems, setMenuItems] = useState([]);
// // // //   const [categories, setCategories] = useState([]);
// // // //   const [staff, setStaff] = useState([]);
// // // //   const [tables, setTables] = useState([]);

// // // //   // Form states
// // // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // // //   const [uploading, setUploading] = useState(false);

// // // //   // ‚úÖ Auth check
// // // //   useEffect(() => {
// // // //     const token = localStorage.getItem("token");
// // // //     const user = JSON.parse(localStorage.getItem("user") || "{}");

// // // //     if (!token || user.role !== "admin") {
// // // //       alert("Unauthorized access. Please login as admin.");
// // // //       localStorage.removeItem("token");
// // // //       localStorage.removeItem("user");
// // // //       navigate("/login");
// // // //       return;
// // // //     }

// // // //     (async () => {
// // // //       try {
// // // //         await api.get("/api/protected-test");
// // // //       } catch {
// // // //         alert("Session expired. Please login again.");
// // // //         localStorage.removeItem("token");
// // // //         localStorage.removeItem("user");
// // // //         navigate("/login");
// // // //       }
// // // //     })();
// // // //   }, [navigate]);

// // // //   // ‚úÖ Fetch all data after login
// // // //   useEffect(() => {
// // // //     const fetchAll = async () => {
// // // //       try {
// // // //         setLoading(true);
// // // //         await Promise.allSettled([
// // // //           fetchOrders(),
// // // //           fetchMenuItems(),
// // // //           fetchCategories(),
// // // //           fetchStaff(),
// // // //           fetchTables(),
// // // //         ]);
// // // //       } finally {
// // // //         setLoading(false);
// // // //       }
// // // //     };
// // // //     fetchAll();
// // // //   }, []);

// // // //   /* ==================== Fetch Functions ==================== */
// // // //   const fetchOrders = async () => {
// // // //     try {
// // // //       const res = await api.get("/api/orders");
// // // //       setOrders(res.data.orders || []);
// // // //     } catch (err) {
// // // //       console.error("fetchOrders error:", err);
// // // //       setOrders([]);
// // // //     }
// // // //   };

// // // //   const fetchMenuItems = async () => {
// // // //     try {
// // // //       const res = await api.get("/api/menu/items");
// // // //       setMenuItems(res.data.items || []);
// // // //     } catch (err) {
// // // //       console.error("fetchMenuItems error:", err);
// // // //       setMenuItems([]);
// // // //     }
// // // //   };

// // // //   const fetchCategories = async () => {
// // // //     try {
// // // //       const res = await api.get("/api/menu/categories");
// // // //       setCategories(res.data.categories || []);
// // // //     } catch (err) {
// // // //       console.error("fetchCategories error:", err);
// // // //       setCategories([]);
// // // //     }
// // // //   };

// // // //   const fetchStaff = async () => {
// // // //     try {
// // // //       const res = await api.get("/api/staff");
// // // //       setStaff(res.data.staff || []);
// // // //     } catch (err) {
// // // //       console.error("fetchStaff error:", err);
// // // //       setStaff([]);
// // // //     }
// // // //   };

// // // //   const fetchTables = async () => {
// // // //     try {
// // // //       const res = await api.get("/api/tables");
// // // //       setTables(res.data.tables || []);
// // // //     } catch (err) {
// // // //       console.error("fetchTables error:", err);
// // // //       setTables([]);
// // // //     }
// // // //   };

// // // //   /* ==================== Add/Delete Functions ==================== */
// // // //   const handleAddStaff = async (e) => {
// // // //     e.preventDefault();
// // // //     try {
// // // //       const res = await api.post("/api/staff", newStaff);
// // // //       if (res.data.success) {
// // // //         alert("‚úÖ Staff added!");
// // // //         await fetchStaff();
// // // //         setNewStaff({ name: "", role: "", phone: "", email: "" });
// // // //       }
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //       alert("Error adding staff");
// // // //     }
// // // //   };

// // // //   const handleDeleteStaff = async (id) => {
// // // //     if (!window.confirm("Delete staff?")) return;
// // // //     try {
// // // //       await api.delete(`/api/staff/${id}`);
// // // //       await fetchStaff();
// // // //       alert("Staff deleted ‚úÖ");
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //       alert("Failed to delete staff");
// // // //     }
// // // //   };

// // // //   const handleAddCategory = async () => {
// // // //     try {
// // // //       const form = new FormData();
// // // //       form.append("name", newCategory.name);
// // // //       if (newCategory.image) form.append("image", newCategory.image);

// // // //       setUploading(true);
// // // //       const res = await api.post("/api/menu/categories", form, {
// // // //         headers: { "Content-Type": "multipart/form-data" },
// // // //       });
// // // //       if (res.data.success) {
// // // //         alert("‚úÖ Category added!");
// // // //         await fetchCategories();
// // // //         setNewCategory({ name: "", image: null });
// // // //       }
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //     } finally {
// // // //       setUploading(false);
// // // //     }
// // // //   };

// // // //   const handleAddMenuItem = async () => {
// // // //     try {
// // // //       const form = new FormData();
// // // //       form.append("name", newItem.name);
// // // //       form.append("price", newItem.price);
// // // //       form.append("categoryId", newItem.categoryId || "");
// // // //       if (newItem.image) form.append("image", newItem.image);

// // // //       setUploading(true);
// // // //       const res = await api.post("/api/menu/items", form, {
// // // //         headers: { "Content-Type": "multipart/form-data" },
// // // //       });
// // // //       if (res.data.success) {
// // // //         alert("‚úÖ Menu item added!");
// // // //         await fetchMenuItems();
// // // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // // //       }
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //     } finally {
// // // //       setUploading(false);
// // // //     }
// // // //   };

// // // //   const handleDeleteMenuItem = async (id) => {
// // // //     if (!window.confirm("Delete this item?")) return;
// // // //     try {
// // // //       await api.delete(`/api/menu/items/${id}`);
// // // //       await fetchMenuItems();
// // // //       alert("Menu item deleted ‚úÖ");
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //       alert("Failed to delete menu item");
// // // //     }
// // // //   };

// // // //   const handleDeleteTable = async (id) => {
// // // //     if (!window.confirm("Delete this table?")) return;
// // // //     try {
// // // //       await api.delete(`/api/tables/${id}`);
// // // //       await fetchTables();
// // // //       alert("Table deleted ‚úÖ");
// // // //     } catch (err) {
// // // //       console.error(err);
// // // //       alert("Failed to delete table");
// // // //     }
// // // //   };

// // // //   /* ==================== UI Layout ==================== */
// // // //   const tabs = [
// // // //     { key: "orders", label: "Orders" },
// // // //     { key: "menu", label: "Menu" },
// // // //     { key: "categories", label: "Categories" },
// // // //     { key: "staff", label: "Staff" },
// // // //     { key: "tables", label: "Tables" },
// // // //   ];

// // // //   const styles = {
// // // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // // //     header: { textAlign: "center", marginBottom: 20 },
// // // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // // //     tabBtn: (active) => ({
// // // //       padding: "8px 16px",
// // // //       borderRadius: 10,
// // // //       border: "2px solid #d4af37",
// // // //       cursor: "pointer",
// // // //       background: active ? "#d4af37" : "#fff",
// // // //       color: active ? "#fff" : "#b8860b",
// // // //       fontWeight: 600,
// // // //     }),
// // // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // // //   };

// // // //   return (
// // // //     <div style={styles.page}>
// // // //       <div style={styles.header}>
// // // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // // //       </div>

// // // //       <div style={styles.tabs}>
// // // //         {tabs.map((t) => (
// // // //           <button key={t.key} onClick={() => setActiveTab(t.key)} style={styles.tabBtn(activeTab === t.key)}>
// // // //             {t.label}
// // // //           </button>
// // // //         ))}
// // // //       </div>

// // // //       <div style={styles.container}>
// // // //         {loading ? (
// // // //           <p>Loading...</p>
// // // //         ) : (
// // // //           <>
// // // //             {activeTab === "orders" && <div>üì¶ Orders Section</div>}
// // // //             {activeTab === "menu" && <div>üçî Menu Items Section</div>}
// // // //             {activeTab === "categories" && <div>üìÅ Categories Section</div>}
// // // //             {activeTab === "staff" && <div>üë©‚Äçüç≥ Staff Section</div>}
// // // //             {activeTab === "tables" && <div>ü™ë Tables Section</div>}
// // // //           </>
// // // //         )}
// // // //       </div>
// // // //     </div>
// // // //   );
// // // // }
// // // import React, { useEffect, useState } from "react";
// // // import axios from "axios";
// // // import { useNavigate } from "react-router-dom";
// // // import { QRCodeCanvas } from "qrcode.react";

// // // const BASE = "http://localhost:4000"; // ‚úÖ Backend URL

// // // // Axios instance with token interceptor
// // // const api = axios.create({
// // //   baseURL: BASE,
// // //   headers: { "Content-Type": "application/json" },
// // // });

// // // api.interceptors.request.use((cfg) => {
// // //   const token = localStorage.getItem("token");
// // //   if (token) cfg.headers.Authorization = `Bearer ${token}`;
// // //   return cfg;
// // // });

// // // export default function AdminPanel() {
// // //   const navigate = useNavigate();

// // //   const [activeTab, setActiveTab] = useState("orders");
// // //   const [loading, setLoading] = useState(true);

// // //   // Data states
// // //   const [orders, setOrders] = useState([]);
// // //   const [menuItems, setMenuItems] = useState([]);
// // //   const [categories, setCategories] = useState([]);
// // //   const [staff, setStaff] = useState([]);
// // //   const [tables, setTables] = useState([]);

// // //   // Form states
// // //   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
// // //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// // //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// // //   const [uploading, setUploading] = useState(false);

// // //   // ‚úÖ Auth check
// // //   useEffect(() => {
// // //     const token = localStorage.getItem("token");
// // //     const user = JSON.parse(localStorage.getItem("user") || "{}");

// // //     // If no token or wrong role ‚Üí redirect
// // //     if (!token || user.role !== "admin") {
// // //       alert("Unauthorized access. Please login as admin.");
// // //       localStorage.removeItem("token");
// // //       localStorage.removeItem("user");
// // //       navigate("/login");
// // //       return;
// // //     }

// // //     // Optional token verification call (ignore if backend lacks /protected-test)
// // //     (async () => {
// // //       try {
// // //         await api.get("/api/protected-test");
// // //       } catch (err) {
// // //         console.warn("Token check failed:", err);
// // //         alert("Session expired. Please login again.");
// // //         localStorage.removeItem("token");
// // //         localStorage.removeItem("user");
// // //         navigate("/login");
// // //       }
// // //     })();
// // //   }, [navigate]);

// // //   // Fetch all data after login
// // //   useEffect(() => {
// // //     const fetchAll = async () => {
// // //       try {
// // //         setLoading(true);
// // //         await Promise.allSettled([
// // //           fetchOrders(),
// // //           fetchMenuItems(),
// // //           fetchCategories(),
// // //           fetchStaff(),
// // //           fetchTables(),
// // //         ]);
// // //       } finally {
// // //         setLoading(false);
// // //       }
// // //     };
// // //     fetchAll();
// // //   }, []);

// // //   /* ==================== Fetch Functions ==================== */
// // //   const fetchOrders = async () => {
// // //     try {
// // //       const res = await api.get("/api/orders");
// // //       setOrders(res.data.orders || []);
// // //     } catch (err) {
// // //       console.error("fetchOrders error:", err);
// // //       setOrders([]);
// // //     }
// // //   };

// // //   const fetchMenuItems = async () => {
// // //     try {
// // //       const res = await api.get("/api/menu/items");
// // //       setMenuItems(res.data.items || []);
// // //     } catch (err) {
// // //       console.error("fetchMenuItems error:", err);
// // //       setMenuItems([]);
// // //     }
// // //   };

// // //   const fetchCategories = async () => {
// // //     try {
// // //       const res = await api.get("/api/menu/categories");
// // //       setCategories(res.data.categories || []);
// // //     } catch (err) {
// // //       console.error("fetchCategories error:", err);
// // //       setCategories([]);
// // //     }
// // //   };

// // //   const fetchStaff = async () => {
// // //     try {
// // //       const res = await api.get("/api/staff");
// // //       setStaff(res.data.staff || []);
// // //     } catch (err) {
// // //       console.error("fetchStaff error:", err);
// // //       setStaff([]);
// // //     }
// // //   };

// // //   const fetchTables = async () => {
// // //     try {
// // //       const res = await api.get("/api/tables");
// // //       setTables(res.data.tables || []);
// // //     } catch (err) {
// // //       console.error("fetchTables error:", err);
// // //       setTables([]);
// // //     }
// // //   };

// // //   /* ==================== Add/Delete Functions ==================== */
// // //   const handleAddStaff = async (e) => {
// // //     e.preventDefault();
// // //     try {
// // //       const res = await api.post("/api/staff", newStaff);
// // //       if (res.data.success) {
// // //         alert("‚úÖ Staff added!");
// // //         await fetchStaff();
// // //         setNewStaff({ name: "", role: "", phone: "", email: "" });
// // //       }
// // //     } catch (err) {
// // //       console.error(err);
// // //       alert("Error adding staff");
// // //     }
// // //   };

// // //   const handleDeleteStaff = async (id) => {
// // //     if (!window.confirm("Delete staff?")) return;
// // //     try {
// // //       await api.delete(`/api/staff/${id}`);
// // //       await fetchStaff();
// // //       alert("Staff deleted ‚úÖ");
// // //     } catch (err) {
// // //       console.error(err);
// // //       alert("Failed to delete staff");
// // //     }
// // //   };

// // //   const handleAddCategory = async () => {
// // //     try {
// // //       const form = new FormData();
// // //       form.append("name", newCategory.name);
// // //       if (newCategory.image) form.append("image", newCategory.image);

// // //       setUploading(true);
// // //       const res = await api.post("/api/menu/categories", form, {
// // //         headers: { "Content-Type": "multipart/form-data" },
// // //       });
// // //       if (res.data.success) {
// // //         alert("‚úÖ Category added!");
// // //         await fetchCategories();
// // //         setNewCategory({ name: "", image: null });
// // //       }
// // //     } catch (err) {
// // //       console.error(err);
// // //     } finally {
// // //       setUploading(false);
// // //     }
// // //   };

// // //   const handleAddMenuItem = async () => {
// // //     try {
// // //       const form = new FormData();
// // //       form.append("name", newItem.name);
// // //       form.append("price", newItem.price);
// // //       form.append("categoryId", newItem.categoryId || "");
// // //       if (newItem.image) form.append("image", newItem.image);

// // //       setUploading(true);
// // //       const res = await api.post("/api/menu/items", form, {
// // //         headers: { "Content-Type": "multipart/form-data" },
// // //       });
// // //       if (res.data.success) {
// // //         alert("‚úÖ Menu item added!");
// // //         await fetchMenuItems();
// // //         setNewItem({ name: "", price: "", categoryId: "", image: null });
// // //       }
// // //     } catch (err) {
// // //       console.error(err);
// // //     } finally {
// // //       setUploading(false);
// // //     }
// // //   };

// // //   const handleDeleteMenuItem = async (id) => {
// // //     if (!window.confirm("Delete this item?")) return;
// // //     try {
// // //       await api.delete(`/api/menu/items/${id}`);
// // //       await fetchMenuItems();
// // //       alert("Menu item deleted ‚úÖ");
// // //     } catch (err) {
// // //       console.error(err);
// // //       alert("Failed to delete menu item");
// // //     }
// // //   };

// // //   const handleDeleteTable = async (id) => {
// // //     if (!window.confirm("Delete this table?")) return;
// // //     try {
// // //       await api.delete(`/api/tables/${id}`);
// // //       await fetchTables();
// // //       alert("Table deleted ‚úÖ");
// // //     } catch (err) {
// // //       console.error(err);
// // //       alert("Failed to delete table");
// // //     }
// // //   };

// // //   /* ==================== UI Layout ==================== */
// // //   const tabs = [
// // //     { key: "orders", label: "Orders" },
// // //     { key: "menu", label: "Menu" },
// // //     { key: "categories", label: "Categories" },
// // //     { key: "staff", label: "Staff" },
// // //     { key: "tables", label: "Tables" },
// // //   ];

// // //   const styles = {
// // //     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
// // //     header: { textAlign: "center", marginBottom: 20 },
// // //     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
// // //     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
// // //     tabBtn: (active) => ({
// // //       padding: "8px 16px",
// // //       borderRadius: 10,
// // //       border: "2px solid #d4af37",
// // //       cursor: "pointer",
// // //       background: active ? "#d4af37" : "#fff",
// // //       color: active ? "#fff" : "#b8860b",
// // //       fontWeight: 600,
// // //     }),
// // //     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
// // //   };

// // //   return (
// // //     <div style={styles.page}>
// // //       <div style={styles.header}>
// // //         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
// // //       </div>

// // //       <div style={styles.tabs}>
// // //         {tabs.map((t) => (
// // //           <button
// // //             key={t.key}
// // //             onClick={() => setActiveTab(t.key)}
// // //             style={styles.tabBtn(activeTab === t.key)}
// // //           >
// // //             {t.label}
// // //           </button>
// // //         ))}
// // //       </div>

// // //       <div style={styles.container}>
// // //         {loading ? (
// // //           <p>Loading...</p>
// // //         ) : (
// // //           <>
// // //             {activeTab === "orders" && <div>üì¶ Orders Section</div>}
// // //             {activeTab === "menu" && <div>üçî Menu Items Section</div>}
// // //             {activeTab === "categories" && <div>üìÅ Categories Section</div>}
// // //             {activeTab === "staff" && <div>üë©‚Äçüç≥ Staff Section</div>}
// // //             {activeTab === "tables" && <div>ü™ë Tables Section</div>}
// // //           </>
// // //         )}
// // //       </div>
// // //     </div>
// // //   );
// // // }
// // import React, { useEffect, useState } from "react";
// // import api from "../services/api";
// // import { QRCodeCanvas } from "qrcode.react";

// // export default function AdminPanel() {
// //   const [activeTab, setActiveTab] = useState("menu");
// //   const [categories, setCategories] = useState([]);
// //   const [tables, setTables] = useState([]);
// //   const [orders, setOrders] = useState([]);
// //   const [staff, setStaff] = useState([]);
// //   const [items, setItems] = useState([]);
// //   const [loading, setLoading] = useState(true);

// //   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
// //   const [newCategory, setNewCategory] = useState({ name: "", image: null });
// //   const [uploading, setUploading] = useState(false);

// //   const token = localStorage.getItem("token");

// //   // ‚úÖ Fetch all data on load
// //   useEffect(() => {
// //     const fetchData = async () => {
// //       try {
// //         const headers = { Authorization: `Bearer ${token}` };
// //         const [catRes, tableRes, orderRes, staffRes, menuRes] = await Promise.allSettled([
// //           api.get("/menu/categories", { headers }),
// //           api.get("/tables", { headers }),
// //           api.get("/orders", { headers }),
// //           api.get("/auth/staff", { headers }),
// //           api.get("/menu/items", { headers }),
// //         ]);

// //         if (catRes.value) setCategories(catRes.value.data.categories || []);
// //         if (tableRes.value) setTables(tableRes.value.data.tables || tableRes.value.data || []);
// //         if (orderRes.value) setOrders(orderRes.value.data.orders || []);
// //         if (staffRes.value) setStaff(staffRes.value.data.staff || staffRes.value.data || []);
// //         if (menuRes.value) setItems(menuRes.value.data.items || []);
// //       } catch (err) {
// //         console.error("‚ùå Error loading admin data:", err);
// //       } finally {
// //         setLoading(false);
// //       }
// //     };
// //     fetchData();
// //   }, [token]);

// //   // ‚úÖ Image upload via multer
// //   const handleUpload = async (file) => {
// //     const formData = new FormData();
// //     formData.append("image", file);
// //     setUploading(true);
// //     try {
// //       const res = await api.post("/upload", formData, {
// //         headers: { "Content-Type": "multipart/form-data" },
// //       });
// //       setUploading(false);
// //       return res.data.imageUrl;
// //     } catch (err) {
// //       console.error("‚ùå Upload failed:", err);
// //       setUploading(false);
// //       return null;
// //     }
// //   };

// //   // ‚úÖ Add Menu Item
// //   const handleAddMenuItem = async () => {
// //     try {
// //       let imageUrl = "";
// //       if (newItem.image) {
// //         imageUrl = await handleUpload(newItem.image);
// //       }

// //       const payload = {
// //         name: newItem.name,
// //         price: newItem.price,
// //         categoryId: newItem.categoryId,
// //         image: imageUrl,
// //       };

// //       const res = await api.post("/menu/items", payload, {
// //         headers: { Authorization: `Bearer ${token}` },
// //       });

// //       setItems([...items, res.data.item]);
// //       alert("‚úÖ Menu item added!");
// //       setNewItem({ name: "", price: "", categoryId: "", image: null });
// //     } catch (err) {
// //       console.error("‚ùå Error adding menu item:", err);
// //     }
// //   };

// //   // ‚úÖ Add Category
// //   const handleAddCategory = async () => {
// //     try {
// //       let imageUrl = "";
// //       if (newCategory.image) {
// //         imageUrl = await handleUpload(newCategory.image);
// //       }

// //       const payload = {
// //         name: newCategory.name,
// //         image: imageUrl,
// //       };

// //       const res = await api.post("/menu/categories", payload, {
// //         headers: { Authorization: `Bearer ${token}` },
// //       });

// //       setCategories([...categories, res.data.category]);
// //       alert("‚úÖ Category added!");
// //       setNewCategory({ name: "", image: null });
// //     } catch (err) {
// //       console.error("‚ùå Error adding category:", err);
// //     }
// //   };

// //   // ‚úÖ Delete Staff
// //   const handleDeleteStaff = async (id) => {
// //     if (!window.confirm("Are you sure you want to delete this staff member?")) return;
// //     try {
// //       await api.delete(`/auth/staff/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// //       setStaff(staff.filter((s) => s._id !== id));
// //       alert("üóëÔ∏è Staff deleted successfully");
// //     } catch (err) {
// //       console.error("‚ùå Error deleting staff:", err);
// //     }
// //   };

// //   // ‚úÖ Delete Table
// //   const handleDeleteTable = async (id) => {
// //     if (!window.confirm("Are you sure you want to delete this table?")) return;
// //     try {
// //       await api.delete(`/tables/${id}`, { headers: { Authorization: `Bearer ${token}` } });
// //       setTables(tables.filter((t) => t._id !== id));
// //       alert("üóëÔ∏è Table deleted successfully");
// //     } catch (err) {
// //       console.error("‚ùå Error deleting table:", err);
// //     }
// //   };

// //   if (loading) {
// //     return <div style={{ textAlign: "center", marginTop: "50px" }}>Loading Admin Panel...</div>;
// //   }

// //   // ‚úÖ Render Orders
// //   const renderOrders = () => (
// //     <div>
// //       <h2 style={sectionTitle}>üßæ Orders</h2>
// //       {orders.length === 0 ? (
// //         <p style={emptyText}>No orders yet.</p>
// //       ) : (
// //         <div style={gridBox}>
// //           {orders.map((o) => (
// //             <div key={o._id} style={miniCard}>
// //               <p><b>Table:</b> {o.tableSlug}</p>
// //               <p><b>Total:</b> ‚Çπ{o.total || "N/A"}</p>
// //               <p><b>Status:</b> {o.status}</p>
// //               <ul>
// //                 {o.items.map((it, idx) => (
// //                   <li key={idx}>{it.name} √ó {it.quantity}</li>
// //                 ))}
// //               </ul>
// //             </div>
// //           ))}
// //         </div>
// //       )}
// //     </div>
// //   );

// //   // ‚úÖ Render Staff
// //   const renderStaff = () => (
// //     <div>
// //       <h2 style={sectionTitle}>üë©‚Äçüç≥ Staff Members</h2>
// //       {staff.length === 0 ? (
// //         <p style={emptyText}>No staff found.</p>
// //       ) : (
// //         <table style={tableStyle}>
// //           <thead>
// //             <tr>
// //               <th>Name</th>
// //               <th>Email</th>
// //               <th>Role</th>
// //               <th>Phone</th>
// //               <th>Actions</th>
// //             </tr>
// //           </thead>
// //           <tbody>
// //             {staff.map((s) => (
// //               <tr key={s._id}>
// //                 <td>{s.name}</td>
// //                 <td>{s.email}</td>
// //                 <td>{s.role}</td>
// //                 <td>{s.phone}</td>
// //                 <td>
// //                   <button onClick={() => handleDeleteStaff(s._id)} style={deleteBtn}>üóëÔ∏è</button>
// //                 </td>
// //               </tr>
// //             ))}
// //           </tbody>
// //         </table>
// //       )}
// //     </div>
// //   );

// //   // ‚úÖ Render Tables
// //   const renderTables = () => (
// //     <div>
// //       <h2 style={sectionTitle}>ü™ë Tables & QR Codes</h2>
// //       {tables.length === 0 ? (
// //         <p style={emptyText}>No tables available.</p>
// //       ) : (
// //         <div style={gridBox}>
// //           {tables.map((t) => (
// //             <div key={t._id} style={miniCard}>
// //               <h4>Table {t.number}</h4>
// //               <QRCodeCanvas value={`http://localhost:5173/menu/${t.qrSlug}`} size={80} />
// //               <p>Slug: {t.qrSlug}</p>
// //               <button onClick={() => handleDeleteTable(t._id)} style={deleteBtnSmall}>üóëÔ∏è</button>
// //             </div>
// //           ))}
// //         </div>
// //       )}
// //     </div>
// //   );

// //   // ‚úÖ Render Menu Items & Categories
// //   const renderMenuItems = () => (
// //     <div>
// //       <h2 style={sectionTitle}>üçî Menu Items</h2>
// //       <div style={formBox}>
// //         <input
// //           type="text"
// //           placeholder="Item Name"
// //           value={newItem.name}
// //           onChange={(e) => setNewItem({ ...newItem, name: e.target.value })}
// //           style={inputStyle}
// //         />
// //         <input
// //           type="number"
// //           placeholder="Price"
// //           value={newItem.price}
// //           onChange={(e) => setNewItem({ ...newItem, price: e.target.value })}
// //           style={inputStyle}
// //         />
// //         <select
// //           value={newItem.categoryId}
// //           onChange={(e) => setNewItem({ ...newItem, categoryId: e.target.value })}
// //           style={inputStyle}
// //         >
// //           <option value="">Select Category</option>
// //           {categories.map((c) => (
// //             <option key={c._id} value={c._id}>{c.name}</option>
// //           ))}
// //         </select>
// //         <input
// //           type="file"
// //           onChange={(e) => setNewItem({ ...newItem, image: e.target.files[0] })}
// //           style={inputStyle}
// //         />
// //         <button onClick={handleAddMenuItem} style={addButton} disabled={uploading}>
// //           {uploading ? "Uploading..." : "Add Item"}
// //         </button>
// //       </div>

// //       {items.length === 0 ? (
// //         <p style={emptyText}>No menu items yet.</p>
// //       ) : (
// //         <div style={gridBox}>
// //           {items.map((i) => (
// //             <div key={i._id} style={miniCard}>
// //               {i.image && <img src={i.image} alt={i.name} width={80} />}
// //               <p>{i.name}</p>
// //               <p>‚Çπ{i.price}</p>
// //             </div>
// //           ))}
// //         </div>
// //       )}
// //     </div>
// //   );

// //   const renderCategories = () => (
// //     <div>
// //       <h2 style={sectionTitle}>üìã Menu Categories</h2>
// //       <div style={formBox}>
// //         <input
// //           type="text"
// //           placeholder="Category Name"
// //           value={newCategory.name}
// //           onChange={(e) => setNewCategory({ ...newCategory, name: e.target.value })}
// //           style={inputStyle}
// //         />
// //         <input
// //           type="file"
// //           onChange={(e) => setNewCategory({ ...newCategory, image: e.target.files[0] })}
// //           style={inputStyle}
// //         />
// //         <button onClick={handleAddCategory} style={addButton} disabled={uploading}>
// //           {uploading ? "Uploading..." : "Add Category"}
// //         </button>
// //       </div>

// //       {categories.length === 0 ? (
// //         <p style={emptyText}>No categories yet.</p>
// //       ) : (
// //         <div style={gridBox}>
// //           {categories.map((c) => (
// //             <div key={c._id} style={miniCard}>
// //               {c.image && <img src={c.image} alt={c.name} width={80} />}
// //               <p>{c.name}</p>
// //             </div>
// //           ))}
// //         </div>
// //       )}
// //     </div>
// //   );

// //   return (
// //     <div style={mainContainer}>
// //       <h1 style={title}>üçΩÔ∏è Scan n Dine Admin Dashboard</h1>

// //       <div style={tabContainer}>
// //         {[
// //           { key: "orders", label: "Orders" },
// //           { key: "menu", label: "Menu Items" },
// //           { key: "categories", label: "Categories" },
// //           { key: "staff", label: "Staff" },
// //           { key: "tables", label: "Tables" },
// //         ].map((tab) => (
// //           <button
// //             key={tab.key}
// //             onClick={() => setActiveTab(tab.key)}
// //             style={{
// //               ...tabButton,
// //               backgroundColor: activeTab === tab.key ? "#d4af37" : "#fff8dc",
// //               color: activeTab === tab.key ? "#fff" : "#b8860b",
// //             }}
// //           >
// //             {tab.label}
// //           </button>
// //         ))}
// //       </div>

// //       <div style={contentCard}>
// //         {activeTab === "menu" && renderMenuItems()}
// //         {activeTab === "categories" && renderCategories()}
// //         {activeTab === "orders" && renderOrders()}
// //         {activeTab === "staff" && renderStaff()}
// //         {activeTab === "tables" && renderTables()}
// //       </div>
// //     </div>
// //   );
// // }

// // /* üé® Styles */
// // const mainContainer = { padding: "40px", background: "#fff8dc", minHeight: "100vh" };
// // const title = { color: "#b8860b", textAlign: "center" };
// // const tabContainer = { display: "flex", justifyContent: "center", gap: "10px", flexWrap: "wrap", marginBottom: "20px" };
// // const tabButton = { padding: "8px 16px", borderRadius: "8px", border: "2px solid #d4af37", cursor: "pointer" };
// // const contentCard = { background: "#fff", padding: "20px", borderRadius: "12px", boxShadow: "0 2px 10px rgba(0,0,0,0.1)" };
// // const sectionTitle = { color: "#b8860b", marginBottom: "10px" };
// // const gridBox = { display: "flex", flexWrap: "wrap", gap: "10px" };
// // const miniCard = { border: "1px solid #eee", padding: "10px", borderRadius: "8px", width: "160px", textAlign: "center" };
// // const formBox = { display: "flex", flexWrap: "wrap", gap: "8px", marginBottom: "15px" };
// // const inputStyle = { padding: "8px", borderRadius: "5px", border: "1px solid #ccc" };
// // const addButton = { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: "5px", cursor: "pointer" };
// // const tableStyle = { width: "100%", borderCollapse: "collapse" };
// // const emptyText = { color: "#999" };
// // const deleteBtn = { background: "red", color: "white", border: "none", padding: "4px 8px", borderRadius: "5px", cursor: "pointer" };
// // const deleteBtnSmall = { ...deleteBtn, padding: "2px 6px", marginTop: "5px" };
// // src/pages/AdminPanel.jsx
// import React, { useEffect, useState } from "react";
// import axios from "axios";
// import { QRCodeCanvas } from "qrcode.react";

// /**
//  * AdminPanel.jsx
//  * - Works with backend base URL: http://localhost:4000
//  * - Endpoints used:
//  *   GET  /api/menu/items
//  *   POST /api/menu/items  (multipart/form-data)
//  *   DELETE /api/menu/items/:id    (fallback: /api/menu/:id)
//  *   GET  /api/menu/categories
//  *   POST /api/menu/categories (multipart/form-data)
//  *   GET  /api/orders
//  *   GET  /api/staff
//  *   POST /api/staff
//  *   DELETE /api/staff/:id
//  *   GET  /api/tables
//  *   DELETE /api/tables/:id
//  */

// const BASE = "http://localhost:4000";

// const api = axios.create({
//   baseURL: BASE,
//   headers: { "Content-Type": "application/json" },
// });

// // attach token automatically if present
// api.interceptors.request.use((cfg) => {
//   const token = localStorage.getItem("token");
//   if (token) cfg.headers.Authorization = `Bearer ${token}`;
//   return cfg;
// });

// export default function AdminPanel() {
//   const [activeTab, setActiveTab] = useState("orders");

//   const [loading, setLoading] = useState(true);

//   // Data
//   const [orders, setOrders] = useState([]);
//   const [menuItems, setMenuItems] = useState([]);
//   const [categories, setCategories] = useState([]);
//   const [staff, setStaff] = useState([]);
//   const [tables, setTables] = useState([]);

//   // Form states
//   const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
//   const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
//   const [newCategory, setNewCategory] = useState({ name: "", image: null });
//   const [uploading, setUploading] = useState(false);

//   // Fetch all data
//   useEffect(() => {
//     (async () => {
//       setLoading(true);
//       await Promise.allSettled([
//         fetchOrders(),
//         fetchMenuItems(),
//         fetchCategories(),
//         fetchStaff(),
//         fetchTables(),
//       ]);
//       setLoading(false);
//     })();
//     // eslint-disable-next-line react-hooks/exhaustive-deps
//   }, []);

//   /* ---------- Fetch helpers ---------- */
//   const fetchOrders = async () => {
//     try {
//       const res = await api.get("/api/orders");
//       // backend: { success:true, count, orders } OR {orders: [...] } OR array
//       const data = res.data;
//       const list = Array.isArray(data) ? data : data.orders || [];
//       setOrders(list);
//       return list;
//     } catch (err) {
//       console.error("fetchOrders error:", err);
//       setOrders([]);
//       return [];
//     }
//   };

//   const fetchMenuItems = async () => {
//     try {
//       const res = await api.get("/api/menu/items");
//       const data = res.data;
//       const list = Array.isArray(data) ? data : data.items || [];
//       setMenuItems(list);
//       return list;
//     } catch (err) {
//       console.error("fetchMenuItems error:", err);
//       setMenuItems([]);
//       return [];
//     }
//   };

//   const fetchCategories = async () => {
//     try {
//       const res = await api.get("/api/menu/categories");
//       const data = res.data;
//       const list = Array.isArray(data) ? data : data.categories || [];
//       setCategories(list);
//       return list;
//     } catch (err) {
//       console.error("fetchCategories error:", err);
//       setCategories([]);
//       return [];
//     }
//   };

//   const fetchStaff = async () => {
//     try {
//       const res = await api.get("/api/staff");
//       const data = res.data;
//       const list = Array.isArray(data) ? data : data.staff || [];
//       setStaff(list);
//       return list;
//     } catch (err) {
//       console.error("fetchStaff error:", err);
//       setStaff([]);
//       return [];
//     }
//   };

//   const fetchTables = async () => {
//     try {
//       const res = await api.get("/api/tables");
//       const data = res.data;
//       // your table route sometimes returns array or object
//       const list = Array.isArray(data) ? data : data.tables || data;
//       setTables(list);
//       return list;
//     } catch (err) {
//       console.error("fetchTables error:", err);
//       setTables([]);
//       return [];
//     }
//   };

//   /* ---------- Staff: add / delete ---------- */
//   const handleAddStaff = async (e) => {
//     e.preventDefault();
//     try {
//       if (!newStaff.name || !newStaff.role || !newStaff.email) {
//         alert("Please fill name, role and email for staff.");
//         return;
//       }
//       const res = await api.post("/api/staff", newStaff);
//       if (res.data && res.data.success) {
//         alert("Staff added ‚úÖ");
//       }
//       await fetchStaff();
//       setNewStaff({ name: "", role: "", phone: "", email: "" });
//     } catch (err) {
//       console.error("handleAddStaff err:", err);
//       alert("Failed to add staff. See console.");
//     }
//   };

//   const handleDeleteStaff = async (id) => {
//     if (!window.confirm("Delete staff?")) return;
//     try {
//       await api.delete(`/api/staff/${id}`);
//       await fetchStaff();
//       alert("Staff removed ‚úÖ");
//     } catch (err) {
//       console.error("handleDeleteStaff err:", err);
//       alert("Failed to delete staff.");
//     }
//   };

//   /* ---------- Menu Item: add / delete ---------- */
//   const handleAddMenuItem = async () => {
//     try {
//       if (!newItem.name || !newItem.price) {
//         alert("Item name and price required");
//         return;
//       }
//       const form = new FormData();
//       form.append("name", newItem.name);
//       form.append("price", newItem.price);
//       form.append("categoryId", newItem.categoryId || "");
//       if (newItem.image) form.append("image", newItem.image);

//       setUploading(true);
//       const res = await api.post("/api/menu/items", form, {
//         headers: { "Content-Type": "multipart/form-data" },
//       });
//       setUploading(false);
//       if (res.data && res.data.success) {
//         alert("Menu item added ‚úÖ");
//         setNewItem({ name: "", price: "", categoryId: "", image: null });
//         await fetchMenuItems();
//       } else {
//         alert("Failed to add item.");
//       }
//     } catch (err) {
//       setUploading(false);
//       console.error("handleAddMenuItem err:", err);
//       alert("Error adding menu item. See console.");
//     }
//   };

//   const handleDeleteMenuItem = async (id) => {
//     if (!window.confirm("Delete menu item?")) return;
//     try {
//       // try standard route first
//       try {
//         await api.delete(`/api/menu/items/${id}`);
//       } catch (err1) {
//         // fallback older route if exists
//         await api.delete(`/api/menu/${id}`);
//       }
//       await fetchMenuItems();
//       alert("Menu item deleted ‚úÖ");
//     } catch (err) {
//       console.error("handleDeleteMenuItem err:", err);
//       alert("Failed to delete menu item.");
//     }
//   };

//   /* ---------- Category add ---------- */
//   const handleAddCategory = async () => {
//     try {
//       if (!newCategory.name) {
//         alert("Category name required");
//         return;
//       }
//       const form = new FormData();
//       form.append("name", newCategory.name);
//       if (newCategory.image) form.append("image", newCategory.image);

//       setUploading(true);
//       const res = await api.post("/api/menu/categories", form, {
//         headers: { "Content-Type": "multipart/form-data" },
//       });
//       setUploading(false);
//       if (res.data && res.data.success) {
//         alert("Category added ‚úÖ");
//         setNewCategory({ name: "", image: null });
//         await fetchCategories();
//       } else {
//         alert("Failed to add category.");
//       }
//     } catch (err) {
//       setUploading(false);
//       console.error("handleAddCategory err:", err);
//       alert("Error adding category.");
//     }
//   };

//   /* ---------- Table delete ---------- */
//   const handleDeleteTable = async (id) => {
//     if (!window.confirm("Delete table?")) return;
//     try {
//       await api.delete(`/api/tables/${id}`);
//       await fetchTables();
//       alert("Table deleted ‚úÖ");
//     } catch (err) {
//       console.error("handleDeleteTable err:", err);
//       alert("Failed to delete table.");
//     }
//   };

//   /* ---------- Utility render guards ---------- */
//   const safeMap = (arr, fn) => (Array.isArray(arr) ? arr.map(fn) : null);

//   /* ---------- Styles (inline golden-white theme) ---------- */
//   const styles = {
//     page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
//     header: { textAlign: "center", marginBottom: 20 },
//     title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
//     tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
//     tabBtn: (active) => ({
//       padding: "8px 16px",
//       borderRadius: 10,
//       border: `2px solid #d4af37`,
//       cursor: "pointer",
//       background: active ? "#d4af37" : "#fff",
//       color: active ? "#fff" : "#b8860b",
//       fontWeight: 600,
//     }),
//     container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
//     sectionTitle: { color: "#b8860b", fontSize: 18, marginBottom: 12, borderBottom: "1px solid #f3e3a6", paddingBottom: 8 },
//     grid: { display: "flex", gap: 14, flexWrap: "wrap" },
//     card: { background: "#fffaf0", border: "1px solid #d4af37", padding: 14, borderRadius: 10, minWidth: 220 },
//     table: { width: "100%", borderCollapse: "collapse", marginTop: 8 },
//     th: { border: "1px solid #f3e3a6", padding: 8, background: "#fffaf0", color: "#b8860b" },
//     td: { border: "1px solid #f3e3a6", padding: 8, textAlign: "center" },
//     formRow: { display: "flex", gap: 8, flexWrap: "wrap", marginBottom: 12 },
//     input: { padding: 8, borderRadius: 6, border: "1px solid #ddd", minWidth: 160 },
//     primaryBtn: { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: 8, cursor: "pointer" },
//     dangerBtn: { background: "#d9534f", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
//     smallBtn: { background: "#b8860b", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
//     empty: { textAlign: "center", color: "#777", padding: 20 },
//   };

//   /* ---------- Render sections ---------- */

//   const OrdersSection = () => (
//     <div>
//       <div style={styles.sectionTitle}>üßæ Orders</div>
//       {!Array.isArray(orders) || orders.length === 0 ? (
//         <div style={styles.empty}>No orders yet</div>
//       ) : (
//         <div style={styles.grid}>
//           {safeMap(orders, (o) => {
//             // normalize order object shapes
//             const items = o.items || o.itemsOrdered || [];
//             const tableSlug = o.tableSlug || (o.tableId && o.tableId.qrSlug) || (o.tableId && o.tableId.number) || "N/A";
//             const totalFromServer = o.total || o.totalPrice || o.amount || items.reduce((s, it) => s + (it.price || it.price_per_item || 0) * (it.qty || it.quantity || 1), 0);
//             return (
//               <div key={o._id || Math.random()} style={styles.card}>
//                 <div style={{ marginBottom: 8, color: "#8b6b00", fontWeight: 700 }}>Table: {String(tableSlug)}</div>
//                 <div style={{ marginBottom: 6 }}><b>Status:</b> <span style={{ color: o.status === "placed" ? "#b8860b" : o.status === "completed" ? "green" : "red" }}>{o.status || "N/A"}</span></div>
//                 <div style={{ marginBottom: 8 }}><b>Total:</b> ‚Çπ{totalFromServer}</div>
//                 <div style={{ fontWeight: 700, color: "#b8860b", marginBottom: 6 }}>Items</div>
//                 <ul style={{ margin: 0, paddingLeft: 18 }}>
//                   {safeMap(items, (it, idx) => (
//                     <li key={idx} style={{ marginBottom: 4 }}>
//                       {it.name || it.itemName} √ó {it.qty || it.quantity || 1} {it.price ? ` ‚Äî ‚Çπ${it.price}` : ""}
//                     </li>
//                   ))}
//                 </ul>
//               </div>
//             );
//           })}
//         </div>
//       )}
//     </div>
//   );

//   const MenuSection = () => (
//     <div>
//       <div style={styles.sectionTitle}>üçî Menu Items</div>

//       <div style={styles.formRow}>
//         <input style={styles.input} placeholder="Name" value={newItem.name} onChange={(e) => setNewItem((p) => ({ ...p, name: e.target.value }))} />
//         <input style={styles.input} placeholder="Price" type="number" value={newItem.price} onChange={(e) => setNewItem((p) => ({ ...p, price: e.target.value }))} />
//         <select style={styles.input} value={newItem.categoryId} onChange={(e) => setNewItem((p) => ({ ...p, categoryId: e.target.value }))}>
//           <option value="">‚Äî Category ‚Äî</option>
//           {safeMap(categories, (c) => <option key={c._id} value={c._id}>{c.name}</option>)}
//         </select>
//         <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewItem((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
//         <button style={styles.primaryBtn} onClick={handleAddMenuItem} disabled={uploading}>{uploading ? "Uploading..." : "Add Item"}</button>
//       </div>

//       <div style={{ marginTop: 10 }}>
//         {(!Array.isArray(menuItems) || menuItems.length === 0) ? (
//           <div style={styles.empty}>No menu items</div>
//         ) : (
//           <table style={styles.table}>
//             <thead>
//               <tr>
//                 <th style={styles.th}>Image</th>
//                 <th style={styles.th}>Name</th>
//                 <th style={styles.th}>Price</th>
//                 <th style={styles.th}>Category</th>
//                 <th style={styles.th}>Action</th>
//               </tr>
//             </thead>
//             <tbody>
//               {safeMap(menuItems, (it) => (
//                 <tr key={it._id}>
//                   <td style={styles.td}>
//                     {it.image ? <img src={it.image.startsWith("/uploads") ? `${BASE}${it.image}` : it.image} alt={it.name} width={60} style={{ borderRadius: 6 }} /> : "‚Äî"}
//                   </td>
//                   <td style={styles.td}>{it.name}</td>
//                   <td style={styles.td}>‚Çπ{it.price}</td>
//                   <td style={styles.td}>{(it.categoryId && (it.categoryId.name || it.categoryId)) || "‚Äî"}</td>
//                   <td style={styles.td}>
//                     <button style={styles.dangerBtn} onClick={() => handleDeleteMenuItem(it._id)}>Delete</button>
//                   </td>
//                 </tr>
//               ))}
//             </tbody>
//           </table>
//         )}
//       </div>
//     </div>
//   );

//   const CategoriesSection = () => (
//     <div>
//       <div style={styles.sectionTitle}>üìã Categories</div>

//       <div style={styles.formRow}>
//         <input style={styles.input} placeholder="Category name" value={newCategory.name} onChange={(e) => setNewCategory((p) => ({ ...p, name: e.target.value }))} />
//         <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewCategory((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
//         <button style={styles.primaryBtn} onClick={handleAddCategory} disabled={uploading}>{uploading ? "Uploading..." : "Add Category"}</button>
//       </div>

//       <div style={{ marginTop: 10 }}>
//         {(!Array.isArray(categories) || categories.length === 0) ? (
//           <div style={styles.empty}>No categories</div>
//         ) : (
//           <div style={styles.grid}>
//             {safeMap(categories, (c) => (
//               <div key={c._id} style={styles.card}>
//                 <div style={{ fontWeight: 700 }}>{c.name}</div>
//                 {c.image && <img src={c.image.startsWith("/uploads") ? `${BASE}${c.image}` : c.image} alt={c.name} width={90} style={{ marginTop: 8, borderRadius: 6 }} />}
//               </div>
//             ))}
//           </div>
//         )}
//       </div>
//     </div>
//   );

//   const StaffSection = () => (
//     <div>
//       <div style={styles.sectionTitle}>üë©‚Äçüç≥ Staff</div>

//       <form onSubmit={handleAddStaff} style={{ marginBottom: 12 }}>
//         <div style={styles.formRow}>
//           <input style={styles.input} placeholder="Name" value={newStaff.name} onChange={(e) => setNewStaff((p) => ({ ...p, name: e.target.value }))} required />
//           <input style={styles.input} placeholder="Role" value={newStaff.role} onChange={(e) => setNewStaff((p) => ({ ...p, role: e.target.value }))} required />
//           <input style={styles.input} placeholder="Phone" value={newStaff.phone} onChange={(e) => setNewStaff((p) => ({ ...p, phone: e.target.value }))} />
//           <input style={styles.input} placeholder="Email" value={newStaff.email} onChange={(e) => setNewStaff((p) => ({ ...p, email: e.target.value }))} required />
//           <button style={styles.primaryBtn} type="submit">Add Staff</button>
//         </div>
//       </form>

//       <div style={{ marginTop: 10 }}>
//         {(!Array.isArray(staff) || staff.length === 0) ? (
//           <div style={styles.empty}>No staff</div>
//         ) : (
//           <table style={styles.table}>
//             <thead>
//               <tr>
//                 <th style={styles.th}>Name</th>
//                 <th style={styles.th}>Role</th>
//                 <th style={styles.th}>Phone</th>
//                 <th style={styles.th}>Email</th>
//                 <th style={styles.th}>Action</th>
//               </tr>
//             </thead>
//             <tbody>
//               {safeMap(staff, (s) => (
//                 <tr key={s._id}>
//                   <td style={styles.td}>{s.name}</td>
//                   <td style={styles.td}>{s.role}</td>
//                   <td style={styles.td}>{s.phone || "‚Äî"}</td>
//                   <td style={styles.td}>{s.email}</td>
//                   <td style={styles.td}><button style={styles.dangerBtn} onClick={() => handleDeleteStaff(s._1d || s._id)}>Delete</button></td>
//                 </tr>
//               ))}
//             </tbody>
//           </table>
//         )}
//       </div>
//     </div>
//   );

//   const TablesSection = () => (
//     <div>
//       <div style={styles.sectionTitle}>ü™ë Tables</div>
//       {(!Array.isArray(tables) || tables.length === 0) ? (
//         <div style={styles.empty}>No tables</div>
//       ) : (
//         <div style={styles.grid}>
//           {safeMap(tables, (t) => (
//             <div key={t._id} style={styles.card}>
//               <div style={{ fontWeight: 700 }}>Table {t.number}</div>
//               <QRCodeCanvas value={`http://localhost:5173/menu/${t.qrSlug}`} size={90} />
//               <div style={{ marginTop: 8 }}>Slug: {t.qrSlug}</div>
//               <div style={{ marginTop: 8 }}>
//                 <button style={styles.dangerBtn} onClick={() => handleDeleteTable(t._id)}>Delete</button>
//               </div>
//             </div>
//           ))}
//         </div>
//       )}
//     </div>
//   );

//   /* ---------- Main render ---------- */
//   return (
//     <div style={styles.page}>
//       <div style={styles.header}>
//         <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
//       </div>

//       <div style={styles.tabs}>
//         {[
//           { key: "orders", label: "Orders" },
//           { key: "menu", label: "Menu" },
//           { key: "categories", label: "Categories" },
//           { key: "staff", label: "Staff" },
//           { key: "tables", label: "Tables" },
//         ].map((t) => (
//           <button key={t.key} onClick={() => setActiveTab(t.key)} style={styles.tabBtn(activeTab === t.key)}>{t.label}</button>
//         ))}
//       </div>

//       <div style={styles.container}>
//         {loading ? <div style={styles.empty}>Loading...</div> : (
//           <>
//             {activeTab === "orders" && <OrdersSection />}
//             {activeTab === "menu" && <MenuSection />}
//             {activeTab === "categories" && <CategoriesSection />}
//             {activeTab === "staff" && <StaffSection />}
//             {activeTab === "tables" && <TablesSection />}
//           </>
//         )}
//       </div>
//     </div>
//   );
// }
// src/pages/AdminPanel.jsx
import React, { useEffect, useState } from "react";
import axios from "axios";
import { QRCodeCanvas } from "qrcode.react";

/**
 * AdminPanel.jsx
 * - Works with backend base URL: http://localhost:4000
 * - Endpoints used:
 *   GET  /api/menu/items
 *   POST /api/menu/items  (multipart/form-data)
 *   DELETE /api/menu/items/:id    (fallback: /api/menu/:id)
 *   GET  /api/menu/categories
 *   POST /api/menu/categories (multipart/form-data)
 *   GET  /api/orders
 *   GET  /api/staff
 *   POST /api/staff
 *   DELETE /api/staff/:id
 *   GET  /api/tables
 *   DELETE /api/tables/:id
 */

const BASE = "http://10.21.218.69:4000";

const api = axios.create({
  baseURL: BASE,
  headers: { "Content-Type": "application/json" },
});

// attach token automatically if present
api.interceptors.request.use((cfg) => {
  const token = localStorage.getItem("token");
  if (token) cfg.headers.Authorization = `Bearer ${token}`;
  return cfg;
});

export default function AdminPanel() {
  const [activeTab, setActiveTab] = useState("orders");

  const [loading, setLoading] = useState(true);

  // Data
  const [orders, setOrders] = useState([]);
  const [menuItems, setMenuItems] = useState([]);
  const [categories, setCategories] = useState([]);
  const [staff, setStaff] = useState([]);
  const [tables, setTables] = useState([]);

  // Form states
  const [newStaff, setNewStaff] = useState({ name: "", role: "", phone: "", email: "" });
  const [newItem, setNewItem] = useState({ name: "", price: "", categoryId: "", image: null });
  const [newCategory, setNewCategory] = useState({ name: "", image: null });
  const [uploading, setUploading] = useState(false);

  // Fetch all data
  useEffect(() => {
    (async () => {
      setLoading(true);
      await Promise.allSettled([
        fetchOrders(),
        fetchMenuItems(),
        fetchCategories(),
        fetchStaff(),
        fetchTables(),
      ]);
      setLoading(false);
    })();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  /* ---------- Fetch helpers ---------- */
  const fetchOrders = async () => {
    try {
      const res = await api.get("/api/orders");
      // backend: { success:true, count, orders } OR {orders: [...] } OR array
      const data = res.data;
      const list = Array.isArray(data) ? data : data.orders || [];
      setOrders(list);
      return list;
    } catch (err) {
      console.error("fetchOrders error:", err);
      setOrders([]);
      return [];
    }
  };

  const fetchMenuItems = async () => {
    try {
      const res = await api.get("/api/menu/items");
      const data = res.data;
      const list = Array.isArray(data) ? data : data.items || [];
      setMenuItems(list);
      return list;
    } catch (err) {
      console.error("fetchMenuItems error:", err);
      setMenuItems([]);
      return [];
    }
  };

  const fetchCategories = async () => {
    try {
      const res = await api.get("/api/menu/categories");
      const data = res.data;
      const list = Array.isArray(data) ? data : data.categories || [];
      setCategories(list);
      return list;
    } catch (err) {
      console.error("fetchCategories error:", err);
      setCategories([]);
      return [];
    }
  };

  const fetchStaff = async () => {
    try {
      const res = await api.get("/api/staff");
      const data = res.data;
      const list = Array.isArray(data) ? data : data.staff || [];
      setStaff(list);
      return list;
    } catch (err) {
      console.error("fetchStaff error:", err);
      setStaff([]);
      return [];
    }
  };

  const fetchTables = async () => {
    try {
      const res = await api.get("/api/tables");
      const data = res.data;
      // your table route sometimes returns array or object
      const list = Array.isArray(data) ? data : data.tables || data;
      setTables(list);
      return list;
    } catch (err) {
      console.error("fetchTables error:", err);
      setTables([]);
      return [];
    }
  };

  /* ---------- Staff: add / delete ---------- */
  const handleAddStaff = async (e) => {
    e.preventDefault();
    try {
      if (!newStaff.name || !newStaff.role || !newStaff.email) {
        alert("Please fill name, role and email for staff.");
        return;
      }
      const res = await api.post("/api/staff", newStaff);
      if (res.data && res.data.success) {
        alert("Staff added ‚úÖ");
      }
      await fetchStaff();
      setNewStaff({ name: "", role: "", phone: "", email: "" });
    } catch (err) {
      console.error("handleAddStaff err:", err);
      alert("Failed to add staff. See console.");
    }
  };

  const handleDeleteStaff = async (id) => {
    if (!window.confirm("Delete staff?")) return;
    try {
      await api.delete(`/api/staff/${id}`);
      await fetchStaff();
      alert("Staff removed ‚úÖ");
    } catch (err) {
      console.error("handleDeleteStaff err:", err);
      alert("Failed to delete staff.");
    }
  };

  /* ---------- Menu Item: add / delete ---------- */
  const handleAddMenuItem = async () => {
    try {
      if (!newItem.name || !newItem.price) {
        alert("Item name and price required");
        return;
      }
      const form = new FormData();
      form.append("name", newItem.name);
      form.append("price", newItem.price);
      form.append("categoryId", newItem.categoryId || "");
      if (newItem.image) form.append("image", newItem.image);

      setUploading(true);
      const res = await api.post("/api/menu/items", form, {
        headers: { "Content-Type": "multipart/form-data" },
      });
      setUploading(false);
      if (res.data && res.data.success) {
        alert("Menu item added ‚úÖ");
        setNewItem({ name: "", price: "", categoryId: "", image: null });
        await fetchMenuItems();
      } else {
        alert("Failed to add item.");
      }
    } catch (err) {
      setUploading(false);
      console.error("handleAddMenuItem err:", err);
      alert("Error adding menu item. See console.");
    }
  };

  const handleDeleteMenuItem = async (id) => {
    if (!window.confirm("Delete menu item?")) return;
    try {
      // try standard route first
      try {
        await api.delete(`/api/menu/items/${id}`);
      } catch (err1) {
        // fallback older route if exists
        await api.delete(`/api/menu/${id}`);
      }
      await fetchMenuItems();
      alert("Menu item deleted ‚úÖ");
    } catch (err) {
      console.error("handleDeleteMenuItem err:", err);
      alert("Failed to delete menu item.");
    }
  };

  /* ---------- Category add ---------- */
  const handleAddCategory = async () => {
    try {
      if (!newCategory.name) {
        alert("Category name required");
        return;
      }
      const form = new FormData();
      form.append("name", newCategory.name);
      if (newCategory.image) form.append("image", newCategory.image);

      setUploading(true);
      const res = await api.post("/api/menu/categories", form, {
        headers: { "Content-Type": "multipart/form-data" },
      });
      setUploading(false);
      if (res.data && res.data.success) {
        alert("Category added ‚úÖ");
        setNewCategory({ name: "", image: null });
        await fetchCategories();
      } else {
        alert("Failed to add category.");
      }
    } catch (err) {
      setUploading(false);
      console.error("handleAddCategory err:", err);
      alert("Error adding category.");
    }
  };

  /* ---------- Table delete ---------- */
  const handleDeleteTable = async (id) => {
    if (!window.confirm("Delete table?")) return;
    try {
      await api.delete(`/api/tables/${id}`);
      await fetchTables();
      alert("Table deleted ‚úÖ");
    } catch (err) {
      console.error("handleDeleteTable err:", err);
      alert("Failed to delete table.");
    }
  };

  /* ---------- Utility render guards ---------- */
  const safeMap = (arr, fn) => (Array.isArray(arr) ? arr.map(fn) : null);

  /* ---------- Styles (inline golden-white theme) ---------- */
  const styles = {
    page: { minHeight: "100vh", background: "#fff8dc", padding: 28, fontFamily: "Poppins, sans-serif" },
    header: { textAlign: "center", marginBottom: 20 },
    title: { color: "#b8860b", fontSize: 26, fontWeight: 700 },
    tabs: { display: "flex", gap: 10, justifyContent: "center", marginBottom: 18, flexWrap: "wrap" },
    tabBtn: (active) => ({
      padding: "8px 16px",
      borderRadius: 10,
      border: `2px solid #d4af37`,
      cursor: "pointer",
      background: active ? "#d4af37" : "#fff",
      color: active ? "#fff" : "#b8860b",
      fontWeight: 600,
    }),
    container: { background: "#fff", padding: 18, borderRadius: 12, boxShadow: "0 6px 20px rgba(212,175,55,0.12)" },
    sectionTitle: { color: "#b8860b", fontSize: 18, marginBottom: 12, borderBottom: "1px solid #f3e3a6", paddingBottom: 8 },
    grid: { display: "flex", gap: 14, flexWrap: "wrap" },
    card: { background: "#fffaf0", border: "1px solid #d4af37", padding: 14, borderRadius: 10, minWidth: 220 },
    table: { width: "100%", borderCollapse: "collapse", marginTop: 8 },
    th: { border: "1px solid #f3e3a6", padding: 8, background: "#fffaf0", color: "#b8860b" },
    td: { border: "1px solid #f3e3a6", padding: 8, textAlign: "center" },
    formRow: { display: "flex", gap: 8, flexWrap: "wrap", marginBottom: 12 },
    input: { padding: 8, borderRadius: 6, border: "1px solid #ddd", minWidth: 160 },
    primaryBtn: { background: "#d4af37", color: "#fff", border: "none", padding: "8px 12px", borderRadius: 8, cursor: "pointer" },
    dangerBtn: { background: "#d9534f", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
    smallBtn: { background: "#b8860b", color: "#fff", border: "none", padding: "6px 10px", borderRadius: 6, cursor: "pointer" },
    empty: { textAlign: "center", color: "#777", padding: 20 },
  };

  /* ---------- Render sections ---------- */

  const OrdersSection = () => (
    <div>
      <div style={styles.sectionTitle}>üßæ Orders</div>
      {!Array.isArray(orders) || orders.length === 0 ? (
        <div style={styles.empty}>No orders yet</div>
      ) : (
        <div style={styles.grid}>
          {safeMap(orders, (o) => {
            // normalize order object shapes
            const items = o.items || o.itemsOrdered || [];
            const tableSlug = o.tableSlug || (o.tableId && o.tableId.qrSlug) || (o.tableId && o.tableId.number) || "N/A";
            const totalFromServer = o.total || o.totalPrice || o.amount || items.reduce((s, it) => s + (it.price || it.price_per_item || 0) * (it.qty || it.quantity || 1), 0);
            return (
              <div key={o._id || Math.random()} style={styles.card}>
                <div style={{ marginBottom: 8, color: "#8b6b00", fontWeight: 700 }}>Table: {String(tableSlug)}</div>
                <div style={{ marginBottom: 6 }}><b>Status:</b> <span style={{ color: o.status === "placed" ? "#b8860b" : o.status === "completed" ? "green" : "red" }}>{o.status || "N/A"}</span></div>
                <div style={{ marginBottom: 8 }}><b>Total:</b> ‚Çπ{totalFromServer}</div>
                <div style={{ fontWeight: 700, color: "#b8860b", marginBottom: 6 }}>Items</div>
                <ul style={{ margin: 0, paddingLeft: 18 }}>
                  {safeMap(items, (it, idx) => (
                    <li key={idx} style={{ marginBottom: 4 }}>
                      {it.name || it.itemName} √ó {it.qty || it.quantity || 1} {it.price ? ` ‚Äî ‚Çπ${it.price}` : ""}
                    </li>
                  ))}
                </ul>
              </div>
            );
          })}
        </div>
      )}
    </div>
  );

  const MenuSection = () => (
    <div>
      <div style={styles.sectionTitle}>üçî Menu Items</div>

      <div style={styles.formRow}>
        <input style={styles.input} placeholder="Name" value={newItem.name} onChange={(e) => setNewItem((p) => ({ ...p, name: e.target.value }))} />
        <input style={styles.input} placeholder="Price" type="number" value={newItem.price} onChange={(e) => setNewItem((p) => ({ ...p, price: e.target.value }))} />
        <select style={styles.input} value={newItem.categoryId} onChange={(e) => setNewItem((p) => ({ ...p, categoryId: e.target.value }))}>
          <option value="">‚Äî Category ‚Äî</option>
          {safeMap(categories, (c) => <option key={c._id} value={c._id}>{c.name}</option>)}
        </select>
        <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewItem((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
        <button style={styles.primaryBtn} onClick={handleAddMenuItem} disabled={uploading}>{uploading ? "Uploading..." : "Add Item"}</button>
      </div>

      <div style={{ marginTop: 10 }}>
        {(!Array.isArray(menuItems) || menuItems.length === 0) ? (
          <div style={styles.empty}>No menu items</div>
        ) : (
          <table style={styles.table}>
            <thead>
              <tr>
                <th style={styles.th}>Image</th>
                <th style={styles.th}>Name</th>
                <th style={styles.th}>Price</th>
                <th style={styles.th}>Category</th>
                <th style={styles.th}>Action</th>
              </tr>
            </thead>
            <tbody>
              {safeMap(menuItems, (it) => (
                <tr key={it._id}>
                  <td style={styles.td}>
                    {it.image ? <img src={it.image.startsWith("/uploads") ? `${BASE}${it.image}` : it.image} alt={it.name} width={60} style={{ borderRadius: 6 }} /> : "‚Äî"}
                  </td>
                  <td style={styles.td}>{it.name}</td>
                  <td style={styles.td}>‚Çπ{it.price}</td>
                  <td style={styles.td}>{(it.categoryId && (it.categoryId.name || it.categoryId)) || "‚Äî"}</td>
                  <td style={styles.td}>
                    <button style={styles.dangerBtn} onClick={() => handleDeleteMenuItem(it._id)}>Delete</button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );

  const CategoriesSection = () => (
    <div>
      <div style={styles.sectionTitle}>üìã Categories</div>

      <div style={styles.formRow}>
        <input style={styles.input} placeholder="Category name" value={newCategory.name} onChange={(e) => setNewCategory((p) => ({ ...p, name: e.target.value }))} />
        <input style={styles.input} type="file" accept="image/*" onChange={(e) => setNewCategory((p) => ({ ...p, image: e.target.files?.[0] || null }))} />
        <button style={styles.primaryBtn} onClick={handleAddCategory} disabled={uploading}>{uploading ? "Uploading..." : "Add Category"}</button>
      </div>

      <div style={{ marginTop: 10 }}>
        {(!Array.isArray(categories) || categories.length === 0) ? (
          <div style={styles.empty}>No categories</div>
        ) : (
          <div style={styles.grid}>
            {safeMap(categories, (c) => (
              <div key={c._id} style={styles.card}>
                <div style={{ fontWeight: 700 }}>{c.name}</div>
                {c.image && <img src={c.image.startsWith("/uploads") ? `${BASE}${c.image}` : c.image} alt={c.name} width={90} style={{ marginTop: 8, borderRadius: 6 }} />}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );

  const StaffSection = () => (
    <div>
      <div style={styles.sectionTitle}>üë©‚Äçüç≥ Staff</div>

      <form onSubmit={handleAddStaff} style={{ marginBottom: 12 }}>
        <div style={styles.formRow}>
          <input style={styles.input} placeholder="Name" value={newStaff.name} onChange={(e) => setNewStaff((p) => ({ ...p, name: e.target.value }))} required />
          <input style={styles.input} placeholder="Role" value={newStaff.role} onChange={(e) => setNewStaff((p) => ({ ...p, role: e.target.value }))} required />
          <input style={styles.input} placeholder="Phone" value={newStaff.phone} onChange={(e) => setNewStaff((p) => ({ ...p, phone: e.target.value }))} />
          <input style={styles.input} placeholder="Email" value={newStaff.email} onChange={(e) => setNewStaff((p) => ({ ...p, email: e.target.value }))} required />
          <button style={styles.primaryBtn} type="submit">Add Staff</button>
        </div>
      </form>

      <div style={{ marginTop: 10 }}>
        {(!Array.isArray(staff) || staff.length === 0) ? (
          <div style={styles.empty}>No staff</div>
        ) : (
          <table style={styles.table}>
            <thead>
              <tr>
                <th style={styles.th}>Name</th>
                <th style={styles.th}>Role</th>
                <th style={styles.th}>Phone</th>
                <th style={styles.th}>Email</th>
                <th style={styles.th}>Action</th>
              </tr>
            </thead>
            <tbody>
              {safeMap(staff, (s) => (
                <tr key={s._id}>
                  <td style={styles.td}>{s.name}</td>
                  <td style={styles.td}>{s.role}</td>
                  <td style={styles.td}>{s.phone || "‚Äî"}</td>
                  <td style={styles.td}>{s.email}</td>
                  <td style={styles.td}><button style={styles.dangerBtn} onClick={() => handleDeleteStaff(s._1d || s._id)}>Delete</button></td>
                </tr>
              ))}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );

  const TablesSection = () => (
    <div>
      <div style={styles.sectionTitle}>ü™ë Tables</div>
      {(!Array.isArray(tables) || tables.length === 0) ? (
        <div style={styles.empty}>No tables</div>
      ) : (
        <div style={styles.grid}>
          {safeMap(tables, (t) => (
            <div key={t._id} style={styles.card}>
              <div style={{ fontWeight: 700 }}>Table {t.number}</div>
              <QRCodeCanvas value={`http://10.21.218.69:5173/menu/${t.qrSlug}`} size={90} />
              <div style={{ marginTop: 8 }}>Slug: {t.qrSlug}</div>
              <div style={{ marginTop: 8 }}>
                <button style={styles.dangerBtn} onClick={() => handleDeleteTable(t._id)}>Delete</button>
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );

  /* ---------- Main render ---------- */
  return (
    <div style={styles.page}>
      <div style={styles.header}>
        <div style={styles.title}>üçΩÔ∏è Scan n Dine ‚Äî Admin Dashboard</div>
      </div>

      <div style={styles.tabs}>
        {[
          { key: "orders", label: "Orders" },
          { key: "menu", label: "Menu" },
          { key: "categories", label: "Categories" },
          { key: "staff", label: "Staff" },
          { key: "tables", label: "Tables" },
        ].map((t) => (
          <button key={t.key} onClick={() => setActiveTab(t.key)} style={styles.tabBtn(activeTab === t.key)}>{t.label}</button>
        ))}
      </div>

      <div style={styles.container}>
        {loading ? <div style={styles.empty}>Loading...</div> : (
          <>
            {activeTab === "orders" && <OrdersSection />}
            {activeTab === "menu" && <MenuSection />}
            {activeTab === "categories" && <CategoriesSection />}
            {activeTab === "staff" && <StaffSection />}
            {activeTab === "tables" && <TablesSection />}
          </>
        )}
      </div>
    </div>
  );
}
